WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-core-v5', location = 'v5/js/core/connect-host.js' */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).connectHost=t()}(this,(function(){"use strict";function e(){e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};return e.apply(this,arguments)}function t(e,n){t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){e.__proto__=t;return e};return t(e,n)}function n(e,n){e.prototype=Object.create(n.prototype);e.prototype.constructor=e;t(e,n)}function i(){}i.prototype=Object.create(null);function r(){r.init.call(this)}r.EventEmitter=r;r.usingDomains=!1;r.prototype.domain=void 0;r.prototype._events=void 0;r.prototype._maxListeners=void 0;r.defaultMaxListeners=10;r.init=function(){this.domain=null;r.usingDomains&&undefined.active;if(!this._events||this._events===Object.getPrototypeOf(this)._events){this._events=new i;this._eventsCount=0}this._maxListeners=this._maxListeners||void 0};r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');this._maxListeners=e;return this};function o(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}r.prototype.getMaxListeners=function(){return o(this)};function a(e,t,n){if(t)e.call(n);else for(var i=e.length,r=h(e,i),o=0;o<i;++o)r[o].call(n)}function s(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,o=h(e,r),a=0;a<r;++a)o[a].call(n,i)}function u(e,t,n,i,r){if(t)e.call(n,i,r);else for(var o=e.length,a=h(e,o),s=0;s<o;++s)a[s].call(n,i,r)}function l(e,t,n,i,r,o){if(t)e.call(n,i,r,o);else for(var a=e.length,s=h(e,a),u=0;u<a;++u)s[u].call(n,i,r,o)}function c(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,o=h(e,r),a=0;a<r;++a)o[a].apply(n,i)}r.prototype.emit=function(e){var t,n,i,r,o,d,f,p="error"===e;if(d=this._events)p=p&&null==d.error;else if(!p)return!1;f=this.domain;if(p){t=arguments[1];if(!f){if(t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");h.context=t;throw h}t||(t=new Error('Uncaught, unspecified "error" event'));t.domainEmitter=this;t.domain=f;t.domainThrown=!1;f.emit("error",t);return!1}if(!(n=d[e]))return!1;var g="function"==typeof n;switch(i=arguments.length){case 1:a(n,g,this);break;case 2:s(n,g,this,arguments[1]);break;case 3:u(n,g,this,arguments[1],arguments[2]);break;case 4:l(n,g,this,arguments[1],arguments[2],arguments[3]);break;default:r=new Array(i-1);for(o=1;o<i;o++)r[o-1]=arguments[o];c(n,g,this,r)}return!0};function d(e,t,n,r){var a,s,u,l;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(s=e._events){if(s.newListener){e.emit("newListener",t,n.listener?n.listener:n);s=e._events}u=s[t]}else{s=e._events=new i;e._eventsCount=0}if(u){"function"==typeof u?u=s[t]=r?[n,u]:[u,n]:r?u.unshift(n):u.push(n);if(!u.warned&&(a=o(e))&&a>0&&u.length>a){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning";c.emitter=e;c.type=t;c.count=u.length;l=c,"function"==typeof console.warn?console.warn(l):console.log(l)}}else{u=s[t]=n;++e._eventsCount}return e}r.prototype.addListener=function(e,t){return d(this,e,t,!1)};r.prototype.on=r.prototype.addListener;r.prototype.prependListener=function(e,t){return d(this,e,t,!0)};function f(e,t,n){var i=!1;function r(){e.removeListener(t,r);if(!i){i=!0;n.apply(e,arguments)}}r.listener=n;return r}r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.on(e,f(this,e,t));return this};r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.prependListener(e,f(this,e,t));return this};r.prototype.removeListener=function(e,t){var n,r,o,a,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)if(0==--this._eventsCount)this._events=new i;else{delete r[e];r.removeListener&&this.emit("removeListener",e,n.listener||t)}else if("function"!=typeof n){o=-1;for(a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){s=n[a].listener;o=a;break}if(o<0)return this;if(1===n.length){n[0]=void 0;if(0==--this._eventsCount){this._events=new i;return this}delete r[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(n,o);r.removeListener&&this.emit("removeListener",e,s||t)}return this};r.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener){if(0===arguments.length){this._events=new i;this._eventsCount=0}else n[e]&&(0==--this._eventsCount?this._events=new i:delete n[e]);return this}if(0===arguments.length){for(var r,o=Object.keys(n),a=0;a<o.length;++a)"removeListener"!==(r=o[a])&&this.removeAllListeners(r);this.removeAllListeners("removeListener");this._events=new i;this._eventsCount=0;return this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this};r.prototype.listeners=function(e){var t,n,i=this._events;n=i&&(t=i[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[];return n};r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)};r.prototype.listenerCount=p;function p(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function h(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}var g=function(e){n(t,e);function t(){var t;(t=e.call(this)||this).setMaxListeners(20);return t}var i=t.prototype;i.dispatch=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.emit.apply(this,["before:"+e].concat(n));this.emit.apply(this,arguments);this.emit.apply(this,["after:"+e].concat(n))};i.registerOnce=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.once(e,t)};i.register=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.on(e,t)};i.unregister=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.removeListener(e,t)};return t}(r),v=new g,y=function(e,t){v.dispatch("iframe-bridge-timeout",{$el:e,extension:t})},m=function(e,t){v.dispatch("iframe-bridge-cancelled",{$el:e,extension:t})},_=window.AJS&&window.AJS.$||function(){console.error("[ACJS] jQuery was not loaded before Connect. If in product frontend, make sure to load via a wrapper, eg withConnectHost()")},b="ap-status-indicator",w='<div class="ap-loading"><div class="small-spinner"></div>Loading app...</div>',x='<div class="ap-load-timeout"><div class="small-spinner"></div>App is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?</div>',E="App failed to load.",k=new(function(){function e(){this._stateRegistry={}}var t=e.prototype;t._loadingContainer=function(e){return e.find(".ap-status-indicator")};t.render=function(){var e=document.createElement("div");e.classList.add(b);e.innerHTML=w;var t=_(e);this._startSpinner(t);return t};t._startSpinner=function(e){setTimeout((function(){var t=e.find(".small-spinner");t.length&&t.spin&&t.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})}),10)};t.hide=function(e,t){this._clearTimeout(t);this._loadingContainer(e)[0].style.display="none"};t.cancelled=function(e,t){var n=E;this._loadingContainer(e).empty().text(n)};t._setupTimeout=function(e,t){this._stateRegistry[t.id]=setTimeout((function(){y(e,t)}),12e3)};t._clearTimeout=function(e){if(this._stateRegistry[e]){clearTimeout(this._stateRegistry[e]);delete this._stateRegistry[e]}};t.timeout=function(e,t){var n=_(x),i=this._loadingContainer(e);i.empty().append(n);this._startSpinner(i);_("a.ap-btn-cancel",i).click((function(){m(e,t)}));this._clearTimeout(t);return i};return e}());v.register("iframe-create",(function(e){e.extension.options.noDom||k._setupTimeout(e.$el.parents(".ap-iframe-container"),e.extension)}));v.register("iframe-bridge-established",(function(e){e.extension.options.noDom||k.hide(e.$el.parents(".ap-iframe-container"),e.extension.id)}));v.register("iframe-bridge-timeout",(function(e){e.extension.options.noDom||k.timeout(e.$el,e.extension.id)}));v.register("iframe-bridge-cancelled",(function(e){e.extension.options.noDom||k.cancelled(e.$el,e.extension.id)}));v.register("iframe-destroyed",(function(e){k._clearTimeout(e.extension.extension_id)}));function O(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++){n=o[i];t.indexOf(n)>=0||(r[n]=e[n])}return r}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}function A(e,n,i){A=S()?Reflect.construct.bind():function(e,n,i){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(e,r));i&&t(o,i.prototype);return o};return A.apply(null,arguments)}var C="[Simple-XDM] ",I=Function.prototype.bind,L={locationOrigin:function(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},randomString:function(){return Math.floor(1e9*Math.random()).toString(16)},isString:function(e){return"string"==typeof e||e instanceof String},argumentsToArray:function(e){return Array.prototype.slice.call(e)},argumentNames:function(e){return e.toString().replace(/((\/\/.*$)|(\/\*[^]*?\*\/))/gm,"").replace(/[^(]+\(([^)]*)[^]+/,"$1").match(/([^\s,]+)/g)||[]},hasCallback:function(e){var t=e.length;return t>0&&"function"==typeof e[t-1]},error:function(e){if(window.console&&window.console.error){var t=[];if("string"==typeof e){t.push(C+e);t=t.concat(Array.prototype.slice.call(arguments,1))}else{t.push(C);t=t.concat(Array.prototype.slice.call(arguments))}window.console.error.apply(null,t)}},warn:function(e){window.console&&console.warn(C+e)},log:function(e){window.console&&window.console.log(C+e)},_bind:function(e,t){return I&&t.bind===I?t.bind(e):function(){return t.apply(e,arguments)}},throttle:function(e,t,n){var i=0;return function(){var r=Date.now();if(r-i>t){i=r;e.apply(n,arguments)}}},each:function(e,t){var n,i;if(e)if(null!=(n=e.length)&&"function"!=typeof e){i=0;for(;i<n&&!1!==t.call(e[i],i,e[i]);)i+=1}else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(e[i],i,e[i]))break},extend:function(e){var t=arguments,n=[].slice.call(t,1,t.length);n.forEach((function(t){"object"==typeof t&&Object.getOwnPropertyNames(t).forEach((function(n){e[n]=t[n]}))}));return e},sanitizeStructuredClone:function(e){var t=[Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer],n=[Error,Node],i=L.warn,r=[];return function e(o){if("function"==typeof o){i("A function was detected and removed from the message.");return null}if(n.some((function(e){if(o instanceof e){i(e.name+" object was detected and removed from the message.");return!0}return!1})))return{};if(o&&"object"==typeof o&&t.every((function(e){return!(o instanceof e)}))){var a;if(Array.isArray(o))a=o.map((function(t){return e(t)}));else{if(r.indexOf(o)>-1){i("A circular reference was detected and removed from the message.");return null}r.push(o);a={};for(var s in o)if(o.hasOwnProperty(s)){var u=e(o[s]);null!==u&&(a[s]=u)}r.pop()}return a}return o}(e)},getOrigin:function(e,t){if("function"==typeof URL)try{return new URL(e,t).origin}catch(e){}var n=document.implementation.createHTMLDocument("");if(t){var i=n.createElement("base");i.href=t;n.head.appendChild(i)}var r=n.createElement("a");r.href=e;n.body.appendChild(r);var o=r.protocol+"//"+r.hostname;e.match(/\/\/[^/]+:[0-9]+\//)&&(o+=r.port?":"+r.port:"");return o}},T=function(e){n(i,e);var t=i.prototype;t._padUndefinedArguments=function(e,t){return e.length>=t?e:e.concat(new Array(t-e.length))};function i(t){var n;t=t||{};(n=e.call(this,t)||this)._registeredExtensions=t.extensions||{};n._registeredAPIModules={};n._registeredAPIModules._globals={};n._pendingCallbacks={};n._keycodeCallbacks={};n._clickHandlers=[];n._pendingEvents={};n._messageHandlers={init:n._handleInit,req:n._handleRequest,resp:n._handleResponse,broadcast:n._handleBroadcast,event_query:n._handleEventQuery,key_triggered:n._handleKeyTriggered,addon_clicked:n._handleAddonClick,get_host_offset:n._getHostOffset,unload:n._handleUnload};return n}t._verifyAPI=function(e,t){var n=e.data.targets;if(n){var i=this.getApiSpec(),r=!1;!function e(t,n){Object.getOwnPropertyNames(n).forEach((function(i){"object"==typeof n[i]&&t[i]?e(t[i],n[i]):"parent"===n[i]&&t[i]&&(r=!0)}))}(i,n);e.source&&e.source.postMessage?e.source.postMessage({type:"api_tamper",tampered:r},t.extension.url):console.warn("_verifyAPI postMessage skipped as event source missing.")}};t._handleInit=function(e,t){e.source&&e.source.postMessage?e.source.postMessage({type:"init_received"},t.extension.url):console.warn("_handleInit postMessage skipped as event source missing.");this._registeredExtensions[t.extension_id].source=e.source;if(t.initCallback){t.initCallback(e.data.eid);delete t.initCallback}e.data.targets&&this._verifyAPI(e,t)};t._getHostOffset=function(e,t){var n=e.source,i=null,r=t||window;r===r.top&&"function"==typeof r.getHostOffsetFunctionOverride&&(i=r.getHostOffsetFunctionOverride(n));if("number"!=typeof i){i=0;for(;!this._hasSameOrigin(n);){i++;n=n.parent}}e.source&&e.source.postMessage?e.source.postMessage({hostFrameOffset:i},e.origin):console.warn("_getHostOffset postMessage skipped as event source missing.")};t._hasSameOrigin=function(e){if(e===e.top)return!0;try{var t="test_var_"+Math.random().toString(16).substr(2);e[t]=!0;return e[t]}catch(e){}return!1};t._handleResponse=function(e){var t=e.data,n=this._pendingCallbacks[t.mid];if(n){delete this._pendingCallbacks[t.mid];n.apply(window,t.args)}};t.registerRequestNotifier=function(e){this._registeredRequestNotifier=e};t._handleRequest=function(e,t){function n(){var n=L.sanitizeStructuredClone(L.argumentsToArray(arguments));e.source&&e.source.postMessage?e.source.postMessage({mid:e.data.mid,type:"resp",forPlugin:!0,args:n},t.extension.url):console.warn("_handleRequest postMessage skipped as event source missing.")}var i=e.data,r=this._registeredAPIModules[i.mod],o=this.getRegisteredExtensions(t.extension)[0];if(r){var a=i.fn;if(i._cls){var s=r[i._cls],u=i.mod+"-"+i._cls+"-";n._id=i._id;if("constructor"===a){if(!s._construct){s.constructor.prototype._destroy=function(){delete this._context._proxies[u+this._id]};s._construct=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=A(s.constructor,t),r=t[t.length-1];i._id=r._id;i._context=r._context;i._context._proxies[u+i._id]=i;return i}}r=s;a="_construct"}else r=o._proxies[u+i._id]}var l=r[a];if(l){var c=i.args,d=l.length-1;"_construct"===a&&(d=r.constructor.length-1);n._context=o;(c=this._padUndefinedArguments(c,d)).push(n);var f=l.apply(r,c);l.returnsPromise&&("object"!=typeof f&&"function"!=typeof f||"function"!=typeof f.then?n("Defined module method did not return a promise."):f.then((function(e){n(void 0,e)})).catch((function(e){n(e=e instanceof Error?e.message:e)})));this._registeredRequestNotifier&&this._registeredRequestNotifier.call(null,{module:i.mod,fn:i.fn,type:i.type,args:c,addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})}}};t._handleBroadcast=function(e,t){var n=e.data;this.dispatch(n.etyp,(function(e){return e.extension.addon_key===t.extension.addon_key&&e.extension_id!==t.extension_id}),n.evnt,null,null)};t._handleKeyTriggered=function(e,t){var n=e.data,i=this._keycodeKey(n.keycode,n.modifiers,t.extension_id),r=this._keycodeCallbacks[i];r&&r.forEach((function(e){e.call(null,{addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id,keycode:n.keycode,modifiers:n.modifiers})}),this)};t.defineAPIModule=function(e,t){t=t||"_globals";this._registeredAPIModules[t]=L.extend({},this._registeredAPIModules[t]||{},e);return this._registeredAPIModules};t.isAPIModuleDefined=function(e){return void 0!==this._registeredAPIModules[e]};t._pendingEventKey=function(e,t){var n=e.addon_key||"global";e.key&&(n=n+"@@"+e.key);return n=n+"@@"+t};t.queueEvent=function(e,t,n,i){if(this._findRegistrations(t).some((function(e){return void 0!==e.registered_events}),this))this.dispatch(e,t,n,i);else{this._cleanupInvalidEvents();var r=(new Date).getTime();this._pendingEvents[this._pendingEventKey(t,r)]={type:e,targetSpec:t,event:n,callback:i,time:r,uid:L.randomString()}}};t._cleanupInvalidEvents=function(){var e=this,t=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(n){var i=e._pendingEvents[n];t-i.time<=3e4||delete e._pendingEvents[n]}))};t._handleEventQuery=function(e,t){var n=this,i={},r=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(o){var a=n._pendingEvents[o],s=r-a.time<=3e4,u=!a.targetSpec||0!==n._findRegistrations(a.targetSpec).length;u&&a.targetSpec.key&&(u=a.targetSpec.addon_key===t.extension.addon_key&&a.targetSpec.key===t.extension.key);if(s&&u){i[o]=a;a.targetSpec=a.targetSpec||{};n.dispatch(a.type,a.targetSpec,a.event,a.callback,e.source)}else s||delete n._pendingEvents[o]}));this._registeredExtensions[t.extension_id].registered_events=e.data.args;return i};t._handleUnload=function(e,t){if(t){t.extension_id&&this._registeredExtensions[t.extension_id]&&delete this._registeredExtensions[t.extension_id].source;t.unloadCallback&&t.unloadCallback(e.data.eid)}};t.dispatch=function(e,t,n,i,r){function o(t,n){if(t.source&&t.source.postMessage){var r;if(i){r=L.randomString();this._pendingCallbacks[r]=i}t.source.postMessage({type:"evt",mid:r,etyp:e,evnt:n},t.extension.url)}}this._findRegistrations(t||{}).forEach((function(e){r&&!e.source&&(e.source=r);e.source&&L._bind(this,o)(e,n)}),this)};t._findRegistrations=function(e){var t=this;if(0===this._registeredExtensions.length){L.error("no registered extensions",this._registeredExtensions);return[]}var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(this._registeredExtensions).map((function(e){return t._registeredExtensions[e]}));return e instanceof Function?i.filter(e):i.filter((function(t){return n.every((function(n){return t.extension[n]===e[n]}))}))};t.registerExtension=function(e,t){t._proxies={};t.extension_id=e;this._registeredExtensions[e]=t};t._keycodeKey=function(e,t,n){var i=e;if(t){"string"==typeof t&&(t=[t]);t.sort();t.forEach((function(e){i+="$$"+e}),this)}return i+"__"+n};t.registerKeyListener=function(e,t,n,i){"string"==typeof n&&(n=[n]);var r=this._registeredExtensions[e],o=this._keycodeKey(t,n,e);if(!this._keycodeCallbacks[o]){this._keycodeCallbacks[o]=[];r.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"add"},r.extension.url)}this._keycodeCallbacks[o].push(i)};t.unregisterKeyListener=function(e,t,n,i){var r=this._keycodeKey(t,n,e),o=this._keycodeCallbacks[r],a=this._registeredExtensions[e];if(o){if(i){var s=o.indexOf(i);this._keycodeCallbacks[r].splice(s,1)}else delete this._keycodeCallbacks[r];a.source&&a.source.postMessage&&a.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"remove"},a.extension.url)}};t.registerClickHandler=function(e){if("function"!=typeof e)throw new Error("callback must be a function");this._clickHandlers.push(e)};t._handleAddonClick=function(e,t){for(var n=0;n<this._clickHandlers.length;n++)"function"==typeof this._clickHandlers[n]&&this._clickHandlers[n]({addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})};t.unregisterClickHandler=function(){this._clickHandlers=[]};t.getApiSpec=function(e){var t=this;function n(e){return Object.getOwnPropertyNames(e).reduce((function(t,i){var r=e[i];switch(typeof r){case"function":t[i]={args:L.argumentNames(r),returnsPromise:r.returnsPromise||!1};break;case"object":r.hasOwnProperty("constructor")&&(t[i]=n(r))}return t}),{})}return Object.getOwnPropertyNames(this._registeredAPIModules).reduce((function(i,r){var o=t._registeredAPIModules[r];void 0!==o.addonKey&&o.addonKey!==e||(i[r]=n(o));return i}),{})};t._originEqual=function(e,t){function n(e){return"string"==typeof e&&e.length>0}var i=L.getOrigin(e);return!!(n(e)&&n(t)&&n(i))&&t===i};t._checkOrigin=function(e,t){var n=t&&["init"].includes(e.data.type),i=t&&e.source===t.source,r=t&&this._originEqual(t.extension.url,e.origin)&&(n||i);"get_host_offset"===e.data.type&&window===window.top&&(r=!0);"unload"!==e.data.type||!i&&void 0!==e.source||(r=!0);return r};t.getRegisteredExtensions=function(e){return e?this._findRegistrations(e):this._registeredExtensions};t.unregisterExtension=function(e){var t=this._findRegistrations(e);0!==t.length&&t.forEach((function(e){var t=this;Object.keys(this._pendingEvents).forEach((function(n){var i=t._pendingEvents[n].targetSpec||{};i.addon_key===e.extension.addon_key&&i.key===e.extension.key&&delete t._pendingEvents[n]}));delete this._registeredExtensions[e.extension_id]}),this)};t.setFeatureFlagGetter=function(e){this._getBooleanFeatureFlag=e};return i}(function(){function e(e){var t=e||{};this._registerListener(t.listenOn)}var t=e.prototype;t._registerListener=function(e){e&&e.addEventListener||(e=window);e.addEventListener("message",L._bind(this,this._receiveMessage),!1)};t._receiveMessage=function(e){var t,n=this._messageHandlers[e.data.type],i=e.data.eid;i&&this._registeredExtensions&&(t=this._registeredExtensions[i]);if(!n||!this._checkOrigin(e,t))return!1;n.call(this,e,t)};return e}()),P=["platform-visual-refresh-icons"];var D=function(){function e(){this._xdm=new T}var t=e.prototype;t.dispatch=function(e,t,n,i){this._xdm.queueEvent(e,t,n,i);return this.getExtensions(t)};t.broadcast=function(e,t,n){this._xdm.dispatch(e,t,n,null,null);return this.getExtensions(t)};t._createId=function(e){if(!e.addon_key||!e.key)throw Error("Extensions require addon_key and key");return e.addon_key+"__"+e.key+"__"+L.randomString()};t.create=function(e,t,n){var i=this.registerExtension(e,t,n),r=e.options||{};r.platformFeatureFlags=function(){var e={};window.connectHost&&window.connectHost.getBooleanFeatureFlag&&P.forEach((function(t){return e[t]=window.connectHost.getBooleanFeatureFlag(t)}));return e}();var o={extension_id:i,api:this._xdm.getApiSpec(e.addon_key),origin:L.locationOrigin(),options:r};return{id:i,name:JSON.stringify(o),src:e.url}};t.registerRequestNotifier=function(e){this._xdm.registerRequestNotifier(e)};t.registerExtension=function(e,t,n){var i=this._createId(e);this._xdm.registerExtension(i,{extension:e,initCallback:t,unloadCallback:n});return i};t.registerKeyListener=function(e,t,n,i){this._xdm.registerKeyListener(e,t,n,i)};t.unregisterKeyListener=function(e,t,n,i){this._xdm.unregisterKeyListener(e,t,n,i)};t.registerClickHandler=function(e){this._xdm.registerClickHandler(e)};t.unregisterClickHandler=function(){this._xdm.unregisterClickHandler()};t.defineModule=function(e,t,n){this._xdm.defineAPIModule(t,e,n)};t.isModuleDefined=function(e){return this._xdm.isAPIModuleDefined(e)};t.defineGlobals=function(e){this._xdm.defineAPIModule(e)};t.getExtensions=function(e){return this._xdm.getRegisteredExtensions(e)};t.unregisterExtension=function(e){return this._xdm.unregisterExtension(e)};t.returnsPromise=function(e){e.returnsPromise=!0};t.setFeatureFlagGetter=function(e){this._xdm.setFeatureFlagGetter(e)};t.registerExistingExtension=function(e,t){return this._xdm.registerExtension(e,t)};return e}(),M=new D,j=["contextJwt","url"],F=function(e){var t;return"dialogs"!==(null==e||null==(t=e.extension)||null==(t=t.options)?void 0:t.moduleType)},V=function(e,t,n){M.dispatch(e,t,n);v.dispatch("event-dispatch",{type:e,targetSpec:t,event:n})},N=function(e,t,n){v.dispatch("event-public-dispatch",{type:e,event:t,sender:n});var i=n.options||{};i.contextJwt;i.url;var r=O(i,j);M.dispatch(e,{},{sender:{addonKey:n.addon_key,key:n.key,options:L.sanitizeStructuredClone(r)},event:t})};function R(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}var G,U={escapeSelector:R,stringToDimension:function(e){var t=!1,n="px";if("string"==typeof e){t=e.indexOf("%")===e.length-1;e=parseInt(e,10);t&&(n="%")}if(!isNaN(e))return e+n},getIframeByExtensionId:function(e){return _("iframe#"+R(e))},first:function(e,t){return t?e.slice(0,t):e[0]},last:function(e){return e[e.length-1]},pick:function(e,t){return"object"!=typeof e?{}:Object.keys(e).filter((function(e){return t.indexOf(e)>=0})).reduce((function(t,n){var i;return Object.assign(t,((i={})[n]=e[n],i))}),{})},debounce:function(e,t){var n;return function(){var i=this,r=[].slice.call(arguments);function o(){n=null;e.apply(i,r)}n&&clearTimeout(n);n=setTimeout(o,t||50)}},isSupported:function(e,t,n,i){return e&&e[t]&&e[t].supports?e[t].supports(n):i},extend:Object.assign,guessProductFromModuleDefined:function(e){return e.isModuleDefined("jira")?"Jira":e.isModuleDefined("confluence")?"Confluence":""}},B={emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=U.last(n);n=U.first(n,-1);V(e,{addon_key:r._context.extension.addon_key},n)},emitPublic:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=U.last(n),o=r._context.extension;n=U.first(n,-1);N(e,n,o)},emitToDataProvider:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=U.last(t);i._context.extension;t=U.first(t,-1);V("dataProviderEvent",{addon_key:i._context.extension.addon_key},t)}},z=function(e,t){v.dispatch("dialog-extension-open",{extension:e,options:t})},K=function(){v.dispatch("dialog-close-active",{})},$=function(e,t){v.dispatch("dialog-button-add",{button:{text:e.text,identifier:e.identifier,data:{userButton:!0}},extension:t})},J={close:function(e){v.dispatch("dialog-close",{dialog:e.dialog,extension:e.extension,customData:e.customData})},closeActive:function(e){v.dispatch("dialog-close-active",e)},clickButton:function(e,t,n){v.dispatch("dialog-button-click",{identifier:e,$el:t,extension:n})},toggleButton:function(e){v.dispatch("dialog-button-toggle",e)},toggleButtonVisibility:function(e){v.dispatch("dialog-button-toggle-visibility",e)}},W=function(e){M.registerKeyListener(e.extension_id,e.key,e.modifiers,e.callback);v.dispatch("dom-event-register",e)},q=function(e){M.unregisterKeyListener(e.extension_id,e.key,e.modifiers,e.callback);v.dispatch("dom-event-unregister",e)},H=function(e){window.addEventListener("keydown",(function(t){t.keyCode===e.keyCode&&e.callback()}))},Y=function(e){M.registerClickHandler((function(t){var n=document.getElementById(t.extension_id);n&&e(n,t)}))},X=function(){M.unregisterClickHandler()},Q=new(function(){function e(){}e.prototype.randomIdentifier=function(){return Math.random().toString(16).substring(7)};return e}()),Z=[];if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window){var ee=new IntersectionObserver((function(e){e.forEach((function(e){var t=e.intersectionRatio,n=e.target;if(t>0){ee.unobserve(n);!function(e){Z=Z.filter((function(t){var n=t.element,i=t.callback;if(n===e){i();return!1}return!0}))}(n)}}))}),{threshold:.25});G=ee.observe.bind(ee)}var te=["saveMacro"],ne=function(){function t(){this._addons={};this._sampleLoadEvent=new Map}var n=t.prototype;n._shouldSampleEvent=function(e){return 100*Math.random()<=e};n._shouldSampleLoadEvent=function(e){if(this._sampleLoadEvent.has(e.id))return this._sampleLoadEvent.get(e.id);var t=this._shouldSampleEvent(1);this._sampleLoadEvent.set(e.id,t);return t};n._trackGasV3=function(e,t,n){t.attributes&&(t.attributes.apVersion=window._AP&&window._AP.version?window._AP.version:void 0);n&&this._forwardGasV3AnalyticsEvent(e,t);try{window.require("ac/analytics").emitGasV3(e,t)}catch(e){window.Confluence||window.__karma__||console.info("Connect GasV3 catch",e)}};n._trackAndForwardGasV3=function(e,t){this._trackGasV3(e,t,!0)};n._forwardGasV3AnalyticsEvent=function(e,t){v.dispatch("analytics-forward-event",e,t)};n._time=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()};n.trackLoadingStarted=function(e){if(this._addons&&e&&e.id){e.startLoading=this._time();this._addons[e.id]=e}else console.error("ACJS: cannot track loading analytics",this._addons,e)};n.trackGasV3UseOfDeprecatedMethod=function(e,t){this._trackAndForwardGasV3("operational",{action:"deprecatedMethod",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,methodUsed:e},source:t.addon_key})};n.trackGasV3MultipleDialogOpening=function(e,t){this._trackAndForwardGasV3("operational",{action:"multipleDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,dialogType:e},source:t.addon_key})};n.trackIframePerformance=function(e,t){this._shouldSampleLoadEvent(t)&&this._trackGasV3("operational",{source:t.addon_key,action:"iframeRendered",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{key:t.key,pearApp:this._getPearApp(t),moduleType:this._getModuleType(t),iframeIsCacheable:this._isCacheable(t),moduleLocation:this._getModuleLocation(t),domainLookupTime:e.domainLookupTime,connectionTime:e.connectionTime,decodedBodySize:e.decodedBodySize,domContentLoadedTime:e.domContentLoadedTime,fetchTime:e.fetchTime}})};n.trackGasV3WebVitals=function(e,t){this._shouldSampleLoadEvent(t)&&this._trackAndForwardGasV3("operational",{source:t.addon_key,action:"webVitals",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:Object.assign({},e,{key:t.key,pearApp:this._getPearApp(t),moduleType:this._getModuleType(t),iframeIsCacheable:this._isCacheable(t),moduleLocation:this._getModuleLocation(t)})})};n.dispatch=function(e,t){this._trackGasV3External(e,t)};n.trackExternal=function(e,t){this._trackGasV3External(e,t)};n._trackGasV3External=function(t,n){this._trackAndForwardGasV3("operational",{action:"externalEvent",actionSubject:"connectAddon",actionSubjectId:t,attributes:e({eventName:t},"object"==typeof n?n:{values:n}),source:"connectAddon"})};n._resetAnalyticsDueToUnreliable=function(e){if(!e)throw new Error("Cannot reset analytics due to no extension id");if(this._addons[e]){clearTimeout(this._addons[e]);delete this._addons[e]}else console.info("Cannot clear analytics, cache does not contain extension id")};n._isCacheable=function(e){var t=e.url;return void 0!==t&&-1===t.indexOf("xdm_e=")};n._getModuleType=function(e){return e.options?e.options.moduleType:void 0};n._getModuleLocation=function(e){return e.options?e.options.moduleLocation:void 0};n._getPearApp=function(e){return e.options&&"true"===e.options.pearApp};n.trackGasV3Visible=function(e){this._shouldSampleLoadEvent(e)&&this._trackGasV3("operational",{action:"iframeViewed",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})};n.trackGasV3InvokeMethod=function(e,t,n,i){if(this._shouldSampleEvent(.1)||te.includes(n)){for(var r,o=Array.isArray(i)?[].concat(i):[];o.length>0&&(void 0===o[o.length-1]||"function"==typeof(r=o[o.length-1])&&Boolean(r._context));)o.pop();var a=o.map((function(e){return Array.isArray(e)?"array":null===e?"null":typeof e}));this._trackAndForwardGasV3("operational",{action:"invokeMethod",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{argCount:o.length,argTypes:a,module:t,method:n,moduleType:this._getModuleType(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})}};n.trackGasV3ContentResolver=function(e,t){if(this._shouldSampleEvent(.1)){var n=t.extension,i=t.attrs,r=e?"contentResolverSucceeded":"contentResolverFailed";this._trackGasV3("operational",{action:r,actionSubject:"connectAddon",actionSubjectId:n.addon_key,attributes:Object.assign({},i,{moduleType:this._getModuleType(n),moduleKey:n.key,moduleLocation:this._getModuleLocation(n),pearApp:this._getPearApp(n)}),source:n.addon_key})}};n.trackGasV3LoadingEnded=function(e){if(this._shouldSampleLoadEvent(e)){var t,n,i=this._time()-this._addons[e.id].startLoading;this._trackGasV3("operational",{action:"iframeLoaded",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),iframeLoadMillis:i,iframeLoadBucket:(t=i,n=t>2e4?2e4:t,100*Math.ceil(n/100)),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})}};n.trackGasV3LoadingTimeout=function(e){this._shouldSampleLoadEvent(e)&&this._trackGasV3("operational",{action:"iframeTimeout",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e),connectedStatus:"boolean"==typeof window.navigator.onLine?window.navigator.onLine.toString():"not-supported"},source:e.addon_key})};n.trackGasV3InlineDialogOpened=function(e){var t=e.extension;this._trackAndForwardGasV3("operational",{action:"inlineDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,moduleLocation:this._getModuleLocation(t),eventType:e.eventType,onHoverEnabled:e.onHover},source:t.addon_key})};n.trackGasV3LegacyDialogOpened=function(e){var t=e.extension;this._trackAndForwardGasV3("operational",{action:"legacyDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,moduleLocation:this._getModuleLocation(t),parentIds:e.parentIds},source:t.addon_key})};n.trackGasV3FeatureFlagDefaultFalse=function(e){var t;this._trackAndForwardGasV3("operational",((t={action:"returned",actionSubject:"defaultFalseFeatureFlag",actionSubjectId:e,source:"host",attributes:{featureFlag:e}}).source="Host",t))};n.trackGasV3IframeClicked=function(e){this._trackAndForwardGasV3("ui",{action:"iframeClicked",actionSubject:"connectAddon",source:"host",attributes:{appId:e.addonKey,moduleType:e.moduleType,moduleLocation:e.moduleLocation,baseUrl:e.baseUrl}})};return t}(),ie=new ne;_.fn&&v.register("iframe-create",(function(e){ie.trackLoadingStarted(e.extension)}));v.register("method-invoked",(function(e){ie.trackGasV3InvokeMethod(e.extension,e.module,e.fn,e.args)}));v.register("iframe-bridge-start",(function(e){ie.trackLoadingStarted(e.extension)}));v.register("iframe-bridge-established",(function(e){ie.trackGasV3LoadingEnded(e.extension);!function(e,t){if("function"==typeof t&&e instanceof Element){Z.push({element:e,callback:t});G(e)}}(document.getElementById(e.extension.id),(function(){v.dispatch("iframe-visible",e.extension);ie.trackGasV3Visible(e.extension)}))}));v.register("iframe-bridge-timeout",(function(e){ie.trackGasV3LoadingTimeout(e.extension)}));v.register("analytics-deprecated-method-used",(function(e){ie.trackGasV3UseOfDeprecatedMethod(e.methodUsed,e.extension)}));v.register("analytics-iframe-performance",(function(e){ie.trackIframePerformance(e.metrics,e.extension)}));v.register("analytics-web-vitals",(function(e){ie.trackGasV3WebVitals(e.metrics,e.extension)}));v.register("iframe-destroyed",(function(e){ie._resetAnalyticsDueToUnreliable(e.extension.extension_id)}));v.register("analytics-external-event-track",(function(e){ie.trackExternal(e.eventName,e.values)}));v.register("analytics-content-resolver-track",(function(e){var t=e.success,n=e.extra;ie.trackGasV3ContentResolver(t,n)}));v.register("analytics-inline-dialog-opened",(function(e){ie.trackGasV3InlineDialogOpened(e)}));v.register("analytics-legacy-dialog-opened",(function(e){ie.trackGasV3LegacyDialogOpened(e)}));v.register("analytics-track-iframe-clicked",(function(e){ie.trackGasV3IframeClicked(e)}));var re=new(function(){function e(){}var t=e.prototype;t._maxDimension=function(e,t){var n=U.stringToDimension(e),i=parseInt(n,10),r=parseInt(t,10);return n.indexOf("%")>-1&&i>=100||i>r?"100%":n};t._closeOnEscape=function(e){return!1!==e.closeOnEscape};t._size=function(e){var t=e.size;"x-large"===e.size&&(t="xlarge");"maximum"!==e.size&&"100%"===e.width&&"100%"===e.height&&(t="fullscreen");return t};t._header=function(e){var t="";switch(typeof e){case"string":t=e;break;case"object":t=e.value}return t};t._hint=function(e){return"string"==typeof e?e:""};t._chrome=function(e){var t=!1;"boolean"==typeof e.chrome&&(t=e.chrome);"fullscreen"===e.size&&(t=!0);"maximum"===e.size&&(t=!1);return t};t._width=function(e){if(!e.size)return e.width?this._maxDimension(e.width,_(window).width()):"50%"};t._height=function(e){if(!e.size)return e.height?this._maxDimension(e.height,_(window).height()):"50%"};t._actions=function(e){var t=[];(e=e||{}).actions||(t=[{name:"submit",identifier:"submit",text:e.submitText||"Submit",type:"primary",disabled:!0},{name:"cancel",identifier:"cancel",text:e.cancelText||"Cancel",type:"link",immutable:!0}]);e.buttons&&(t=t.concat(this._buttons(e)));return t};t._id=function(e){"string"!=typeof e&&(e=Math.random().toString(36).substring(2,8));return e};t._buttons=function(e){var t=[];e.buttons&&Array.isArray(e.buttons)&&e.buttons.forEach((function(e){var n,i,r=!1;e.text&&"string"==typeof e.text&&(n=e.text);i=e.identifier&&"string"==typeof e.identifier?e.identifier:Q.randomIdentifier();e.disabled&&!0===e.disabled&&(r=!0);t.push({text:n,identifier:i,type:"secondary",custom:!0,disabled:r})}));return t};t._onHide=function(e){return"function"==typeof e.onHide?e.onHide:function(){}};t.sanitizeOptions=function(e){e=e||{};var t={chrome:this._chrome(e),header:this._header(e.header),hint:this._hint(e.hint),width:this._width(e),height:this._height(e),$content:e.$content,extension:e.extension,actions:this._actions(e),id:this._id(e.id),size:e.size,closeOnEscape:this._closeOnEscape(e),onHide:this._onHide(e)};t.size=this._size(t);return t};t.moduleOptionsFromGlobal=function(e,t){return!!(window._AP&&window._AP.dialogModules&&window._AP.dialogModules[e]&&window._AP.dialogModules[e][t])&&U.extend({},{chrome:!0,hostFrameOffset:1},window._AP.dialogModules[e][t].options)};t.trackMultipleDialogOpening=function(e,t){var n,i=this._size(t);if(_(".ap-aui-dialog2:visible").length){n=_("#macro-browser-dialog").length||AJS.Confluence&&AJS.Confluence.Editor&&AJS.Confluence.Editor.currentEditMode?"fullscreen"===i?"connect-macro-multiple-fullscreen":"connect-macro-multiple":"connect-multiple";ie.trackGasV3MultipleDialogOpening(n,e)}};t.assertActiveDialogOrThrow=function(e,t){if(!e.isActiveDialog(t))throw new Error("Failed to find an active dialog for: "+t)};return e}()),oe={notifyIframeCreated:function(e,t){v.dispatch("iframe-create",{$el:e,extension:t})},notifyBridgeEstablished:function(e,t){v.dispatch("iframe-bridge-established",{$el:e,extension:t})},notifyIframeDestroyed:function(e){"string"==typeof e&&(e={id:e});M.getExtensions(e).forEach((function(e){v.dispatch("iframe-destroyed",{extension:e});M.unregisterExtension({id:e.extension_id})}),this)},notifyUnloaded:function(e,t){v.dispatch("iframe-unload",{$el:e,extension:t})}},ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function se(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ue={},le=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))},ce="%[a-f0-9]{2}",de=new RegExp("("+ce+")|([^%]+?)","gi"),fe=new RegExp("("+ce+")+","gi");function pe(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],pe(n),pe(i))}function he(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(de)||[],n=1;n<t.length;n++)t=(e=pe(t,n).join("")).match(de)||[];return e}}var ge=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{e=e.replace(/\+/g," ");return decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=fe.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=he(n[0]);i!==n[0]&&(t[n[0]]=i)}n=fe.exec(e)}t["%C2"]="�";for(var r=Object.keys(t),o=0;o<r.length;o++){var a=r[o];e=e.replace(new RegExp(a,"g"),t[a])}return e}(e)}},ve=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},ye=function(e,t){for(var n={},i=Object.keys(e),r=Array.isArray(t),o=0;o<i.length;o++){var a=i[o],s=e[a];(r?-1!==t.indexOf(a):t(a,s,e))&&(n[a]=s)}return n};!function(e){const t=le,n=ge,i=ve,r=ye,o=Symbol("encodeFragmentIdentifier");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,n){return n.encode?n.strict?t(e):encodeURIComponent(e):e}function u(e,t){return t.decode?n(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function c(e){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t));return e}function d(e){const t=(e=c(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase());return e}function p(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e);e=e.replace(/\[\d*\]$/,"");if(t){void 0===i[e]&&(i[e]={});i[e][t[1]]=n}else i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e);e=e.replace(/\[\]$/,"");t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"colon-list-separator":return(e,n,i)=>{t=/(:list)$/.exec(e);e=e.replace(/:list$/,"");t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const r="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!r&&u(n,e).includes(e.arrayFormatSeparator);n=o?u(n,e):n;const a=r||o?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);i[t]=a};case"bracket-separator":return(t,n,i)=>{const r=/(\[\])$/.test(t);t=t.replace(/\[\]$/,"");if(!r){i[t]=n?u(n,e):n;return}const o=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>u(t,e)));void 0!==i[t]?i[t]=[].concat(i[t],o):i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const o of e.split("&")){if(""===o)continue;let[e,a]=i(t.decode?o.replace(/\+/g," "):o,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:u(a,t);n(u(e,t),a,r)}for(const e of Object.keys(r)){const n=r[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=f(n[e],t);else r[e]=f(n,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=l(n):e[t]=n;return e}),Object.create(null))}e.extract=d;e.parse=p;e.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const r=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[s(t,e),"[",r,"]"].join("")]:[...n,[s(t,e),"[",s(r,e),"]=",s(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(i,e)].join("")];case"colon-list-separator":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[s(t,e),":list="].join("")]:[...n,[s(t,e),":list=",s(i,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(i,r)=>{if(void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r)return i;r=null===r?"":r;return 0===i.length?[[s(n,e),t,s(r,e)].join("")]:[[i,s(r,e)].join(e.arrayFormatSeparator)]}}default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,s(t,e)]:[...n,[s(t,e),"=",s(i,e)].join("")]}}(t),r={};for(const t of Object.keys(e))n(t)||(r[t]=e[t]);const o=Object.keys(r);!1!==t.sort&&o.sort(t.sort);return o.map((n=>{const r=e[n];return void 0===r?"":null===r?s(n,t):Array.isArray(r)?0===r.length&&"bracket-separator"===t.arrayFormat?s(n,t)+"[]":r.reduce(i(n),[]).join("&"):s(n,t)+"="+s(r,t)})).filter((e=>e.length>0)).join("&")};e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:p(d(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:u(r,t)}:{})};e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0,[o]:!0},n);const i=c(t.url).split("?")[0]||"",r=e.extract(t.url),a=e.parse(r,{sort:!1}),u=Object.assign(a,t.query);let l=e.stringify(u,n);l&&(l=`?${l}`);let d=function(e){let t="";const n=e.indexOf("#");-1!==n&&(t=e.slice(n));return t}(t.url);t.fragmentIdentifier&&(d=`#${n[o]?s(t.fragmentIdentifier,n):t.fragmentIdentifier}`);return`${i}${l}${d}`};e.pick=(t,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[o]:!1},i);const{url:a,query:s,fragmentIdentifier:u}=e.parseUrl(t,i);return e.stringifyUrl({url:a,query:r(s,n),fragmentIdentifier:u},i)};e.exclude=(t,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return e.pick(t,r,i)}}(ue);for(var me=function(e){for(var t,n=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);return[n,n===t?0:4-n%4]}(e),i=n[0],r=n[1],o=new we(function(e,t,n){return 3*(t+n)/4-n}(0,i,r)),a=0,s=r>0?i-4:i,u=0;u<s;u+=4){t=be[e.charCodeAt(u)]<<18|be[e.charCodeAt(u+1)]<<12|be[e.charCodeAt(u+2)]<<6|be[e.charCodeAt(u+3)];o[a++]=t>>16&255;o[a++]=t>>8&255;o[a++]=255&t}if(2===r){t=be[e.charCodeAt(u)]<<2|be[e.charCodeAt(u+1)]>>4;o[a++]=255&t}if(1===r){t=be[e.charCodeAt(u)]<<10|be[e.charCodeAt(u+1)]<<4|be[e.charCodeAt(u+2)]>>2;o[a++]=t>>8&255;o[a++]=255&t}return o},_e=[],be=[],we="undefined"!=typeof Uint8Array?Uint8Array:Array,xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ee=0,ke=xe.length;Ee<ke;++Ee){_e[Ee]=xe[Ee];be[xe.charCodeAt(Ee)]=Ee}be["-".charCodeAt(0)]=62;be["_".charCodeAt(0)]=63;function Oe(e){var t=4-e.length%4;1===t?e+="=":2===t&&(e+="==");return(new TextDecoder).decode(me(e))}var Se=60;function Ae(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(t<0||n<=t)throw'Invalid JWT: must contain 2 period (".") characters.';var i=e.substring(t+1,n);if(null===i||""===i)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var r=Oe.call(window,i);return JSON.parse(r)}v.register("jwt-skew-set",(function(e){Se=e.skew}));var Ce={parseJwtIssuer:function(e){return Ae(e).iss},parseJwtClaims:Ae,isJwtExpired:function(e,t){void 0===t&&(t=Se);var n=Ae(e),i=0,r=Math.floor(Date.now()/1e3);n&&n.exp&&(i=n.exp);return i-t<r}};function Ie(e){return ue.parse(ue.extract(e)).jwt}var Le={hasJwt:function(e){return Ie(e)&&0!==Ie(e).length},isJwtExpired:function(e){var t=Ie(e);return Ce.isJwtExpired(t)}},Te=function(e){v.dispatch("content-resolver-register-by-extension",e)},Pe=function(e){if(!e.resolver)throw Error("ACJS: No content resolver supplied");var t=e.resolver.call(null,U.extend({classifier:"json"},e.extension));t.fail((function(t,n){v.dispatch("jwt-url-refreshed-failed",{extension:e.extension,$container:e.$container,errorText:n.text})}));t.done((function(t){var n={};if("object"==typeof t)n=t;else if("string"==typeof t)try{n=JSON.parse(t)}catch(e){console.error("ACJS: invalid response from content resolver")}e.extension.url=n.url;U.extend(e.extension.options,n.options);v.dispatch("jwt-url-refreshed",{extension:e.extension,$container:e.$container,url:e.extension.url})}));v.dispatch("jwt-url-refresh-request",{data:e})},De=function(e){"number"==typeof e?v.dispatch("jwt-skew-set",{skew:e}):console.error("ACJS: invalid JWT clock skew set")},Me=function(e){var t={};if(e&&"object"==typeof e){e.width&&(t.width=U.stringToDimension(e.width));e.height&&(t.height=U.stringToDimension(e.height));if("string"==typeof e.sandbox){var n=document.createElement("iframe");t.sandbox=e.sandbox.split(" ").filter((function(e){return U.isSupported(n,"sandbox",e,!0)})).join(" ")}}return t},je=new(function(){function e(){this.store={}}var t=e.prototype;t.set=function(e,t){if(t){var n={};n[e]=t}else n=e;U.extend(this.store,n)};t.get=function(e){return e?this.store[e]:U.extend({},this.store)};return e}());function Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Ne(e){var t=function(e,t){if("object"!==Ve(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==Ve(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ve(t)?t:String(t)}function Re(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1;i.configurable=!0;"value"in i&&(i.writable=!0);Object.defineProperty(e,Ne(i.key),i)}}function Ge(e,t,n){t&&Re(e.prototype,t);n&&Re(e,n);Object.defineProperty(e,"prototype",{writable:!1});return e}function Ue(e,t,n){(t=Ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);return"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(i,r)}function $e(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){Ke(o,i,r,a,s,"next",e)}function s(e){Ke(o,i,r,a,s,"throw",e)}a(void 0)}))}}var Je={exports:{}},We={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(We);!function(e){var t=We.exports.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var i,r={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},l=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",d=u.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(i){f=function(e,t,n){return e[t]=n}}function p(e,t,n,i){var r=t&&t.prototype instanceof _?t:_,o=Object.create(r.prototype),a=new P(i||[]);return s(o,"_invoke",{value:C(e,n,a)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var g="suspendedStart",v="executing",y="completed",m={};function _(){}function b(){}function w(){}var x={};f(x,l,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(D([])));k&&k!==o&&a.call(k,l)&&(x=k);var O=w.prototype=_.prototype=Object.create(x);function S(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,n){function i(r,o,s,u){var l=h(e[r],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==t(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){i("next",e,s,u)}),(function(e){i("throw",e,s,u)})):n.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return i("throw",e,s,u)}))}u(l.arg)}var r;s(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,r){i(e,t,n,r)}))}return r=r?r.then(o,o):o()}})}function C(e,t,n){var r=g;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:i,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=I(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===g)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var l=h(e,t,n);if("normal"===l.type){if(r=n.done?y:"suspendedYield",l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=y,n.method="throw",n.arg=l.arg)}}}function I(e,t){var n=t.method,r=e.iterator[n];if(r===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=i,I(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=i),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=i,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return b.prototype=w,s(O,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,d,"GeneratorFunction")),e.prototype=Object.create(O),e},r.awrap=function(e){return{__await:e}},S(A.prototype),f(A.prototype,c,(function(){return this})),r.AsyncIterator=A,r.async=function(e,t,n,i,o){void 0===o&&(o=Promise);var a=new A(p(e,t,n,i),o);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),f(O,d,"Generator"),f(O,l,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=D,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=i)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=i),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=i),m}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Je);var qe=Je.exports(),He=qe;try{regeneratorRuntime=qe}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=qe:Function("r","regeneratorRuntime = r")(qe)}var Ye={},Xe={};!function(e){var t,n,i=ae&&ae.__extends||(t=function(e,n){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};return t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});e.StatsigSDKKeyMismatchError=e.StatsigInvalidArgumentError=e.StatsigUninitializedError=e.StatsigErrorMessage=void 0;!function(e){e.REQUIRE_ASYNC_INITIALIZE="Call initialize() first.";e.REQUIRE_SYNC_INITIALIZE="Call and wait for initialize() to finish first.";e.REQUIRE_INITIALIZE_FOR_LOG_EVENT="Must initialize() before logging events."}(n=e.StatsigErrorMessage||(e.StatsigErrorMessage={}));var r=function(e){i(t,e);function t(i){var r=e.call(this,null!=i?i:n.REQUIRE_SYNC_INITIALIZE)||this;Object.setPrototypeOf(r,t.prototype);return r}return t}(Error);e.StatsigUninitializedError=r;var o=function(e){i(t,e);function t(n){var i=e.call(this,n)||this;Object.setPrototypeOf(i,t.prototype);return i}return t}(Error);e.StatsigInvalidArgumentError=o;var a=function(e){i(t,e);function t(n){var i=e.call(this,n)||this;Object.setPrototypeOf(i,t.prototype);return i}return t}(Error);e.StatsigSDKKeyMismatchError=a}(Xe);var Qe={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});var et=function(){function e(e,t,n,i,r,o,a){void 0===r&&(r=[]);void 0===o&&(o="");void 0===a&&(a=null);this._onDefaultValueFallback=null;this.value=JSON.parse(JSON.stringify(null!=t?t:{}));this._name=e;this._ruleID=null!=n?n:"";this._secondaryExposures=r;this._allocatedExperimentName=o;this._evaluationDetails=i;this._onDefaultValueFallback=a}e.prototype.get=function(e,t,n){var i,r,o=this.getValue(e,t);if(null==o)return t;var a=Array.isArray(t)?"array":typeof t,s=Array.isArray(o)?"array":typeof o;if(n){if(n(o))return o;null===(i=this._onDefaultValueFallback)||void 0===i||i.call(this,this,e,a,s);return t}if(null==t||a===s)return o;null===(r=this._onDefaultValueFallback)||void 0===r||r.call(this,this,e,a,s);return t};e.prototype.getValue=function(e,t){if(null==e)return this.value;null==t&&(t=null);return null==this.value[e]?t:this.value[e]};return e}();Ze.default=et;var tt={};!function(e){var t=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0});e.ExceptionEndpoint=void 0;var i=Xe;e.ExceptionEndpoint="https://statsigapi.net/v1/sdk_exception";var r=function(){function r(e,t){this._seen=new Set;this._sdkKey=e;this._options=t}r.prototype._setStatsigMetadata=function(e){this._statsigMetadata=e};r.prototype._swallow=function(e,t){this._capture(e,t,(function(){}))};r.prototype._capture=function(e,t,n,i){var r=this;try{var o=t();return o instanceof Promise?o.catch((function(t){return r._onCaught(e,t,n,i)})):o}catch(t){return this._onCaught(e,t,n,i)}};r.prototype._logError=function(i,r,o){var a=this;if(!this._options.disableAllLogging)try{t(a,void 0,void 0,(function(){var t,a,s,u,l,c,d,f,p;return n(this,(function(n){switch(n.label){case 0:return"function"!=typeof o?[3,2]:[4,o()];case 1:a=n.sent();return[3,3];case 2:a=null;n.label=3;case 3:t=a;s=null!=r?r:Error("[Statsig] Error was empty");u=s instanceof Error;l=u?s.name:"No Name";if(this._seen.has(l))return[2];this._seen.add(l);c=u?s.stack:this._getDescription(s);d=null!==(p=this._statsigMetadata)&&void 0!==p?p:{};f=JSON.stringify({tag:i,exception:l,info:c,statsigMetadata:d,extra:null!=t?t:{}});return[2,fetch(e.ExceptionEndpoint,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(d.sdkType),"STATSIG-SDK-VERSION":String(d.sdkVersion),"Content-Type":"application/json","Content-Length":"".concat(f.length)},body:f})]}}))})).then((function(){})).catch((function(){}))}catch(e){}};r.prototype._onCaught=function(e,t,n,r){if(t instanceof i.StatsigUninitializedError||t instanceof i.StatsigInvalidArgumentError)throw t;console.error("[Statsig] An unexpected exception occurred.",t);this._logError(e,t,r);return n()};r.prototype._getDescription=function(e){try{return JSON.stringify(e)}catch(e){return"[Statsig] Failed to get string for error."}};return r}();e.default=r}(tt);var nt={};Object.defineProperty(nt,"__esModule",{value:!0});var it=function(){function e(e,t,n,i,r,o,a,s,u){void 0===r&&(r=null);void 0===o&&(o=[]);void 0===a&&(a=[]);void 0===s&&(s="");void 0===u&&(u=[]);this._logParameterFunction=r;this._name=e;this._value=JSON.parse(JSON.stringify(null!=t?t:{}));this._ruleID=null!=n?n:"";this._evaluationDetails=i;this._secondaryExposures=o;this._undelegatedSecondaryExposures=a;this._allocatedExperimentName=s;this._explicitParameters=u}e._create=function(t,n,i,r,o,a,s,u,l){void 0===o&&(o=null);void 0===a&&(a=[]);void 0===s&&(s=[]);void 0===u&&(u="");void 0===l&&(l=[]);return new e(t,n,i,r,o,a,s,u,l)};e.prototype.get=function(e,t,n){var i=this,r=this._value[e];if(null==r)return t;var o=function(){i._logLayerParameterExposure(e);return r};return n?n(r)?o():t:null==t||typeof r==typeof t&&Array.isArray(t)===Array.isArray(r)?o():t};e.prototype.getValue=function(e,t){null==t&&(t=null);var n=this._value[e];null!=n&&this._logLayerParameterExposure(e);return null!=n?n:t};e.prototype._logLayerParameterExposure=function(e){var t;null===(t=this._logParameterFunction)||void 0===t||t.call(this,this,e)};return e}();nt.default=it;var rt={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot.LOCAL_STORAGE_KEYS=ot.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY=ot.STATSIG_STABLE_ID_KEY=ot.INTERNAL_STORE_KEY=void 0;ot.INTERNAL_STORE_KEY="STATSIG_STORE";ot.STATSIG_STABLE_ID_KEY="STATSIG_STABLE_ID";ot.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY="STATSIG_LOGS";ot.LOCAL_STORAGE_KEYS={INTERNAL_STORE_KEY:!0,STATSIG_STABLE_ID_KEY:!0,STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY:!0};var at={};Object.defineProperty(at,"__esModule",{value:!0});at.getUserCacheKey=at.getSortedObject=at.djb2HashForObject=at.getHashValue=at.SimpleHash=void 0;function st(e){for(var t=0,n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t&=t}return String(t>>>0)}at.SimpleHash=st;at.getHashValue=function(e,t){return"none"===t?e:st(e)};at.djb2HashForObject=function(e){return st(JSON.stringify(ut(e)))};function ut(e){if(null==e)return null;var t=Object.keys(e).sort(),n={};t.forEach((function(t){var i=e[t];i instanceof Object&&(i=ut(i));n[t]=i}));return n}at.getSortedObject=ut;at.getUserCacheKey=function(e){var t,n="userID:".concat(String(null!==(t=null==e?void 0:e.userID)&&void 0!==t?t:"")),i=null==e?void 0:e.customIDs;if(null!=i)for(var r=0,o=Object.entries(i);r<o.length;r++){var a=o[r],s=a[0],u=a[1];n+=";".concat(s,":").concat(u)}return st(n)};var lt={};Object.defineProperty(lt,"__esModule",{value:!0});var ct=function(){function e(){}e.getItem=function(e){var t;try{if(this.isStorageAccessible())return window.localStorage.getItem(e)}catch(e){}return null!==(t=this.fallbackSessionCache[e])&&void 0!==t?t:null};e.setItem=function(e,t){try{if(this.isStorageAccessible()){window.localStorage.setItem(e,t);return}}catch(e){}this.fallbackSessionCache[e]=t};e.removeItem=function(e){try{if(this.isStorageAccessible()){window.localStorage.removeItem(e);return}}catch(e){}delete this.fallbackSessionCache[e]};e.isStorageAccessible=function(e){void 0===e&&(e=!1);null==this.canAccessStorageAccessible&&(this.canAccessStorageAccessible="undefined"!=typeof Storage&&"undefined"!=typeof window&&null!=window&&null!=window.localStorage);var t=this.canAccessStorageAccessible;return(e||!this.disabled)&&t};e.disabled=!1;e.fallbackSessionCache={};e.canAccessStorageAccessible=null;return e}();lt.default=ct;var dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.version=void 0;dt.version="1.6.0";var ft=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rt,"__esModule",{value:!0});var pt=ot,ht=at,gt=ft(lt),vt=dt,yt=function(){function e(e,t,n){var i;this._sdkType="js-lite";this._sdkKey=e;this._user=t;this._sdkVersion=vt.version;var r=n;r=null!==(i=null!=r?r:gt.default.getItem(pt.STATSIG_STABLE_ID_KEY))&&void 0!==i?i:this._getUUID();this._statsigMetadata={stableID:r,sdkType:this._sdkType,sdkVersion:this._sdkVersion}}e.prototype.saveStableID=function(){null!=this._statsigMetadata.stableID&&gt.default.setItem(pt.STATSIG_STABLE_ID_KEY,this._statsigMetadata.stableID)};e.prototype.getUserCacheKey=function(){return(0,ht.getUserCacheKey)(this._user)};e.prototype._getUUID=function(){for(var e="",t=0;t<32;t++){8!==t&&12!==t&&16!==t&&20!==t||(e+="-");var n=16*Math.random()|0;e+=12===t?"4":16===t?(3&n|8).toString(16):n.toString(16)}return e};return e}();rt.default=yt;var mt={},_t={},bt=ae&&ae.__assign||function(){bt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};return bt.apply(this,arguments)};Object.defineProperty(_t,"__esModule",{value:!0});_t.default=function(e,t,n,i,r,o){void 0===i&&(i=null);void 0===r&&(r=null);var a=t;(null==a?void 0:a.privateAttributes)&&delete(a=bt({},t)).privateAttributes;return{time:Date.now(),eventName:e,statsigMetadata:n,user:a,value:i,metadata:r,secondaryExposures:o}};var wt={};!function(e){var t,n=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},i=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0});e.StatsigEndpoint=void 0;!function(e){e.Initialize="initialize";e.Rgstr="rgstr";e.LogEventBeacon="log_event_beacon"}(t=e.StatsigEndpoint||(e.StatsigEndpoint={}));var r=function(){function e(e,t,n){this.retryCodes={408:!0,500:!0,502:!0,503:!0,504:!0,522:!0,524:!0,599:!0};this.canUseKeepalive=!1;this._options=e;this._identity=t;this._errorBoundary=n;this.leakyBucket={};this._init()}e.prototype.fetchValues=function(e,n,i,r){var o={user:e,statsigMetadata:this._identity._statsigMetadata,sinceTime:null!=n?n:void 0,hash:"djb2",previousDerivedFields:r};return this._postWithTimeout(t.Initialize,o,i,3)};e.prototype.sendLogBeacon=function(e){if(this._options.localMode)return!0;var n=new URL(this._options.eventLoggingApi+t.LogEventBeacon);n.searchParams.append("k",this._identity._sdkKey);e.clientTime=Date.now()+"";var i=null;try{i=JSON.stringify(e)}catch(e){return!1}return navigator.sendBeacon(n.toString(),i)};e.prototype.postToEndpoint=function(e,r,o,a,s,u){void 0===o&&(o=0);void 0===a&&(a=1e3);void 0===s&&(s=0);void 0===u&&(u=!1);return n(this,void 0,void 0,(function(){var l,c,d,f,p,h,g=this;return i(this,(function(v){if(this._options.localMode)return[2,Promise.reject("no network requests in localMode")];if("function"!=typeof fetch)return[2,Promise.reject("fetch is not defined")];if("undefined"==typeof window&&!this._options.ignoreWindowUndefined)return[2,Promise.reject("window is not defined")];l=[t.Initialize].includes(e)?this._options.api:s>0?this._options.eventLoggingApiForRetries:this._options.eventLoggingApi;c=l+e;if(null!=(d=this.leakyBucket[c])&&d>=30)return[2,Promise.reject(new Error("Request failed because you are making the same request too frequently."))];this.leakyBucket[c]=null==d?1:d+1;f=JSON.stringify(r);p=this._identity._statsigMetadata;h={method:"POST",body:f,headers:{"Content-type":"application/json; charset=UTF-8","STATSIG-API-KEY":this._identity._sdkKey,"STATSIG-CLIENT-TIME":Date.now()+"","STATSIG-SDK-TYPE":p.sdkType,"STATSIG-SDK-VERSION":p.sdkVersion}};this.canUseKeepalive&&u&&(h.keepalive=!0);return[2,fetch(c,h).then((function(e){return n(g,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){switch(i.label){case 0:if(!e.ok)return[3,4];t=e;if(204!==e.status)return[3,1];t.data={has_updates:!1,is_no_content:!0};return[3,3];case 1:return[4,e.text()];case 2:n=i.sent();t.data=JSON.parse(n);i.label=3;case 3:return[2,Promise.resolve(t)];case 4:this.retryCodes[e.status]||(o=0);return[4,e.text()];case 5:r=i.sent();return[2,Promise.reject(new Error("".concat(e.status,": ").concat(r)))]}}))}))})).catch((function(t){return o>0?new Promise((function(t,n){setTimeout((function(){g.leakyBucket[c]=Math.max(g.leakyBucket[c]-1,0);g.postToEndpoint(e,r,o-1,2*a,s+1,u).then(t).catch(n)}),a)})):Promise.reject(t)})).finally((function(){g.leakyBucket[c]=Math.max(g.leakyBucket[c]-1,0)}))]}))}))};e.prototype.supportsKeepalive=function(){return this.canUseKeepalive};e.prototype._init=function(){if(!this._options.disableNetworkKeepalive)try{this.canUseKeepalive="keepalive"in new Request("")}catch(e){}};e.prototype._postWithTimeout=function(e,t,r,o,a){var s=this;void 0===r&&(r=0);void 0===o&&(o=0);void 0===a&&(a=1e3);var u=!1,l=null,c=null,d=[];0!=r&&(l=new Promise((function(e,t){setTimeout((function(){u=!0;t(new Error("The initialization timeout of ".concat(r,"ms has been hit before the network request has completed.")))}),r)})));var f,p=this.postToEndpoint(e,t,o,a).then((function(r){if(!r.ok)return Promise.reject(new Error("Request to ".concat(e," failed with status ").concat(r.status)));if("object"!=typeof r.data){var l=new Error("Request to ".concat(e," received invalid response type. Expected 'object' but got '").concat(typeof r.data,"'"));s._errorBoundary._logError("postWithTimeoutInvalidRes",l,(function(){return n(s,void 0,void 0,(function(){return i(this,(function(n){return[2,this._getErrorData(e,t,o,a,r)]}))}))}));return Promise.reject(l)}var f=r.data;return s._errorBoundary._capture("postWithTimeout",(function(){return n(s,void 0,void 0,(function(){return i(this,(function(e){c=f;if(u){d.forEach((function(e){return e(f)}));d=[]}return[2,Promise.resolve(f)]}))}))}),(function(){return Promise.resolve({})}),(function(){return n(s,void 0,void 0,(function(){return i(this,(function(n){return[2,this._getErrorData(e,t,o,a,r)]}))}))}))})).catch((function(e){return Promise.reject(e)})),h=l?Promise.race([p,l]):p;h.eventually=(f=h,function(e){u&&c?e(c):d.push(e);return f});return h};e.prototype._getErrorData=function(e,t,r,o,a){var s;return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){try{n={};(null!==(s=a.headers)&&void 0!==s?s:[]).forEach((function(e,t){n[t]=e}));return[2,{responseInfo:{headers:n,status:a.status,statusText:a.statusText,type:a.type,url:a.url,redirected:a.redirected,bodySnippet:a.data?JSON.stringify(a.data).slice(0,500):null},requestInfo:{endpointName:e,bodySnippet:JSON.stringify(t).slice(0,500),retries:r,backoff:o}}]}catch(e){return[2,{statusText:"statsig::failed to extract extra data"}]}return[2]}))}))};return e}();e.default=r}(wt);var xt=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},Et=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},kt=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mt,"__esModule",{value:!0});var Ot=kt(_t),St=wt,At=ot,Ct=kt(lt),It="statsig::log_event_failed",Lt=1024e3,Tt=function(){function e(e,t,n,i){var r=this;this._failedLogEventCount=0;this.logConfigDefaultValueFallback=function(e,t,n){var i=(0,Ot.default)("statsig::default_value_type_mismatch",e,r._identity._statsigMetadata,t,n);r.log(i);r._loggedErrors.add(t)};this._options=e;this._identity=t;this._network=n;this._errorBoundary=i;this._queue=[];this._flushInterval=null;this._loggedErrors=new Set;this._failedLogEvents=[];this._exposureDedupeKeys={};this._failedLogEventCount=0;this._init()}e.prototype.log=function(e){if(!this._options.disableAllLogging){try{if(!this._options.disableCurrentPageLogging&&"undefined"!=typeof window&&null!=window&&"object"==typeof window.location&&"string"==typeof window.location.href){var t=window.location.href.split(/[?#]/);(null==t?void 0:t.length)>0&&(e.statsigMetadata.currentPage=t[0])}}catch(e){}this._queue.push(e);this._queue.length>=this._options.loggingBufferMaxSize&&this.flush()}};e.prototype.resetDedupeKeys=function(){this._exposureDedupeKeys={}};e.prototype.logGateExposure=function(e,t,n,i,r,o,a,s){var u=t+String(n)+i+o.reason;if(this._shouldLogExposure(u)){var l={gate:t,gateValue:String(n),ruleID:i,reason:o.reason,time:o.time};a&&(l.isManualExposure="true");null!=s&&(l.bootstrapMetadata=s);var c=(0,Ot.default)("statsig::gate_exposure",e,this._identity._statsigMetadata,null,l,r);this.log(c)}};e.prototype.logConfigExposure=function(e,t,n,i,r,o,a){var s=t+n+r.reason;if(this._shouldLogExposure(s)){var u={config:t,ruleID:n,reason:r.reason,time:r.time};o&&(u.isManualExposure="true");null!=a&&(u.bootstrapMetadata=a);var l=(0,Ot.default)("statsig::config_exposure",e,this._identity._statsigMetadata,null,u,i);this.log(l)}};e.prototype.logLayerExposure=function(e,t,n,i,r,o,a,s,u,l){var c=[t,n,r,o,String(a),s.reason].join("|");if(this._shouldLogExposure(c)){var d={config:t,ruleID:n,allocatedExperiment:r,parameterName:o,isExplicitParameter:String(a),reason:s.reason,time:s.time};u&&(d.isManualExposure="true");null!=l&&(d.bootstrapMetadata=l);var f=(0,Ot.default)("statsig::layer_exposure",e,this._identity._statsigMetadata,null,d,i);this.log(f)}};e.prototype.shutdown=function(){if(this._flushInterval){clearInterval(this._flushInterval);this._flushInterval=null}this.flush(!0)};e.prototype.flush=function(e){var t=this;void 0===e&&(e=!1);if(0!==this._queue.length){var n=this._identity._statsigMetadata,i=this._queue;this._queue=[];if(e&&!this._network.supportsKeepalive()&&"undefined"!=typeof navigator&&null!=navigator&&navigator.sendBeacon){if(!this._network.sendLogBeacon({events:i,statsigMetadata:n})){this._queue=i.concat(this._queue);if(this._queue.length>0){this._addFailedRequest({events:this._queue,statsigMetadata:n,time:Date.now()});this._queue=[]}this._saveFailedRequests()}}else{var r=this;this._network.postToEndpoint(St.StatsigEndpoint.Rgstr,{events:i,statsigMetadata:n},3,1e3,0,e).then((function(e){if(!e.ok)throw e})).catch((function(e){"function"==typeof e.text?e.text().then((function(n){t._errorBoundary._logError(It,e,(function(){return xt(t,void 0,void 0,(function(){return Et(this,(function(e){return[2,{eventCount:i.length,error:n}]}))}))}))})):t._errorBoundary._logError(It,e,(function(){return xt(t,void 0,void 0,(function(){return Et(this,(function(t){return[2,{eventCount:i.length,error:e.message}]}))}))}));r._newFailedRequest(It,i)})).finally((function(){return xt(t,void 0,void 0,(function(){return Et(this,(function(t){switch(t.label){case 0:if(!e)return[3,2];if(this._queue.length>0){this._addFailedRequest({events:this._queue,statsigMetadata:n,time:Date.now()});this._queue=[]}return[4,r._saveFailedRequests()];case 1:t.sent();t.label=2;case 2:return[2]}}))}))}))}}};e.prototype.sendSavedRequests=function(){return xt(this,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,u=this;return Et(this,(function(l){t=!1;if(null==(e=Ct.default.getItem(At.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY))){this._clearLocalStorageRequests();return[2]}e.length>Lt&&(t=!0);n=[];try{n=JSON.parse(e);i=function(e){null!=e&&e.events&&Array.isArray(e.events)&&r._network.postToEndpoint(St.StatsigEndpoint.Rgstr,e).then((function(e){if(!e.ok)throw Error(e.status+"")})).catch((function(n){t||u._addFailedRequest(e)}))};r=this;for(o=0,a=n;o<a.length;o++){s=a[o];i(s)}}catch(e){}finally{this._clearLocalStorageRequests()}return[2]}))}))};e.prototype._init=function(){var e=this;if("undefined"!=typeof window&&"function"==typeof window.addEventListener){window.addEventListener("blur",(function(){return e.flush(!0)}));window.addEventListener("beforeunload",(function(){return e.flush(!0)}));window.addEventListener("load",(function(){setTimeout((function(){return e.flush()}),100);setTimeout((function(){return e.flush()}),1e3)}))}"undefined"!=typeof document&&"function"==typeof document.addEventListener&&document.addEventListener("visibilitychange",(function(){e.flush("visible"!==document.visibilityState)}));if((this._options.ignoreWindowUndefined||"undefined"!=typeof window&&null!=window)&&!this._options.localMode){var t=this;this._flushInterval=setInterval((function(){t.flush()}),this._options.loggingIntervalMillis);setTimeout((function(){return e.flush()}),100);setTimeout((function(){return e.flush()}),1e3)}};e.prototype._shouldLogExposure=function(e){var t=this._exposureDedupeKeys[e],n=Date.now();if(null==t){this._exposureDedupeKeys[e]=n;return!0}if(t>=n-6e5)return!1;this._exposureDedupeKeys[e]=n;return!0};e.prototype._saveFailedRequests=function(){return xt(this,void 0,void 0,(function(){var e;return Et(this,(function(t){if(this._failedLogEvents.length>0){if((e=JSON.stringify(this._failedLogEvents)).length>Lt){this._clearLocalStorageRequests();return[2]}Ct.default.setItem(At.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY,e)}return[2]}))}))};e.prototype._addFailedRequest=function(e){if(!(e.time<Date.now()-432e6||this._failedLogEvents.length>100)){var t=e.events.length;if(!(this._failedLogEventCount+t>1e3)){this._failedLogEvents.push(e);this._failedLogEventCount+=t}}};e.prototype._clearLocalStorageRequests=function(){Ct.default.removeItem(At.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY)};e.prototype._newFailedRequest=function(e,t){if(!this._loggedErrors.has(e)){this._loggedErrors.add(e);this._failedLogEvents.push({events:t,statsigMetadata:this._identity._statsigMetadata,time:Date.now()});this._saveFailedRequests().then((function(){}))}};return e}();mt.default=Tt;var Pt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});e.INIT_TIMEOUT_DEFAULT_MS=void 0;e.INIT_TIMEOUT_DEFAULT_MS=3e3;var t=function(){function t(t){var n,i,r,o,a,s,u,l,c,d,f,p,h,g,v,y;null==t&&(t={});var m=null!==(n=t.api)&&void 0!==n?n:"https://featuregates.org/v1/";this.api=m.endsWith("/")?m:m+"/";this.disableCurrentPageLogging=null!==(i=t.disableCurrentPageLogging)&&void 0!==i&&i;this.environment=null!==(r=t.environment)&&void 0!==r?r:null;this.loggingIntervalMillis=this.normalizeNumberInput(t.loggingIntervalMillis,{default:1e4,min:1e3,max:6e4});this.loggingBufferMaxSize=this.normalizeNumberInput(t.loggingBufferMaxSize,{default:100,min:2,max:500});this.disableNetworkKeepalive=null!==(o=t.disableNetworkKeepalive)&&void 0!==o&&o;this.overrideStableID=null!==(a=t.overrideStableID)&&void 0!==a?a:null;this.localMode=null!==(s=t.localMode)&&void 0!==s&&s;this.initTimeoutMs=t.initTimeoutMs&&t.initTimeoutMs>=0?t.initTimeoutMs:e.INIT_TIMEOUT_DEFAULT_MS;this.disableErrorLogging=null!==(u=t.disableErrorLogging)&&void 0!==u&&u;this.disableAutoMetricsLogging=null!==(l=t.disableAutoMetricsLogging)&&void 0!==l&&l;this.initializeValues=null!==(c=t.initializeValues)&&void 0!==c?c:null;var _=null!==(f=null!==(d=t.eventLoggingApi)&&void 0!==d?d:t.api)&&void 0!==f?f:"https://events.statsigapi.net/v1/";this.eventLoggingApi=_.endsWith("/")?_:_+"/";var b=null!==(p=t.eventLoggingApiForRetries)&&void 0!==p?p:_;this.eventLoggingApiForRetries=b.endsWith("/")?b:b+"/";this.disableLocalStorage=null!==(h=t.disableLocalStorage)&&void 0!==h&&h;this.ignoreWindowUndefined=null!==(g=null==t?void 0:t.ignoreWindowUndefined)&&void 0!==g&&g;this.updateUserCompletionCallback=null!==(v=null==t?void 0:t.updateUserCompletionCallback)&&void 0!==v?v:null;this.disableAllLogging=null!==(y=null==t?void 0:t.disableAllLogging)&&void 0!==y&&y}t.prototype.normalizeNumberInput=function(e,t){return null==e?t.default:Math.max(Math.min(e,t.max),t.min)};return t}();e.default=t}(Pt);var Dt={},Mt={},jt=ae&&ae.__assign||function(){jt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};return jt.apply(this,arguments)};Object.defineProperty(Mt,"__esModule",{value:!0});var Ft=function(){function e(){}e.isValid=function(t,n){try{var i=n.evaluated_keys;if(!i){var r=n.user;if(r){(i={}).userID=r.userID;r.customIDs&&(i.customIDs=r.customIDs)}}if(!i||"object"!=typeof i)return!0;var o=this.copyObject(i),a=null==t?null:this.copyObject(t);return e.validate(o,a)&&e.validate(a,o)}catch(e){}return!0};e.validate=function(e,t){if(null==e)return null==t;if(null==t)return!1;for(var n=0,i=Object.entries(e);n<i.length;n++){var r=i[n],o=r[0],a=r[1];if("stableID"!==o){if(typeof a!=typeof t[o])return!1;if("string"!=typeof a)return"object"==typeof a&&this.validate(a,t[o]);if(a!==t[o])return!1}}return!0};e.copyObject=function(e){if(null==e)return null;var t={};(null==e?void 0:e.userID)&&(t.userID=null==e?void 0:e.userID);if(null==e?void 0:e.customIDs){var n=jt({},e.customIDs);delete n.stableID;0!==Object.keys(n).length&&(t.customIDs=n)}return t};return e}();Mt.default=Ft;!function(e){var t=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.EvaluationReason=void 0;var r,o=i(Ze),a=i(nt),s=i(Mt),u=ot,l=at,c=i(lt);!function(e){e.Network="Network";e.Bootstrap="Bootstrap";e.InvalidBootstrap="InvalidBootstrap";e.Cache="Cache";e.Unrecognized="Unrecognized";e.Uninitialized="Uninitialized";e.Error="Error";e.NetworkNotModified="NetworkNotModified";e.LocalOverride="LocalOverride"}(r=e.EvaluationReason||(e.EvaluationReason={}));var d=function(){function e(e,t,n){this._identity=e;this._onDefaultValueFallback=t;this._userCacheKey=this._identity.getUserCacheKey();this._values={};this._userValues=this._getDefaultUserCacheValues();this._loaded=!1;this._reason=r.Uninitialized;n?this.bootstrap(n):this._loadFromLocalStorage()}e.prototype.updateUser=function(){this._userCacheKey=this._identity.getUserCacheKey();return this._setUserValueFromCache()};e.prototype.bootstrap=function(e){var t,n,i,o,a,u,l,c=this._identity.getUserCacheKey(),d=this._identity._user,f=s.default.isValid(d,e)?r.Bootstrap:r.InvalidBootstrap;this._loaded=!0;try{this._userValues.feature_gates=null!==(t=e.feature_gates)&&void 0!==t?t:{};this._userValues.dynamic_configs=null!==(n=e.dynamic_configs)&&void 0!==n?n:{};this._userValues.layer_configs=null!==(i=e.layer_configs)&&void 0!==i?i:{};this._userValues.evaluation_time=Date.now();this._userValues.time=null!==(o=e.time)&&void 0!==o?o:Date.now();this._userValues.exposures=null!==(a=e.exposures)&&void 0!==a?a:[];this._userValues.hash_used=null!==(u=e.hash_used)&&void 0!==u?u:"djb2";this._values[c]=this._userValues;this._reason=f;var p=null!==(l=e.sdkInfo)&&void 0!==l?l:e.sdk_info;this._userValues.bootstrapMetadata={};null!=p&&(this._userValues.bootstrapMetadata.generatorSDKInfo=p);null!=e.user&&(this._userValues.bootstrapMetadata.user=e.user);null!=e.time&&(this._userValues.bootstrapMetadata.lcut=e.time)}catch(e){return}};e.prototype.getBootstrapMetadata=function(){var e;return null!==(e=this._userValues.bootstrapMetadata)&&void 0!==e?e:null};e.prototype.isLoaded=function(){return this._loaded};e.prototype.getLastUpdateTime=function(e){var t=(0,l.djb2HashForObject)(e);return this._userValues.user_hash==t?this._userValues.time:null};e.prototype.getPreviousDerivedFields=function(e){var t=(0,l.djb2HashForObject)(e);if(this._userValues.user_hash==t)return this._userValues.derived_fields};e.prototype.setEvaluationReason=function(e){this._reason=e};e.prototype.save=function(e,i,o){void 0===o&&(o=!0);return t(this,void 0,void 0,(function(){var t,a,s,u;return n(this,(function(n){switch(n.label){case 0:t=(0,l.getUserCacheKey)(e);a=i;this._mergeInitializeResponseIntoUserMap(a,this._values,t,e,(function(e){return e}));if(o&&(s=this._values[t])&&t&&t==this._userCacheKey){this._userValues=s;this._reason=r.Network}u=this;return[4,this._writeValuesToStorage(this._values)];case 1:u._values=n.sent();return[2]}}))}))};e.prototype.checkGate=function(e){var t,n,i=(0,l.getHashValue)(e,this._userValues.hash_used),r={name:e,value:!1,rule_id:"",secondary_exposures:[]},o=null===(t=this._userValues)||void 0===t?void 0:t.feature_gates[i];o&&(r=o);r.secondary_exposures=this.mapExposures(null!==(n=r.secondary_exposures)&&void 0!==n?n:[]);return{evaluationDetails:this._getEvaluationDetails(null!=o),gate:r}};e.prototype.mapExposures=function(e){var t=this;return e.map((function(e){var n;return"string"==typeof e?(null!==(n=t._userValues.exposures)&&void 0!==n?n:{})[e]:e}))};e.prototype.getConfig=function(e){var t,n,i,r,a=(0,l.getHashValue)(e,this._userValues.hash_used);if(null!=(null===(t=this._userValues)||void 0===t?void 0:t.dynamic_configs[a])){var s=null===(n=this._userValues)||void 0===n?void 0:n.dynamic_configs[a];r=this._getEvaluationDetails(!0);i=this._createDynamicConfig(e,s,r)}else{r=this._getEvaluationDetails(!1);i=new o.default(e,{},"",r)}return i};e.prototype.getLayer=function(e,t){var n,i,r,o,s,u=this._getLatestValue(t,"layer_configs"),l=this._getEvaluationDetails(null!=u);return a.default._create(t,null!==(n=null==u?void 0:u.value)&&void 0!==n?n:{},null!==(i=null==u?void 0:u.rule_id)&&void 0!==i?i:"",l,e,this.mapExposures(null!==(r=null==u?void 0:u.secondary_exposures)&&void 0!==r?r:[]),this.mapExposures(null!==(o=null==u?void 0:u.undelegated_secondary_exposures)&&void 0!==o?o:[]),null!==(s=null==u?void 0:u.allocated_experiment_name)&&void 0!==s?s:"",null==u?void 0:u.explicit_parameters)};e.prototype.getGlobalEvaluationDetails=function(){var e,t;return{reason:null!==(e=this._reason)&&void 0!==e?e:r.Uninitialized,time:null!==(t=this._userValues.evaluation_time)&&void 0!==t?t:0}};e.prototype._loadFromLocalStorage=function(){this._parseCachedValues(c.default.getItem(u.INTERNAL_STORE_KEY));this._loaded=!0};e.prototype._parseCachedValues=function(e){try{this._values=e?JSON.parse(e):this._values;this._setUserValueFromCache()}catch(e){this._removeFromStorage(u.INTERNAL_STORE_KEY)}};e.prototype._setUserValueFromCache=function(){var e,t=this._values[this._userCacheKey];if(null==t){this._resetUserValues();this._reason=r.Uninitialized;return null}this._userValues=t;this._reason=r.Cache;return null!==(e=t.evaluation_time)&&void 0!==e?e:0};e.prototype._removeFromStorage=function(e){c.default.removeItem(e)};e.prototype._mergeInitializeResponseIntoUserMap=function(e,t,n,i,r){if(n){var o=this._convertAPIDataToCacheValues(e,n);if(e.has_updates&&e.time){var a=(0,l.djb2HashForObject)(i);o.user_hash=a}t[n]=r(o,n)}};e.prototype._getDefaultUserCacheValues=function(){return{feature_gates:{},layer_configs:{},dynamic_configs:{},time:0,evaluation_time:0,has_updates:!1}};e.prototype._writeValuesToStorage=function(e){return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){t=Object.entries(e).sort((function(e,t){var n,i,r=e[1],o=t[1];return null==r?1:null==o?-1:(null!==(n=null==o?void 0:o.evaluation_time)&&void 0!==n?n:null==o?void 0:o.time)-(null!==(i=null==r?void 0:r.evaluation_time)&&void 0!==i?i:null==r?void 0:r.time)})).slice(0,10);e=Object.fromEntries(t);c.default.setItem(u.INTERNAL_STORE_KEY,JSON.stringify(e));return[2,e]}))}))};e.prototype._getLatestValue=function(e,t){var n,i,r,o,a,s=(0,l.getHashValue)(e,this._userValues.hash_used);return null!==(r=null===(i=null===(n=this._userValues)||void 0===n?void 0:n[t])||void 0===i?void 0:i[s])&&void 0!==r?r:null===(a=null===(o=this._userValues)||void 0===o?void 0:o[t])||void 0===a?void 0:a[e]};e.prototype._createDynamicConfig=function(e,t,n){var i,r,a,s;return new o.default(e,null!==(i=null==t?void 0:t.value)&&void 0!==i?i:{},null!==(r=null==t?void 0:t.rule_id)&&void 0!==r?r:"",n,this.mapExposures(null!==(a=null==t?void 0:t.secondary_exposures)&&void 0!==a?a:[]),null!==(s=null==t?void 0:t.allocated_experiment_name)&&void 0!==s?s:"",this._makeOnConfigDefaultValueFallback(this._identity._user))};e.prototype._getEvaluationDetails=function(e,t){var n;return e?{reason:this._reason,time:null!==(n=this._userValues.evaluation_time)&&void 0!==n?n:Date.now()}:{reason:null!=t?t:this._reason==r.Uninitialized?r.Uninitialized:r.Unrecognized,time:Date.now()}};e.prototype._resetUserValues=function(){this._userValues=this._getDefaultUserCacheValues()};e.prototype._convertAPIDataToCacheValues=function(e,t){return{feature_gates:e.feature_gates,layer_configs:e.layer_configs,dynamic_configs:e.dynamic_configs,time:null==e.time||isNaN(e.time)?0:e.time,evaluation_time:Date.now(),derived_fields:e.derived_fields,hash_used:e.hash_used}};e.prototype._makeOnConfigDefaultValueFallback=function(e){var t=this;return function(n,i,r,o){t.isLoaded()&&t._onDefaultValueFallback(e,"Parameter ".concat(i," is a value of type ").concat(o,".\n          Returning requested defaultValue type ").concat(r),{name:n._name,ruleID:n._ruleID,parameter:i,defaultValueType:r,valueType:o})}};return e}();e.default=d}(Dt);var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.verifySDKKeyUsed=void 0;var Nt=Xe,Rt=at;Vt.verifySDKKeyUsed=function(e,t,n){var i=null==e?void 0:e.hashed_sdk_key_used;if(null!=i&&i!==(0,Rt.SimpleHash)(null!=t?t:"")){n._logError("fetchAndSaveValues",new Nt.StatsigSDKKeyMismatchError("The SDK key provided does not match the one used to generate values."));return!1}return!0};var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.difference=Gt.now=void 0;function Ut(){return"undefined"!=typeof performance&&performance?0|performance.now():Date.now()}Gt.now=Ut;Gt.difference=function(e){return Ut()-e};var Bt={};!function(e){var t=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.saveOverridesToLocalStorage=e.loadOverridesFromLocalStorage=e.makeEmptyOverrides=e.STORAGE_KEY=void 0;var n=t(lt);e.STORAGE_KEY="STATSIG_JS_LITE_LOCAL_OVERRIDES";function i(){return{gates:{},configs:{},layers:{}}}e.makeEmptyOverrides=i;e.loadOverridesFromLocalStorage=function(){var t=n.default.getItem(e.STORAGE_KEY);if(t)try{return JSON.parse(t)}catch(e){}return{gates:{},configs:{},layers:{}}};e.saveOverridesToLocalStorage=function(t){n.default.setItem(e.STORAGE_KEY,JSON.stringify(t))}}(Bt);var zt=ae&&ae.__assign||function(){zt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};return zt.apply(this,arguments)},Kt=ae&&ae.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}});Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n);e[i]=t[n]}),$t=ae&&ae.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jt=ae&&ae.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&Kt(t,e,n);$t(t,e);return t},Wt=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},qt=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},Ht=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qe,"__esModule",{value:!0});var Yt=Ht(Ze),Xt=Ht(tt),Qt=Xe,Zt=Ht(nt),en=Ht(rt),tn=Ht(mt),nn=Ht(wt),rn=Ht(Pt),on=Jt(Dt),an=Vt,sn=Ht(lt),un=Gt,ln=Ht(_t),cn=Bt,dn=function(){function e(e,t,n){var i=this;this._initCalled=!1;this._pendingInitPromise=null;this._sdkKey=null;this._logLayerParameterExposureForLayer=function(e,t,n){void 0===n&&(n=!1);var r="",o=e._undelegatedSecondaryExposures,a=e._explicitParameters.includes(t);if(a){r=e._allocatedExperimentName;o=e._secondaryExposures}i._logger.logLayerExposure(i._identity._user,e._name,e._ruleID,o,r,t,a,e._evaluationDetails,n,i._store.getBootstrapMetadata())};if(!0!==(null==n?void 0:n.localMode)&&("string"!=typeof e||!e.startsWith("client-")))throw new Qt.StatsigInvalidArgumentError("Invalid key provided.  You must use a Client SDK Key from the Statsig console to initialize the sdk");this._sdkKey=e;this._startTime=(0,un.now)();this._options=new rn.default(n);this._errorBoundary=new Xt.default(e,this._options);this._ready=!1;sn.default.disabled=this._options.disableLocalStorage;this._overrides=(0,cn.loadOverridesFromLocalStorage)();this._identity=new en.default(e,this._normalizeUser(null!=t?t:null),this._options.overrideStableID);this._network=new nn.default(this._options,this._identity,this._errorBoundary);this._logger=new tn.default(this._options,this._identity,this._network,this._errorBoundary);this._store=new on.default(this._identity,this._logger.logConfigDefaultValueFallback,this._options.initializeValues);this._errorBoundary._setStatsigMetadata(this._identity._statsigMetadata);if(null!=this._options.initializeValues){this._ready=!0;this._initCalled=!0;setTimeout((function(){return i._delayedSetup()}),20)}}e.prototype.setInitializeValues=function(e){var t=this;this._errorBoundary._capture("setInitializeValues",(function(){t._store.bootstrap(e);if(!t._ready){t._ready=!0;t._initCalled=!0}t._logger.sendSavedRequests()}),(function(){t._ready=!0;t._initCalled=!0}))};e.prototype.initializeAsync=function(){return Wt(this,void 0,void 0,(function(){var e=this;return qt(this,(function(t){return[2,this._errorBoundary._capture("initializeAsync",(function(){return Wt(e,void 0,void 0,(function(){var e,t=this;return qt(this,(function(n){if(null!=this._pendingInitPromise)return[2,this._pendingInitPromise];if(this._ready)return[2,Promise.resolve()];this._initCalled=!0;if(this._options.localMode)return[2,Promise.resolve()];e=this._identity._user;this._pendingInitPromise=this._fetchAndSaveValues(e,this._options.initTimeoutMs).then((function(){})).catch((function(e){t._errorBoundary._logError("initializeAsync:fetchAndSaveValues",e);return{success:!1,message:e.message}})).then((function(){})).finally((function(){return Wt(t,void 0,void 0,(function(){return qt(this,(function(e){this._pendingInitPromise=null;this._ready=!0;this._delayedSetup();return[2]}))}))}));return[2,this._pendingInitPromise]}))}))}),(function(){e._ready=!0;e._initCalled=!0;return Promise.resolve()}))]}))}))};e.prototype.getEvaluationDetails=function(){var e=this;return this._errorBoundary._capture("getEvaluationDetails",(function(){return e._store.getGlobalEvaluationDetails()}),(function(){return{time:Date.now(),reason:on.EvaluationReason.Error}}))};e.prototype.checkGate=function(e){return this._checkGateImpl(e,"checkGate")};e.prototype.checkGateWithExposureLoggingDisabled=function(e){return this._checkGateImpl(e,"checkGateWithExposureLoggingDisabled")};e.prototype.logGateExposure=function(e){var t=this;this._errorBoundary._swallow("logGateExposure",(function(){t._logGateExposureImpl(e)}))};e.prototype.getConfig=function(e){return this._getConfigImpl(e,"getConfig")};e.prototype.getConfigWithExposureLoggingDisabled=function(e){return this._getConfigImpl(e,"getConfigWithExposureLoggingDisabled")};e.prototype.logConfigExposure=function(e){var t=this;this._errorBoundary._swallow("logConfigExposure",(function(){t._logConfigExposureImpl(e)}))};e.prototype.getExperiment=function(e){return this.getConfig(e)};e.prototype.getExperimentWithExposureLoggingDisabled=function(e){return this.getConfigWithExposureLoggingDisabled(e)};e.prototype.logExperimentExposure=function(e){this.logConfigExposure(e)};e.prototype.getLayer=function(e){return this._getLayerImpl(e,"getLayer")};e.prototype.getLayerWithExposureLoggingDisabled=function(e){return this._getLayerImpl(e,"getLayerWithExposureLoggingDisabled")};e.prototype.logLayerParameterExposure=function(e,t){var n=this;this._errorBoundary._swallow("logLayerParameterExposure",(function(){var i=n._getLayerFromStore(null,e);n._logLayerParameterExposureForLayer(i,t,!0)}))};e.prototype.logEvent=function(e,t,n){var i=this;void 0===t&&(t=null);void 0===n&&(n=null);this._errorBoundary._swallow("logEvent",(function(){if(!i._logger||!i._identity._sdkKey)throw new Qt.StatsigUninitializedError(Qt.StatsigErrorMessage.REQUIRE_INITIALIZE_FOR_LOG_EVENT);if("string"==typeof e&&0!==e.length){var r=(0,ln.default)(e,i._identity._user,i._identity._statsigMetadata,t,n);i._logger.log(r)}}))};e.prototype.updateUserWithValues=function(e,t){var n,i=this,r=Date.now();return this._errorBoundary._capture("updateUserWithValues",(function(){if(!i.initializeCalled())throw new Qt.StatsigUninitializedError(Qt.StatsigErrorMessage.REQUIRE_ASYNC_INITIALIZE);n=function(e,t){var n=i._options.updateUserCompletionCallback;null==n||n(Date.now()-r,e,t)};i._identity._user=i._normalizeUser(e);i._store.bootstrap(t);i._logger.resetDedupeKeys();n(!0,null);return!0}),(function(){null==n||n(!1,"Failed to update user. An unexpected error occured.");return!1}))};e.prototype.updateUser=function(e){return Wt(this,void 0,void 0,(function(){var t,n,i=this;return qt(this,(function(r){t=Date.now();return[2,this._errorBoundary._capture("updateUser",(function(){return Wt(i,void 0,void 0,(function(){var i,r=this;return qt(this,(function(o){switch(o.label){case 0:if(!this.initializeCalled())throw new Qt.StatsigUninitializedError(Qt.StatsigErrorMessage.REQUIRE_ASYNC_INITIALIZE);n=function(e,n){var i=r._options.updateUserCompletionCallback;null==i||i(Date.now()-t,e,n)};this._identity._user=this._normalizeUser(e);this._store.updateUser();this._logger.resetDedupeKeys();return null==this._pendingInitPromise?[3,2]:[4,this._pendingInitPromise];case 1:o.sent();o.label=2;case 2:if(this._options.localMode){n(!0,null);return[2,Promise.resolve(!0)]}i=this._identity._user;this._pendingInitPromise=this._fetchAndSaveValues(i).finally((function(){r._pendingInitPromise=null}));return[2,this._pendingInitPromise.then((function(){n(!0,null);return Promise.resolve(!0)})).catch((function(e){n(!1,"Failed to update user: ".concat(e));return Promise.resolve(!1)}))]}}))}))}),(function(){n(!1,"Failed to update user. An unexpected error occured.");return Promise.resolve(!1)}))]}))}))};e.prototype.shutdown=function(){var e=this;this._errorBoundary._swallow("shutdown",(function(){e._logger.shutdown()}))};e.prototype.getStableID=function(){var e=this;return this._errorBoundary._capture("getStableID",(function(){return e._identity._statsigMetadata.stableID}),(function(){return""}))};e.prototype.initializeCalled=function(){return this._initCalled};e.prototype.overrideGate=function(e,t){this._setOverride("gates",e,t)};e.prototype.overrideConfig=function(e,t){this._setOverride("configs",e,t)};e.prototype.overrideLayer=function(e,t){this._setOverride("layers",e,t)};e.prototype.setOverrides=function(e){var t=this;this._errorBoundary._swallow("setOverrides",(function(){t._overrides=null!=e?e:(0,cn.makeEmptyOverrides)();(0,cn.saveOverridesToLocalStorage)(t._overrides)}))};e.prototype.getOverrides=function(){var e=this;return this._errorBoundary._capture("getOverrides",(function(){return e._overrides}),(function(){return(0,cn.makeEmptyOverrides)()}))};e.prototype._delayedSetup=function(){var e=this;this._errorBoundary._swallow("delayedSetup",(function(){e._identity.saveStableID();e._logger.sendSavedRequests().then((function(){}))}))};e.prototype._normalizeUser=function(e){var t={};try{t=JSON.parse(JSON.stringify(e))}catch(e){throw new Qt.StatsigInvalidArgumentError("User object must be convertable to JSON string.")}null!=this._options.environment&&(t=zt(zt({},t),{statsigEnvironment:this._options.environment}));return t};e.prototype._ensureStoreLoaded=function(){if(!this._store.isLoaded())throw new Qt.StatsigUninitializedError};e.prototype._getEvaluationDetailsForError=function(){return{time:Date.now(),reason:on.EvaluationReason.Error}};e.prototype._fetchAndSaveValues=function(e,t){void 0===t&&(t=this._options.initTimeoutMs);return Wt(this,void 0,void 0,(function(){var n,i,r=this;return qt(this,(function(o){null;n=this._store.getLastUpdateTime(e);i=this._store.getPreviousDerivedFields(e);return[2,this._network.fetchValues(e,n,t,i).eventually((function(t){var n;(0,an.verifySDKKeyUsed)(t,null!==(n=r._sdkKey)&&void 0!==n?n:"",r._errorBoundary)&&(null==t?void 0:t.has_updates)&&r._store.save(e,t,!1)})).then((function(t){return Wt(r,void 0,void 0,(function(){var n=this;return qt(this,(function(i){return[2,this._errorBoundary._swallow("fetchAndSaveValues",(function(){return Wt(n,void 0,void 0,(function(){var n;return qt(this,(function(i){switch(i.label){case 0:return(0,an.verifySDKKeyUsed)(t,null!==(n=this._sdkKey)&&void 0!==n?n:"",this._errorBoundary)?(null==t?void 0:t.has_updates)?[4,this._store.save(e,t)]:[3,2]:[2];case 1:i.sent();return[3,3];case 2:(null==t?void 0:t.is_no_content)&&this._store.setEvaluationReason(on.EvaluationReason.NetworkNotModified);i.label=3;case 3:return[2]}}))}))}))]}))}))}))]}))}))};e.prototype._checkGateImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if("boolean"==typeof n._overrides.gates[e])return n._overrides.gates[e];var i=n._getGateFromStore(e);"checkGate"===t&&n._logGateExposureImpl(e,i);return!0===i.gate.value}),(function(){return!1}))};e.prototype._getGateFromStore=function(e){this._ensureStoreLoaded();if("string"!=typeof e||0===e.length)throw new Qt.StatsigInvalidArgumentError("Must pass a valid string as the gateName.");return this._store.checkGate(e)};e.prototype._logGateExposureImpl=function(e,t){var n,i=!t,r=null!=t?t:this._getGateFromStore(e),o=r.gate;this._logger.logGateExposure(this._identity._user,e,o.value,o.rule_id,this._store.mapExposures(null!==(n=o.secondary_exposures)&&void 0!==n?n:[]),r.evaluationDetails,i,this._store.getBootstrapMetadata())};e.prototype._getConfigImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if(n._overrides.configs[e])return new Yt.default(e,n._overrides.configs[e],"local_override",{reason:on.EvaluationReason.LocalOverride,time:Date.now()});var i=n._getConfigFromStore(e);"getConfig"===t&&n._logConfigExposureImpl(e,i);return i}),(function(){return n._getEmptyConfig(e)}))};e.prototype._getConfigFromStore=function(e){this._ensureStoreLoaded();if("string"!=typeof e||0===e.length)throw new Qt.StatsigInvalidArgumentError("Must pass a valid string as the configName.");return this._store.getConfig(e)};e.prototype._logConfigExposureImpl=function(e,t){var n=!t,i=null!=t?t:this._getConfigFromStore(e);this._logger.logConfigExposure(this._identity._user,e,i._ruleID,i._secondaryExposures,i._evaluationDetails,n,this._store.getBootstrapMetadata())};e.prototype._getLayerImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if(n._overrides.layers[e])return Zt.default._create(e,n._overrides.layers[e],"local_override",{reason:on.EvaluationReason.LocalOverride,time:Date.now()});var i="getLayer"===t?n._logLayerParameterExposureForLayer:null;return n._getLayerFromStore(i,e)}),(function(){return Zt.default._create(e,{},"",n._getEvaluationDetailsForError())}))};e.prototype._getLayerFromStore=function(e,t){this._ensureStoreLoaded();if("string"!=typeof t||0===t.length)throw new Qt.StatsigInvalidArgumentError("Must pass a valid string as the layerName.");return this._store.getLayer(e,t)};e.prototype._getEmptyConfig=function(e){return new Yt.default(e,{},"",this._getEvaluationDetailsForError())};e.prototype._setOverride=function(e,t,n){null==n?delete this._overrides[e][t]:this._overrides[e][t]=n;this.setOverrides(this._overrides)};return e}();Qe.default=dn;!function(e){var t=ae&&ae.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((i=i.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;(i=0,r)&&(s=[2&s[0],r.value]);switch(s[0]){case 0:case 1:r=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;i=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(r=a.trys,r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1];r=s;break}if(r&&a.label<r[2]){a.label=r[2];a.ops.push(s);break}r[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.EvaluationReason=e.Layer=e.DynamicConfig=void 0;var r=Xe,o=i(Qe),a=Dt,s=Ze;Object.defineProperty(e,"DynamicConfig",{enumerable:!0,get:function(){return i(s).default}});var u=nt;Object.defineProperty(e,"Layer",{enumerable:!0,get:function(){return i(u).default}});var l=Dt;Object.defineProperty(e,"EvaluationReason",{enumerable:!0,get:function(){return l.EvaluationReason}});var c=function(){function e(){}e.initialize=function(i,r,a){var s;return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){t=null!==(s=e.instance)&&void 0!==s?s:new o.default(i,r,a);e.instance||(e.instance=t);return[2,t.initializeAsync()]}))}))};e.setInitializeValues=function(t){e._getClientX().setInitializeValues(t)};e.checkGate=function(t){return e._getClientX().checkGate(t)};e.checkGateWithExposureLoggingDisabled=function(t){return e._getClientX().checkGateWithExposureLoggingDisabled(t)};e.manuallyLogGateExposure=function(t){e._getClientX().logGateExposure(t)};e.getConfig=function(t){return e._getClientX().getConfig(t)};e.getConfigWithExposureLoggingDisabled=function(t){return e._getClientX().getConfigWithExposureLoggingDisabled(t)};e.manuallyLogConfigExposure=function(t){e._getClientX().logConfigExposure(t)};e.getExperiment=function(t){return e._getClientX().getExperiment(t)};e.getExperimentWithExposureLoggingDisabled=function(t){return e._getClientX().getExperimentWithExposureLoggingDisabled(t)};e.manuallyLogExperimentExposure=function(t){e._getClientX().logExperimentExposure(t)};e.getLayer=function(t){return e._getClientX().getLayer(t)};e.getLayerWithExposureLoggingDisabled=function(t){return e._getClientX().getLayerWithExposureLoggingDisabled(t)};e.manuallyLogLayerParameterExposure=function(t,n){e._getClientX().logLayerParameterExposure(t,n)};e.logEvent=function(t,n,i){void 0===n&&(n=null);void 0===i&&(i=null);return e._getClientX().logEvent(t,n,i)};e.updateUser=function(t){return e._getClientX().updateUser(t)};e.updateUserWithValues=function(t,n){return e._getClientX().updateUserWithValues(t,n)};e.shutdown=function(){e._getClientX().shutdown();e.instance=null};e.overrideGate=function(t,n){e._getClientX().overrideGate(t,n)};e.overrideConfig=function(t,n){e._getClientX().overrideConfig(t,n)};e.overrideLayer=function(t,n){e._getClientX().overrideLayer(t,n)};e.setOverrides=function(t){e._getClientX().setOverrides(t)};e.getOverrides=function(){return e._getClientX().getOverrides()};e.getStableID=function(){return e._getClientX().getStableID()};e.getEvaluationDetails=function(){var t,n;return null!==(n=null===(t=e.instance)||void 0===t?void 0:t.getEvaluationDetails())&&void 0!==n?n:{reason:a.EvaluationReason.Uninitialized,time:0}};e.initializeCalled=function(){return null!=e.instance&&e.instance.initializeCalled()};e._getClientX=function(){if(!e.instance)throw new r.StatsigUninitializedError;return e.instance};e.instance=null;return e}();e.default=c}(Ye);var fn=se(Ye),pn={exports:{}};
/*!
   * EventEmitter2
   * https://github.com/hij1nx/EventEmitter2
   *
   * Copyright (c) 2013 hij1nx
   * Licensed under the MIT license.
   */
!function(e,t){!function(t){var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(){this._events={};this._conf&&r.call(this,this._conf)}function r(e){if(e){this._conf=e;e.delimiter&&(this.delimiter=e.delimiter);this._maxListeners=e.maxListeners!==t?e.maxListeners:10;e.wildcard&&(this.wildcard=e.wildcard);e.newListener&&(this.newListener=e.newListener);e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak);this.wildcard&&(this.listenerTree={})}else this._maxListeners=10}function o(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";this.verboseMemoryLeak&&(n+=" Event name: "+t+".");if("undefined"!=typeof process&&process.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning";i.emitter=this;i.count=e;process.emitWarning(i)}else{console.error(n);console.trace&&console.trace()}}function a(e){this._events={};this.newListener=!1;this.verboseMemoryLeak=!1;r.call(this,e)}a.EventEmitter2=a;function s(e,t,n,i){if(!n)return[];var r,o,a,u,l,c,d,f=[],p=t.length,h=t[i],g=t[i+1];if(i===p&&n._listeners){if("function"==typeof n._listeners){e&&e.push(n._listeners);return[n]}for(r=0,o=n._listeners.length;r<o;r++)e&&e.push(n._listeners[r]);return[n]}if("*"===h||"**"===h||n[h]){if("*"===h){for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&(f=f.concat(s(e,t,n[a],i+1)));return f}if("**"===h){(d=i+1===p||i+2===p&&"*"===g)&&n._listeners&&(f=f.concat(s(e,t,n,p)));for(a in n)if("_listeners"!==a&&n.hasOwnProperty(a))if("*"===a||"**"===a){n[a]._listeners&&!d&&(f=f.concat(s(e,t,n[a],p)));f=f.concat(s(e,t,n[a],i))}else f=a===g?f.concat(s(e,t,n[a],i+2)):f.concat(s(e,t,n[a],i));return f}f=f.concat(s(e,t,n[h],i+1))}(u=n["*"])&&s(e,t,u,i+1);if(l=n["**"])if(i<p){l._listeners&&s(e,t,l,p);for(a in l)if("_listeners"!==a&&l.hasOwnProperty(a))if(a===g)s(e,t,l[a],i+2);else if(a===h)s(e,t,l[a],i+1);else{(c={})[a]=l[a];s(e,t,{"**":c},i+1)}}else l._listeners?s(e,t,l,p):l["*"]&&l["*"]._listeners&&s(e,t,l["*"],p);return f}function u(e,n){for(var i=0,r=(e="string"==typeof e?e.split(this.delimiter):e.slice()).length;i+1<r;i++)if("**"===e[i]&&"**"===e[i+1])return;for(var a=this.listenerTree,s=e.shift();s!==t;){a[s]||(a[s]={});a=a[s];if(0===e.length){if(a._listeners){"function"==typeof a._listeners&&(a._listeners=[a._listeners]);a._listeners.push(n);if(!a._listeners.warned&&this._maxListeners>0&&a._listeners.length>this._maxListeners){a._listeners.warned=!0;o.call(this,a._listeners.length,s)}}else a._listeners=n;return!0}s=e.shift()}return!0}a.prototype.delimiter=".";a.prototype.setMaxListeners=function(e){if(e!==t){this._maxListeners=e;this._conf||(this._conf={});this._conf.maxListeners=e}};a.prototype.event="";a.prototype.once=function(e,t){return this._once(e,t,!1)};a.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)};a.prototype._once=function(e,t,n){this._many(e,1,t,n);return this};a.prototype.many=function(e,t,n){return this._many(e,t,n,!1)};a.prototype.prependMany=function(e,t,n){return this._many(e,t,n,!0)};a.prototype._many=function(e,t,n,i){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function o(){0==--t&&r.off(e,o);return n.apply(this,arguments)}o._origin=n;this._on(e,o,i);return r};a.prototype.emit=function(){this._events||i.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;var t,n,r,o,a,u=arguments.length;if(this._all&&this._all.length){a=this._all.slice();if(u>3){t=new Array(u);for(o=0;o<u;o++)t[o]=arguments[o]}for(r=0,n=a.length;r<n;r++){this.event=e;switch(u){case 1:a[r].call(this,e);break;case 2:a[r].call(this,e,arguments[1]);break;case 3:a[r].call(this,e,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}}}if(this.wildcard){a=[];var l="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,l,this.listenerTree,0)}else{if("function"==typeof(a=this._events[e])){this.event=e;switch(u){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:t=new Array(u-1);for(o=1;o<u;o++)t[o-1]=arguments[o];a.apply(this,t)}return!0}a&&(a=a.slice())}if(a&&a.length){if(u>3){t=new Array(u-1);for(o=1;o<u;o++)t[o-1]=arguments[o]}for(r=0,n=a.length;r<n;r++){this.event=e;switch(u){case 1:a[r].call(this);break;case 2:a[r].call(this,arguments[1]);break;case 3:a[r].call(this,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all};a.prototype.emitAsync=function(){this._events||i.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,r,o,a,u=[],l=arguments.length;if(this._all){if(l>3){t=new Array(l);for(o=1;o<l;o++)t[o]=arguments[o]}for(r=0,n=this._all.length;r<n;r++){this.event=e;switch(l){case 1:u.push(this._all[r].call(this,e));break;case 2:u.push(this._all[r].call(this,e,arguments[1]));break;case 3:u.push(this._all[r].call(this,e,arguments[1],arguments[2]));break;default:u.push(this._all[r].apply(this,t))}}}if(this.wildcard){a=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,c,this.listenerTree,0)}else a=this._events[e];if("function"==typeof a){this.event=e;switch(l){case 1:u.push(a.call(this));break;case 2:u.push(a.call(this,arguments[1]));break;case 3:u.push(a.call(this,arguments[1],arguments[2]));break;default:t=new Array(l-1);for(o=1;o<l;o++)t[o-1]=arguments[o];u.push(a.apply(this,t))}}else if(a&&a.length){a=a.slice();if(l>3){t=new Array(l-1);for(o=1;o<l;o++)t[o-1]=arguments[o]}for(r=0,n=a.length;r<n;r++){this.event=e;switch(l){case 1:u.push(a[r].call(this));break;case 2:u.push(a[r].call(this,arguments[1]));break;case 3:u.push(a[r].call(this,arguments[1],arguments[2]));break;default:u.push(a[r].apply(this,t))}}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)};a.prototype.on=function(e,t){return this._on(e,t,!1)};a.prototype.prependListener=function(e,t){return this._on(e,t,!0)};a.prototype.onAny=function(e){return this._onAny(e,!1)};a.prototype.prependAny=function(e){return this._onAny(e,!0)};a.prototype.addListener=a.prototype.on;a.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");this._all||(this._all=[]);t?this._all.unshift(e):this._all.push(e);return this};a.prototype._on=function(e,t,n){if("function"==typeof e){this._onAny(e,t);return this}if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||i.call(this);this.emit("newListener",e,t);if(this.wildcard){u.call(this,e,t);return this}if(this._events[e]){"function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]);n?this._events[e].unshift(t):this._events[e].push(t);if(!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners){this._events[e].warned=!0;o.call(this,this._events[e].length,e)}}else this._events[e]=t;return this};a.prototype.off=function(e,i){if("function"!=typeof i)throw new Error("removeListener only takes instances of Function");var r,o=[];if(this.wildcard){var a="string"==typeof e?e.split(this.delimiter):e.slice();o=s.call(this,null,a,this.listenerTree,0)}else{if(!this._events[e])return this;r=this._events[e];o.push({_listeners:r})}for(var u=0;u<o.length;u++){var l=o[u];r=l._listeners;if(n(r)){for(var c=-1,d=0,f=r.length;d<f;d++)if(r[d]===i||r[d].listener&&r[d].listener===i||r[d]._origin&&r[d]._origin===i){c=d;break}if(c<0)continue;this.wildcard?l._listeners.splice(c,1):this._events[e].splice(c,1);0===r.length&&(this.wildcard?delete l._listeners:delete this._events[e]);this.emit("removeListener",e,i);return this}if(r===i||r.listener&&r.listener===i||r._origin&&r._origin===i){this.wildcard?delete l._listeners:delete this._events[e];this.emit("removeListener",e,i)}}!function e(n){if(n!==t){var i=Object.keys(n);for(var r in i){var o=i[r],a=n[o];if(!(a instanceof Function||"object"!=typeof a||null===a)){Object.keys(a).length>0&&e(n[o]);0===Object.keys(a).length&&delete n[o]}}}}(this.listenerTree);return this};a.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(n=0,i=(t=this._all).length;n<i;n++)if(e===t[n]){t.splice(n,1);this.emit("removeListenerAny",e);return this}}else{for(n=0,i=(t=this._all).length;n<i;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this};a.prototype.removeListener=a.prototype.off;a.prototype.removeAllListeners=function(e){if(0===arguments.length){!this._events||i.call(this);return this}if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),n=s.call(this,null,t,this.listenerTree,0),r=0;r<n.length;r++){var o=n[r];o._listeners=null}else this._events&&(this._events[e]=null);return this};a.prototype.listeners=function(e){if(this.wildcard){var t=[],r="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,t,r,this.listenerTree,0);return t}this._events||i.call(this);this._events[e]||(this._events[e]=[]);n(this._events[e])||(this._events[e]=[this._events[e]]);return this._events[e]};a.prototype.eventNames=function(){return Object.keys(this._events)};a.prototype.listenerCount=function(e){return this.listeners(e).length};a.prototype.listenersAny=function(){return this._all?this._all:[]};e.exports=a}()}(pn);function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vn="@all-features",yn=function(){return Ge((function e(){Fe(this,e);Ue(this,"eventToValue",new Map);this.emitter=new pn.exports.EventEmitter2}),[{key:"onGateUpdated",value:function(e,t,n,i){var r=this,o=n(e,gn(gn({},i),{},{fireGateExposure:!1}));void 0===this.eventToValue.get(t)&&this.eventToValue.set(t,o);var a=function(){var o=n(e,gn(gn({},i),{},{fireGateExposure:!1}));if(r.eventToValue.get(t)!==o){r.eventToValue.set(t,o);t(o)}};this.emitter.on(e,a);return function(){r.emitter.off(e,a)}}},{key:"onExperimentValueUpdated",value:function(e,t,n,i,r,o){var a=this,s="".concat(e,".").concat(t),u=r(e,t,n,gn(gn({},o),{},{fireExperimentExposure:!1}));void 0===this.eventToValue.get(i)&&this.eventToValue.set(i,u);var l=function(){var s=r(e,t,n,gn(gn({},o),{},{fireExperimentExposure:!1}));if(a.eventToValue.get(i)!==s){a.eventToValue.set(i,s);i(s)}};this.emitter.on(s,l);return function(){a.emitter.off(s,l)}}},{key:"onAnyUpdated",value:function(e){var t=this;this.emitter.on(vn,e);return function(){t.emitter.off(vn,e)}}},{key:"anyUpdated",value:function(){var e=this;this.emitter.emit(vn);this.emitter.eventNames().filter((function(e){return e!==vn})).forEach((function(t){e.emitter.emit(t)}))}}])}(),mn=function(e){e.Development="development";e.Staging="staging";e.Production="production";return e}({}),_n=function(e){e.COMMERCIAL="commercial";e.FEDRAMP_MODERATE="fedramp-moderate";return e}({}),bn="4.23.4";function wn(e,t){if(t&&("object"===Ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xn(e){xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)};return xn(e)}function En(e){var n="function"==typeof Map?new Map:void 0;En=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,i)}function i(){return A(e,arguments,xn(this).constructor)}i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}});return t(i,e)};return En(e)}function kn(e,t,n){return t=xn(t),wn(e,On()?Reflect.construct(t,n||[],xn(e).constructor):t.apply(e,n))}function On(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(On=function(){return!!e})()}var Sn=function(e){function n(e){Fe(this,n);return kn(this,n,[e])}!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});Object.defineProperty(e,"prototype",{writable:!1});n&&t(e,n)}(n,e);return Ge(n)}(En(Error));function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?An(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var In="https://api.atlassian.com/flags",Ln="https://api.stg.atlassian.com/flags",Tn="https://api.dev.atlassian.com/flags",Pn="https://api.stg.atlassian-us-gov-mod.com/flags",Dn="https://api.atlassian-us-gov-mod.com/flags",Mn="/gateway/api/flags",jn=function(){function e(){Fe(this,e)}return Ge(e,null,[{key:"fetchClientSdk",value:(o=$e(He.mark((function e(t){var n,i;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.targetApp;i="/api/v2/frontend/clientSdkKey/".concat(n);e.prev=2;e.next=5;return this.fetchRequest(i,"GET",t);case 5:return e.abrupt("return",e.sent);case 8:e.prev=8;e.t0=e.catch(2);if(!(e.t0 instanceof Error)){e.next=12;break}throw e.t0;case 12:throw Error("Failed to retrieve client sdk key");case 13:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return o.apply(this,arguments)})},{key:"fetchExperimentValues",value:(r=$e(He.mark((function e(t,n,i){var r;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={identifiers:n,customAttributes:i,targetApp:t.targetApp};e.prev=1;e.next=4;return this.fetchRequest("/api/v2/frontend/experimentValues","POST",t,r);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7;e.t0=e.catch(1);if(!(e.t0 instanceof Error)){e.next=11;break}throw e.t0;case 11:throw Error("Failed to retrieve experiment values");case 12:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"handleResponseError",value:(i=$e(He.mark((function e(t){var n;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}e.next=3;return t.text();case 3:n=e.sent;throw new Sn("Non 2xx response status received, status: ".concat(t.status,", body: ").concat(JSON.stringify(n)));case 5:if(204!==t.status){e.next=7;break}throw new Sn("Unexpected 204 response");case 7:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"extractResponseBody",value:(n=$e(He.mark((function e(t){var n;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;return t.text();case 2:n=e.sent;return e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"getBaseUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(t)return Mn;if(n===_n.FEDRAMP_MODERATE)switch(e){case mn.Production:return Dn;case mn.Staging:return Pn;default:throw new Error('Invalid environment "'.concat(e,'" for "').concat(n,'" perimeter'))}else{if(n!==_n.COMMERCIAL)throw new Error('Invalid perimeter "'.concat(n,'"'));switch(e){case mn.Development:return Tn;case mn.Staging:return Ln;default:return In}}}},{key:"fetchRequest",value:(t=$e(He.mark((function t(n,i,r,o){var a,s,u,l,c;return He.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.getBaseUrl(r.environment,r.useGatewayURL,r.perimeter);s=r.fetchTimeoutMs||5e3;if(AbortSignal.timeout)u=AbortSignal.timeout(s);else if(AbortController){l=new AbortController;u=l.signal;setTimeout((function(){return l.abort()}),s)}t.next=5;return fetch("".concat(a).concat(n),Cn({method:i,headers:{"Content-Type":"application/json","X-Client-Name":"feature-gate-js-client","X-Client-Version":bn,"X-API-KEY":r.apiKey},signal:u},o&&{body:JSON.stringify(o)}));case 5:c=t.sent;t.next=8;return this.handleResponseError(c);case 8:t.next=10;return this.extractResponseBody(c);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)}))),function(e,n,i,r){return t.apply(this,arguments)})}]);var t,n,i,r,o}();function Fn(){var e,t=globalThis,n=t.MICROS_PERIMETER||t.UNSAFE_ATL_CONTEXT_BOUNDARY;if(n)return"fedramp-moderate"===n;var i=null===(e=t.location)||void 0===e||null===(e=e.hostname)||void 0===e?void 0:e.match(/atlassian-us-gov-mod\.(com|net)|atlassian-us-gov\.(com|net)|atlassian-fex\.(com|net)|atlassian-stg-fedm\.(com|net)/);return!!i&&i.length>0}var Vn=["sdkKey","updateUserCompletionCallback","perimeter"];function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gn=function(e){return Rn({perimeter:Fn()?_n.FEDRAMP_MODERATE:_n.COMMERCIAL},e)},Un=function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=Object.entries(e),i=Object.entries(t);if(n.length!==i.length)return!1;var r=function(e,t){var n=ze(e,1)[0],i=ze(t,1)[0];return n.localeCompare(i)};n.sort(r);i.sort(r);for(var o=0;o<n.length;o++){if(ze(n[o],2)[1]!==ze(i[o],2)[1])return!1}return!0},Bn=function(e,t){var n={customIDs:e,custom:t};e.atlassianAccountId&&(n.userID=e.atlassianAccountId);return n},zn=function(e,t){e.sdkKey;e.updateUserCompletionCallback;e.perimeter;var n=function(e,t){if(null==e)return{};var n,i,r=O(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++){n=o[i];t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}}return r}(e,Vn);return Rn(Rn({},n),{},{initializeValues:t,environment:{tier:e.environment},disableCurrentPageLogging:!0},e.updateUserCompletionCallback&&{updateUserCompletionCallback:Kn(e.updateUserCompletionCallback)})},Kn=function(e){return function(t,n,i){e(n,i)}};function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wn,qn="client-default-key",Hn="https://xp.atlassian.com/v1/",Yn=function(){return Ge((function e(){Fe(this,e);Ue(this,"initPromise",null);Ue(this,"initCompleted",!1);Ue(this,"initWithDefaults",!1);Ue(this,"hasCheckGateErrorOccurred",!1);Ue(this,"hasGetExperimentErrorOccurred",!1);Ue(this,"hasGetExperimentValueErrorOccurred",!1);Ue(this,"hasGetLayerErrorOccurred",!1);Ue(this,"hasGetLayerValueErrorOccurred",!1);Ue(this,"subscriptions",new yn)}),[{key:"initialize",value:(c=$e(He.mark((function e(t,n,i){var r,o,a=this;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Gn(t);if(!this.initPromise){e.next=4;break}Un(r,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 4:o=performance.now();this.initOptions=r;this.initPromise=this.init(r,n,i).then((function(){a.initCompleted=!0;a.initWithDefaults=!0})).finally((function(){var e=performance.now()-o;a.fireClientEvent(o,e,"initialize",a.initCompleted,r.apiKey)}));return e.abrupt("return",this.initPromise);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"initializeWithProvider",value:(l=$e(He.mark((function e(t,n,i,r){var o,a,s=this;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Gn(t);if(!this.initPromise){e.next=4;break}Un(o,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 4:a=performance.now();this.initOptions=o;this.provider=n;this.provider.setClientVersion(bn);this.provider.setApplyUpdateCallback&&this.provider.setApplyUpdateCallback(this.applyUpdateCallback);this.initPromise=this.initWithProvider(o,n,i,r).then((function(){s.initCompleted=!0;s.initWithDefaults=!0})).finally((function(){var e=performance.now()-a;s.fireClientEvent(a,e,"initializeWithProvider",s.initCompleted,n.getApiKey?n.getApiKey():void 0)}));return e.abrupt("return",this.initPromise);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return l.apply(this,arguments)})},{key:"applyUpdateCallback",value:function(e){try{if(this.initCompleted||this.initWithDefaults){fn.setInitializeValues(e.experimentValues);this.subscriptions.anyUpdated()}}catch(e){console.warn("Error when attempting to apply update",e)}}},{key:"fireClientEvent",value:function(e,t,n,i){var r,o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;null===(r=this.initOptions.analyticsWebClient)||void 0===r||r.then((function(r){var s=Jn({targetApp:o.initOptions.targetApp,clientVersion:bn,success:i,startTime:e,totalTime:t},a&&{apiKey:a});r.sendOperationalEvent({action:n,actionSubject:"featureGatesClient",attributes:s,tags:["measurement"],source:"@atlaskit/feature-gate-js-client"})})).catch((function(e){o.initOptions.environment!==mn.Production&&console.error("Analytics web client promise did not resolve",e)}))}},{key:"initializeFromValues",value:(u=$e(He.mark((function e(t,n,i){var r,o,a,s=this,u=arguments;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=u.length>3&&void 0!==u[3]?u[3]:{};o=Gn(t);if(!this.initPromise){e.next=5;break}Un(o,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 5:a=performance.now();this.initOptions=o;this.initPromise=this.initFromValues(o,n,i,r).then((function(){s.initCompleted=!0;s.initWithDefaults=!0})).finally((function(){var e=performance.now()-a;s.fireClientEvent(a,e,"initializeFromValues",s.initCompleted)}));return e.abrupt("return",this.initPromise);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"updateUser",value:(s=$e(He.mark((function e(t,n,i){var r,o;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Gn(t);o=function(){return jn.fetchExperimentValues(r,n,i).then((function(e){return{experimentValues:e.experimentValues,customAttributesFromFetch:e.customAttributes}}))};e.next=4;return this.updateUserUsingInitializeValuesProducer(o,n,i);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"updateUserWithProvider",value:(a=$e(He.mark((function e(t,n){var i=this;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.provider){e.next=2;break}throw new Error("Cannot update user using provider as the client was not initialised with a provider");case 2:e.next=4;return this.provider.setProfile(this.initOptions,t,n);case 4:e.next=6;return this.updateUserUsingInitializeValuesProducer((function(){return i.provider.getExperimentValues()}),t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"updateUserWithValues",value:(o=$e(He.mark((function e(t,n){var i,r,o=arguments;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=o.length>2&&void 0!==o[2]?o[2]:{};r=function(){return Promise.resolve({experimentValues:i,customAttributesFromFetch:n})};e.next=4;return this.updateUserUsingInitializeValuesProducer(r,t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"initializeCalled",value:function(){return null!=this.initPromise}},{key:"initializeCompleted",value:function(){return this.initCompleted}},{key:"checkGate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireGateExposure,i=void 0===n||n,r=i?fn.checkGate.bind(fn):fn.checkGateWithExposureLoggingDisabled.bind(fn);return r(e)}catch(t){if(!this.hasCheckGateErrorOccurred){console.warn({msg:"An error has occurred checking the feature gate. Only the first occurrence of this error is logged.",gateName:e,error:t});this.hasCheckGateErrorOccurred=!0}return!1}}},{key:"isGateExist",value:function(e){try{return fn._getClientX()._getGateFromStore(e).evaluationDetails.reason!==Ye.EvaluationReason.Unrecognized}catch(e){console.error("Error occurred when trying to check FeatureGate: ".concat(e));return!0}}},{key:"isExperimentExist",value:function(e){try{return fn.getExperimentWithExposureLoggingDisabled(e)._evaluationDetails.reason!==Ye.EvaluationReason.Unrecognized}catch(e){console.error("Error occurred when trying to check Experiment: ".concat(e));return!0}}},{key:"manuallyLogGateExposure",value:function(e){fn.manuallyLogGateExposure(e)}},{key:"getExperiment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireExperimentExposure,i=void 0===n||n,r=i?fn.getExperiment.bind(fn):fn.getExperimentWithExposureLoggingDisabled.bind(fn);return r(e)}catch(t){if(!this.hasGetExperimentErrorOccurred){console.warn({msg:"An error has occurred getting the experiment. Only the first occurrence of this error is logged.",experimentName:e,error:t});this.hasGetExperimentErrorOccurred=!0}return new Ye.DynamicConfig(e,{},"",{time:Date.now(),reason:Ye.EvaluationReason.Error})}}},{key:"getExperimentValue",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getExperiment(e,i);try{var o=i.typeGuard;return r.get(t,n,o)}catch(t){if(!this.hasGetExperimentValueErrorOccurred){console.warn({msg:"An error has occurred getting the experiment value. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:n,options:i,error:t});this.hasGetExperimentValueErrorOccurred=!0}return n}}},{key:"manuallyLogExperimentExposure",value:function(e){fn.manuallyLogExperimentExposure(e)}},{key:"manuallyLogLayerExposure",value:function(e,t){fn.manuallyLogLayerParameterExposure(e,t)}},{key:"shutdownStatsig",value:function(){fn.shutdown()}},{key:"overrideGate",value:function(e,t){fn.overrideGate(e,t);this.subscriptions.anyUpdated()}},{key:"clearGateOverride",value:function(e){fn.overrideGate(e,null);this.subscriptions.anyUpdated()}},{key:"overrideConfig",value:function(e,t){fn.overrideConfig(e,t);this.subscriptions.anyUpdated()}},{key:"clearConfigOverride",value:function(e){fn.overrideConfig(e,null);this.subscriptions.anyUpdated()}},{key:"setOverrides",value:function(e){fn.setOverrides(Jn({gates:{},configs:{},layers:{}},e));this.subscriptions.anyUpdated()}},{key:"getOverrides",value:function(){return fn.getOverrides()}},{key:"clearAllOverrides",value:function(){fn.setOverrides(null);this.subscriptions.anyUpdated()}},{key:"isCurrentUser",value:function(e,t){return Un(this.currentIdentifiers,e)&&Un(this.currentAttributes,t)}},{key:"onGateUpdated",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(r){var o=i.fireGateExposure;(void 0===o||o)&&n.manuallyLogGateExposure(e);try{t(r)}catch(t){console.warn("Error calling callback for gate ".concat(e," with value ").concat(r),t)}};return this.subscriptions.onGateUpdated(e,r,this.checkGate.bind(this),i)}},{key:"onExperimentValueUpdated",value:function(e,t,n,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=function(t){var n=o.fireExperimentExposure;(void 0===n||n)&&r.manuallyLogExperimentExposure(e);try{i(t)}catch(n){console.warn("Error calling callback for experiment ".concat(e," with value ").concat(t),n)}};return this.subscriptions.onExperimentValueUpdated(e,t,n,a,this.getExperimentValue,o)}},{key:"onAnyUpdated",value:function(e){return this.subscriptions.onAnyUpdated(e)}},{key:"init",value:(r=$e(He.mark((function e(t,n,i){var r,o,a,s,u,l,c,d;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Jn({},t);e.prev=1;s=jn.fetchClientSdk(t).then((function(e){return r.sdkKey=e.clientSdkKey}));u=jn.fetchExperimentValues(t,n,i);e.next=6;return Promise.all([s,u]);case 6:l=e.sent;c=ze(l,2);d=c[1];o=d.experimentValues;a=d.customAttributes;e.next=20;break;case 13:e.prev=13;e.t0=e.catch(1);e.t0 instanceof Error&&console.error("Error occurred when trying to fetch the Feature Gates client values, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client without values");e.next=19;return this.initFromValues(r,n,i);case 19:throw e.t0;case 20:return e.abrupt("return",this.initFromValues(r,n,a,o));case 21:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"initWithProvider",value:(i=$e(He.mark((function e(t,n,i,r){var o,a,s,u,l,c,d,f;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Jn(Jn({},t),{},{disableCurrentPageLogging:!0});e.prev=1;e.next=4;return n.setProfile(t,i,r);case 4:u=n.getClientSdkKey().then((function(e){return o.sdkKey=e}));l=n.getExperimentValues();e.next=8;return Promise.all([u,l]);case 8:c=e.sent;d=ze(c,2);f=d[1];a=f.experimentValues;s=f.customAttributesFromFetch;e.next=22;break;case 15:e.prev=15;e.t0=e.catch(1);e.t0 instanceof Error&&console.error("Error occurred when trying to fetch the Feature Gates client values, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client without values");e.next=21;return this.initFromValues(o,i,r);case 21:throw e.t0;case 22:return e.abrupt("return",this.initFromValues(o,i,s,a));case 23:case"end":return e.stop()}}),e,this,[[1,15]])}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"initFromValues",value:(n=$e(He.mark((function e(t,n,i){var r,o,a,s,u=arguments;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=u.length>3&&void 0!==u[3]?u[3]:{};o=Bn(n,i);this.currentIdentifiers=n;this.currentAttributes=i;t.sdkKey||(t.sdkKey=qn);t.eventLoggingApi||(t.eventLoggingApi=Hn);t.perimeter===_n.FEDRAMP_MODERATE&&(t.disableAllLogging=!0);a=t.sdkKey;s=zn(t,r);e.prev=9;e.next=12;return fn.initialize(a,o,s);case 12:e.next=22;break;case 14:e.prev=14;e.t0=e.catch(9);e.t0 instanceof Error&&console.error("Error occurred when trying to initialise the Statsig client, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client with default sdk key and without values");e.next=20;return fn.initialize(qn,o,Jn(Jn({},s),{},{initializeValues:{}}));case 20:this.initWithDefaults=!0;throw e.t0;case 22:case"end":return e.stop()}}),e,this,[[9,14]])}))),function(e,t,i){return n.apply(this,arguments)})},{key:"updateUserUsingInitializeValuesProducer",value:(t=$e(He.mark((function e(t,n,i){var r,o,a,s=this;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initPromise){e.next=2;break}throw new Error("The client must be initialized before you can update the user.");case 2:if(!this.isCurrentUser(n,i)){e.next=4;break}return e.abrupt("return",this.initPromise);case 4:r=this.initPromise;e.prev=5;e.next=8;return this.initPromise;case 8:e.next=12;break;case 10:e.prev=10;e.t0=e.catch(5);case 12:o=t();a=this.updateStatsigClientUser(o,n,i);this.initPromise=a.catch($e(He.mark((function e(){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.initPromise=r;if(!s.provider){e.next=4;break}e.next=4;return s.provider.setProfile(s.initOptions,s.currentIdentifiers,s.currentAttributes);case 4:case"end":return e.stop()}}),e)}))));return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(e,n,i){return t.apply(this,arguments)})},{key:"updateStatsigClientUser",value:(e=$e(He.mark((function e(t,n,i){var r,o,a,s,u;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return t;case 3:r=e.sent;o=Bn(n,r.customAttributesFromFetch);e.next=12;break;case 7:e.prev=7;e.t0=e.catch(0);u=e.t0 instanceof Error?e.t0.message:JSON.stringify(e.t0);null===(a=(s=this.initOptions).updateUserCompletionCallback)||void 0===a||a.call(s,!1,u);throw e.t0;case 12:if(!fn.updateUserWithValues(o,r.experimentValues)){e.next=19;break}this.currentIdentifiers=n;this.currentAttributes=i;this.subscriptions.anyUpdated();e.next=20;break;case 19:throw new Error("Failed to update user. An unexpected error occured.");case 20:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(t,n,i){return e.apply(this,arguments)})},{key:"getPackageVersion",value:function(){return bn}},{key:"getLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireLayerExposure,i=void 0===n||n,r=i?fn.getLayer.bind(fn):fn.getLayerWithExposureLoggingDisabled.bind(fn);return r(e)}catch(t){if(!this.hasGetLayerErrorOccurred){console.warn({msg:"An error has occurred getting the layer. Only the first occurrence of this error is logged.",layerName:e,error:t});this.hasGetLayerErrorOccurred=!0}return Ye.Layer._create(e,{},"",{time:Date.now(),reason:Ye.EvaluationReason.Error})}}},{key:"getLayerValue",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getLayer(e,i);try{var o=i.typeGuard;return r.get(t,n,o)}catch(t){if(!this.hasGetLayerValueErrorOccurred){console.warn({msg:"An error has occurred getting the layer value. Only the first occurrence of this error is logged.",layerName:e,defaultValue:n,options:i,error:t});this.hasGetLayerValueErrorOccurred=!0}return n}}}]);var e,t,n,i,r,o,a,s,u,l,c}(),Xn=function(){return Ge((function e(){Fe(this,e)}),null,[{key:"isGateExists",value:function(e){return this.client.isGateExist(e)}},{key:"isExperimentExists",value:function(e){return this.client.isExperimentExist(e)}}])}();Wn=Xn;Ue(Xn,"client",new Yn);Ue(Xn,"hasCheckGateErrorOccurred",!1);Ue(Xn,"hasGetExperimentValueErrorOccurred",!1);Ue(Xn,"checkGate",(function(e,t){try{if(window&&window.__CRITERION__&&"function"==typeof window.__CRITERION__.getFeatureFlagOverride){var n=window.__CRITERION__.getFeatureFlagOverride(e);if(void 0!==n)return n}}catch(t){if(!Wn.hasCheckGateErrorOccurred){console.warn({msg:"An error has occurred checking the feature gate from criterion override. Only the first occurrence of this error is logged.",gateName:e,error:t});Wn.hasCheckGateErrorOccurred=!0}}return Wn.client.checkGate(e,t)}));Ue(Xn,"getExperimentValue",(function(e,t,n,i){try{if("undefined"!=typeof window&&window.__CRITERION__&&"function"==typeof window.__CRITERION__.getExperimentValueOverride){var r=window.__CRITERION__.getExperimentValueOverride(e,t);if(null!=r)return r}}catch(t){if(!Wn.hasCheckGateErrorOccurred){if(!Wn.hasGetExperimentValueErrorOccurred){console.warn({msg:"An error has occurred getting the experiment value from criterion override. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:n,options:i,error:t});Wn.hasGetExperimentValueErrorOccurred=!0}return n}}return Wn.client.getExperimentValue(e,t,n,i)}));Ue(Xn,"initializeCalled",Wn.client.initializeCalled.bind(Wn.client));Ue(Xn,"initializeCompleted",Wn.client.initializeCompleted.bind(Wn.client));Ue(Xn,"initialize",Wn.client.initialize.bind(Wn.client));Ue(Xn,"initializeWithProvider",Wn.client.initializeWithProvider.bind(Wn.client));Ue(Xn,"initializeFromValues",Wn.client.initializeFromValues.bind(Wn.client));Ue(Xn,"manuallyLogGateExposure",Wn.client.manuallyLogGateExposure.bind(Wn.client));Ue(Xn,"getExperiment",Wn.client.getExperiment.bind(Wn.client));Ue(Xn,"manuallyLogExperimentExposure",Wn.client.manuallyLogExperimentExposure.bind(Wn.client));Ue(Xn,"manuallyLogLayerExposure",Wn.client.manuallyLogLayerExposure.bind(Wn.client));Ue(Xn,"shutdownStatsig",Wn.client.shutdownStatsig.bind(Wn.client));Ue(Xn,"overrideGate",Wn.client.overrideGate.bind(Wn.client));Ue(Xn,"clearGateOverride",Wn.client.clearGateOverride.bind(Wn.client));Ue(Xn,"overrideConfig",Wn.client.overrideConfig.bind(Wn.client));Ue(Xn,"clearConfigOverride",Wn.client.clearConfigOverride.bind(Wn.client));Ue(Xn,"setOverrides",Wn.client.setOverrides.bind(Wn.client));Ue(Xn,"getOverrides",Wn.client.getOverrides.bind(Wn.client));Ue(Xn,"clearAllOverrides",Wn.client.clearAllOverrides.bind(Wn.client));Ue(Xn,"isCurrentUser",Wn.client.isCurrentUser.bind(Wn.client));Ue(Xn,"onGateUpdated",Wn.client.onGateUpdated.bind(Wn.client));Ue(Xn,"onExperimentValueUpdated",Wn.client.onExperimentValueUpdated.bind(Wn.client));Ue(Xn,"onAnyUpdated",Wn.client.onAnyUpdated.bind(Wn.client));Ue(Xn,"updateUser",Wn.client.updateUser.bind(Wn.client));Ue(Xn,"updateUserWithProvider",Wn.client.updateUserWithProvider.bind(Wn.client));Ue(Xn,"updateUserWithValues",Wn.client.updateUserWithValues.bind(Wn.client));Ue(Xn,"getPackageVersion",Wn.client.getPackageVersion.bind(Wn.client));Ue(Xn,"getLayer",Wn.client.getLayer.bind(Wn.client));Ue(Xn,"getLayerValue",Wn.client.getLayerValue.bind(Wn.client));var Qn=Xn;if("undefined"!=typeof window)if(void 0===window.__FEATUREGATES_JS__)window.__FEATUREGATES_JS__=Xn;else{var Zn,ei,ti=(null===(Zn=Qn=window.__FEATUREGATES_JS__)||void 0===Zn||null===(ei=Zn.getPackageVersion)||void 0===ei?void 0:ei.call(Zn))||"4.10.0 or earlier";if(ti!==bn){var ni="Multiple versions of FeatureGateClients found on the current page.\n      The currently bound version is ".concat(ti," when module version ").concat(bn," was loading.");console.warn(ni)}}var ii=Qn;function ri(e){return function(e){if(ii.initializeCompleted())return ii.checkGate(e);ie.trackGasV3FeatureFlagDefaultFalse(e);console.error("[ACJS] Feature flag service is not initialised. Default flag '"+e+"' to false");return!1}(e)}var oi,ai,si=!1,ui="com.codebarrel.addons.automation";!(void 0!==(null===globalThis||void 0===globalThis||null===(oi=globalThis.process)||void 0===oi||null===(oi=oi.env)||void 0===oi?void 0:oi.JEST_WORKER_ID))&&(null===globalThis||void 0===globalThis||null===(ai=globalThis.process)||void 0===ai||null===(ai=ai.env)||void 0===ai||ai.NODE_ENV);var li="__PLATFORM_FEATURE_FLAGS__",ci=("undefined"!=typeof process&&process.env,{earlyResolvedFlags:new Map,booleanResolver:function(e){return!1}}),di="undefined"!=typeof window?window:globalThis;di[li]=di[li]||ci;function fi(e){false;try{var t,n,i;if(void 0===(null===(t=di[li])||void 0===t?void 0:t.booleanResolver)||null===(null===(n=di[li])||void 0===n?void 0:n.booleanResolver))return ii.checkGate(e);var r=null===(i=di[li])||void 0===i?void 0:i.booleanResolver(e);if("boolean"!=typeof r){console.warn("".concat(e," resolved to a non-boolean value, returning false for safety"));return!1}return r}catch(e){return!1}}var pi=["platform-visual-refresh-icons","acjs_new_font"];var hi=!1;function gi(){if(!hi){hi=!0;var e={getBooleanFeatureFlag:function(e){return new Promise((function(t,n){if(function(e){return pi.includes(e)}(e))t(fi(e));else{if(!function(e){return 0===e.indexOf("acjs-iframe-allowlist")}(e)){n(new Error("Only allowlisted flags can be accessed from the iframe."));return}t(ri(e))}}))}};M.returnsPromise(e.getBooleanFeatureFlag);M.defineModule("_featureFlag",e)}}function vi(e){return{addon_key:e.addon_key,key:e.key,url:e.url,options:e.options}}var yi={createSimpleXdmExtension:function(e){var t=vi(e),n=je.get();e.options=t.options=U.extend({},t.options);e.options.globalOptions=n;!function(e){e===ui&&function(){if(!si){si=!0;var e={getPerformanceTiming:function(e){return new Promise((function(n,i){t(e)||i(new Error("This is a restricted API"));n(JSON.parse(JSON.stringify(window.performance.timing)))}))},getPerformanceNavigationTiming:function(e){return new Promise((function(n,i){t(e)||i(new Error("This is a restricted API"));window.PerformanceNavigationTiming||n(void 0);var r=window.performance.getEntriesByType("navigation");n(JSON.parse(JSON.stringify(r)))}))}};M.returnsPromise(e.getPerformanceTiming);M.returnsPromise(e.getPerformanceNavigationTiming);M.defineModule("_performance",e)}function t(e){return e._context.extension.addon_key===ui}}();gi()}(e.addon_key);var i=M.create(t,(function(){e.options.noDOM||(e.$el=_(document.getElementById(e.id)));oe.notifyBridgeEstablished(e.$el,e)}),(function(){oe.notifyUnloaded(e.$el,e)}));t.id=i.id;e.id=i.id;U.extend(i,Me(e.options));return{iframeAttributes:i,extension:e}},extensionConfigSanitizer:vi},mi=new(function(){function e(){this._contentResolver=!1}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.resize=function(e,t,n){e=U.stringToDimension(e);t=U.stringToDimension(t);n.css({width:e,height:t});n.trigger("resized",{width:e,height:t})};t.simpleXdmExtension=function(e,t){!e.url||Le.hasJwt(e.url)&&Le.isJwtExpired(e.url)?this._contentResolver?Pe({extension:e,resolver:this._contentResolver,$container:t}):console.error("JWT is expired and no content resolver was specified"):this._appendExtension(t,this._simpleXdmCreate(e))};t._simpleXdmCreate=function(e){var t=yi.createSimpleXdmExtension(e);e.id=t.iframeAttributes.id;e.$el=this.render(t.iframeAttributes);return e};t._appendExtension=function(e,t){var n=e.find("iframe");n.length>0&&n.destroy();t.options.hideIframeUntilLoad&&t.$el.css({visibility:"hidden"}).load((function(){t.$el.css({visibility:""})}));e.prepend(t.$el);oe.notifyIframeCreated(t.$el,t)};t._appendExtensionError=function(e,t){var n=_('<div class="connect-resolve-error"></div>'),i=_("<p />").text(t);n.append('<p class="error">Error: The content resolver threw the following error:</p>');n.append(i);e.prepend(n)};t.resolverResponse=function(e){var t=this._simpleXdmCreate(e.extension);this._appendExtension(e.$container,t)};t.resolverFailResponse=function(e){this._appendExtensionError(e.$container,e.errorText)};t.render=function(e){(e=e||{}).referrerpolicy="no-referrer";return _("<iframe />").attr(e).addClass("ap-iframe")};return e}());v.register("iframe-resize",(function(e){mi.resize(e.width,e.height,e.$el)}));v.register("content-resolver-register-by-extension",(function(e){mi.setContentResolver(e.callback)}));v.register("jwt-url-refreshed",(function(e){mi.resolverResponse(e)}));v.register("jwt-url-refreshed-failed",(function(e){mi.resolverFailResponse(e)}));v.register("after:iframe-bridge-established",(function(e){e.extension.options.noDom?e.extension.options.bridgeEstablished=!0:e.$el[0].bridgeEstablished=!0}));var _i=function(e){v.dispatch("button-clicked",{$el:e})},bi=function(e,t){v.dispatch("button-toggle",{$el:e,disabled:t})},wi=function(e,t){v.dispatch("button-toggle-visibility",{$el:e,hidden:t})},xi=["primary","link","secondary"],Ei=0,ki=function(){function e(){this.AP_BUTTON_CLASS="ap-aui-button"}var t=e.prototype;t.setType=function(e,t){t&&xi.indexOf(t)>=0&&e.addClass("aui-button-"+t);return e};t.setDisabled=function(e,t){void 0===t||e.data("immutable")||e.attr("aria-disabled",t);return e};t.setHidden=function(e,t){void 0===t||e.data("immutable")||e.toggle(!t);return e};t._setId=function(e,t){if(!t){t="ap-button-"+Ei;Ei++}e.attr("id",t);return e};t._additionalClasses=function(e,t){if(t){"string"!=typeof t&&(t=t.join(" "));e.addClass(t)}return e};t.getName=function(e){return _(e).data("name")};t.getText=function(e){return _(e).text()};t.getIdentifier=function(e){return _(e).data("identifier")};t.isVisible=function(e){return _(e).is(":visible")};t.isEnabled=function(e){return!("true"===_(e).attr("aria-disabled"))};t.render=function(e){var t=_("<button />");e=e||{};t.addClass("aui-button "+this.AP_BUTTON_CLASS);t.text(e.text);t.data(e.data);t.data({name:e.name||e.identifier,identifier:e.identifier||Q.randomIdentifier(),immutable:e.immutable||!1});this._additionalClasses(t,e.additionalClasses);this.setType(t,e.type);this.setDisabled(t,e.disabled||!1);this._setId(t,e.id);return t};return e}(),Oi=new ki;_((function(){_("body").on("click","."+Oi.AP_BUTTON_CLASS,(function(e){var t=_(e.target).closest("."+Oi.AP_BUTTON_CLASS);"true"!==t.attr("aria-disabled")&&_i(t)}))}));v.register("button-toggle",(function(e){Oi.setDisabled(e.$el,e.disabled)}));v.register("button-toggle-visibility",(function(e){Oi.setHidden(e.$el,e.hidden)}));var Si=["ap-iframe-container"],Ai=new(function(){function e(){}var t=e.prototype;t.createExtension=function(e,t){var n=this._renderContainer();t&&!1===t.loadingIndicator||n.append(this._renderLoadingIndicator());mi.simpleXdmExtension(e,n);return n};t._renderContainer=function(e){var t=_("<div />").attr(e||{});t.addClass(Si.join(" "));return t};t._renderLoadingIndicator=function(){return k.render()};return e}());v.register("iframe-create",(function(e){var t="embedded-"+e.extension.id;e.extension.$el.parents(".ap-iframe-container").attr("id",t)}));function Ci(e){return Ai.createExtension(e)}var Ii=function(e,t){var n={};if(t){n.methods=t;n.name=e}else n.methods=e;v.dispatch("module-define-custom",n)},Li=function(e,t){v.dispatch("analytics-deprecated-method-used",{methodUsed:e,extension:t})},Ti=function(e){v.dispatch("iframe-bridge-start",{extension:e})},Pi=function(e,t){v.dispatch("analytics-external-event-track",{eventName:e,values:t})},Di=function(e,t){v.dispatch("analytics-content-resolver-track",{success:e,extra:t})},Mi=function(e,t){e&&Object.getOwnPropertyNames(e).length>0&&v.dispatch("analytics-iframe-performance",{metrics:e,extension:t})},ji=function(e,t){e&&Object.keys(e).length>0&&v.dispatch("analytics-web-vitals",{metrics:e,extension:t})},Fi=function(e){v.dispatch("analytics-track-iframe-clicked",e)};function Vi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ni(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ri(e){var t=e?e.match(/ap-plugin-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}function Gi(e){var t=e?e.match(/ap-module-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}function Ui(e){return Ri(e)+"__"+Gi(e)}function Bi(e,t,n){var i=e+"Modules";if(window._AP&&window._AP[i]&&window._AP[i][t]&&window._AP[i][t][n])return U.extend({},window._AP[i][t][n].options)}function zi(e,t){var n=Ri(t),i=function(e){var t=e?e.match(/ap-target-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}(t);return Bi(e,n,i)}function Ki(e,t,n){var i,r=n||e.attr("href"),o={};r||(r=e.find("a").attr("href"));if(r){var a=r.indexOf("#");if(a>=0){var s=r.substring(a+1);try{i=JSON.parse(decodeURI(s))}catch(e){console.error("ACJS: cannot decode webitem anchor")}i&&window._AP&&window._AP._convertConnectOptions?o=window._AP._convertConnectOptions(i):console.error("ACJS: cannot convert webitem url to connect iframe options")}else{var u=Ui(t),l=$i(t)?"inlineDialog":"dialog",c=zi(l,t);!c&&window._AP&&window._AP[l+"Options"]&&(c=U.extend({},window._AP[l+"Options"][u])||{});if(!c){c={};console.warn("no webitem "+l+"Options for "+u)}c.productContext=c.productContext||{};var d=ue.parse(ue.extract(r));U.extend(c.productContext,d);o={addon_key:Ri(t),key:Gi(t),options:c}}}return o}function $i(e){return!!e&&e.includes("ap-inline-dialog")}function Ji(e,t){for(var n=[],i=e,r=0;i&&i!==document.body&&r++<1e3;){for(var o,a=Vi(t);!(o=a()).done;){var s=o.value,u=i.getAttribute(s);u&&n.push(u)}i=i.parentElement}return n}var Wi={sanitizeTriggers:function(e){var t;Array.isArray(e)?t=e.join(" "):"string"==typeof e&&(t=e.trim());return t},uniqueId:function(){return"webitem-"+Math.floor(1e9*Math.random()).toString(16)},getExtensionKey:Ri,getKey:Gi,getOptionsForWebItem:function(e,t,n){var i=Ui(t),r=$i(t)?"inlineDialog":"dialog",o=zi(r,t);!o&&window._AP&&window._AP[r+"Options"]&&(o=U.extend({},window._AP[r+"Options"][i])||{});if(!o){o={};console.warn("no webitem "+r+"Options for "+i)}o.productContext=o.productContext||{};o.structuredContext=o.structuredContext||{};var a=Ki(e,t,n);if(a&&a.options){U.extend(o.productContext,a.options.productContext);U.extend(o.structuredContext,a.options.structuredContext);o.contextJwt=a.options.contextJwt}return o},getModuleOptionsByAddonAndModuleKey:Bi,getConfigFromTarget:Ki},qi=new function(){var e=this;this._providers={};this.registerProvider=function(t,n){e._providers[t]=n};this.getProvider=function(t){return e._providers[t]}},Hi=new(function(){function e(){this.moduleNamesToModules=new Map}e.prototype.registerModule=function(e,t){var n=e.getModuleRegistrationName();this.moduleNamesToModules.set(n,e)};e.prototype.getModuleByName=function(e){return this.moduleNamesToModules.get(e)};e.prototype.getProviderByModuleName=function(e){var t=this.moduleNamesToModules.get(e);return t&&t.isEnabled()?t.getProvider():void 0};return e}()),Yi=function(e){var t;if(ir.getWebItemsBySelector(e.selector))return!1;t=ir.setWebItem(e);v.dispatch("webitem-added",{webitem:t})},Xi=function(e,t){var n=e?"inline-dialog":"dialog";v.dispatch("webitem-invoked:"+n,t)},Qi=new WeakSet,Zi=function(){function e(){this._webitems={};this._contentResolver=function(){}}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.requestContent=function(e){if(e.addon_key&&e.key)return this._contentResolver.call(null,U.extend({classifier:"json"},e))};t.getWebItemsBySelector=function(e){var t,n=this;Object.getOwnPropertyNames(this._webitems).some((function(i){var r=n._webitems[i];if(r.selector&&r.selector.trim()===e.trim()){t=r;return!0}return!1}));return t};t.setWebItem=function(e){return this._webitems[e.name]={name:e.name,selector:e.selector,triggers:e.triggers}};t._removeTriggers=function(e){var t=this,n=Wi.sanitizeTriggers(e.triggers);_((function(){_("body").off(n,e.selector,t._webitems[e.name]._on)}));delete this._webitems[e.name]._on};t._addTriggers=function(e){var t=Wi.sanitizeTriggers(e.triggers);e._on=function(t){if(!t.defaultPrevented){var n=_(t.target).closest(e.selector);if(!n.hasClass("ap-dialog-ignore")){t.preventDefault();nr(n,t.type)}}};_((function(){var n=function(n){if(!Qi.has(n)){Qi.add(n);_(n).on(t,e._on)}};document.querySelectorAll(e.selector).forEach((function(e){n(e)}));new MutationObserver((function(t,i){t.forEach((function(t){"childList"===t.type&&t.addedNodes.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&(t.matches(e.selector)?n(t):t.querySelectorAll(e.selector).forEach((function(e){n(e)})))}))}))})).observe(document.body,{childList:!0,subtree:!0});_("head").append('<style type="text/css">'+e.selector+".ap-link-webitem {pointer-events: auto;cursor: pointer;}</style>")}))};return e}();function er(e,t,n,i){i=i||"click";var r=_(e);tr(t=t||r.attr("class"))&&("mouseenter"!==i||$i(t))&&nr(r,i,t,n,!0)}function tr(e){return function(e){return!!e&&e.includes("ap-dialog")}(e)||$i(e)}function nr(e,t,n,i,r){n=n||e.attr("class");r=r||!1;var o=Wi.getConfigFromTarget(e,n,i),a=o&&o.url?o.url:void 0,s={addon_key:Wi.getExtensionKey(n),key:Wi.getKey(n),options:Wi.getOptionsForWebItem(e,n,i),url:a};if("com.addonengine.analytics"!==s.addon_key||or.isModuleDefined("analytics")){var u=$i(n);r||v.dispatch("analytics-legacy-dialog-opened",{extension:s,eventType:t,parentIds:Ji(e.get(0),["data-testid","data-component-selector","data-fullscreen-id"])});Xi(u,{$target:e,eventType:t,extension:s})}else console.log("ACJS-1164 Dropping event "+t+" for plugin "+s.addon_key+" until AP.analytics loads...")}var ir=new Zi;v.register("webitem-added",(function(e){ir._addTriggers(e.webitem)}));v.register("content-resolver-register-by-extension",(function(e){ir.setContentResolver(e.callback)}));document.addEventListener("aui-responsive-menu-item-created",(function(e){var t=e.detail.originalItem.querySelector('a[class*="ap-"]');if(t){var n=e.detail.newItem.querySelector("a");[].slice.call(t.classList).forEach((function(e){/^ap-/.test(e)&&n.classList.add(e)}))}}));var rr=function(){function e(){var e=this;this.targetSpecNoDialogs=F;this.triggerWebItem=er;this.isDialogWebItem=tr;this.create=function(e){return Ci(yi.extensionConfigSanitizer(e))};this.dialog={create:function(e,t){var n=Wi.getModuleOptionsByAddonAndModuleKey("dialog",e.addon_key,e.key),i=U.extend({},n||{},t);z(e,i)},close:function(t,n){var i=e.getFrameworkAdaptor().getProviderByModuleName("dialog");if(i){re.assertActiveDialogOrThrow(i,t);V("dialog.close",{addon_key:t},n);i.close()}else K()}};this.registerContentResolver={resolveByExtension:function(t){e._contentResolver=t;Te({callback:t})}};this.getContentResolver=function(){return e._contentResolver};this.registerProvider=function(e,t){qi.registerProvider(e,t)};this.getProvider=function(e){return qi.getProvider(e)};this.frameworkAdaptor=Hi}var t=e.prototype;t.createExtension=function(e){e.options=e.options||{};e.options.noDom=!0;var t=yi.createSimpleXdmExtension(e);Ti(t.extension);return t};t.registerExistingExtension=function(e,t){return M.registerExistingExtension(e,t)};t.setFrameworkAdaptor=function(e){this.frameworkAdaptor=e};t.getFrameworkAdaptor=function(){return this.frameworkAdaptor};t._cleanExtension=function(e){return U.pick(e,["id","addon_key","key","options","url"])};t.onIframeEstablished=function(e){e._wrapper=function(t){e.call({},{$el:t.$el,extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:iframe-bridge-established",e._wrapper)};t.offIframeEstablished=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-bridge-established",e._wrapper)};t.onIframeUnload=function(e){var t=this;v.register("after:iframe-unload",(function(n){e.call({},{$el:n.$el,extension:t._cleanExtension(n.extension)})}))};t.onPublicEventDispatched=function(e){e._wrapper=function(t){e.call({},{type:t.type,event:t.event,extension:this._cleanExtension(t.sender)})}.bind(this);v.register("after:event-public-dispatch",e._wrapper)};t.offPublicEventDispatched=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:event-public-dispatch",e._wrapper)};t.onKeyEvent=function(e,t,n,i){W({extension_id:e,key:t,modifiers:n,callback:i})};t.offKeyEvent=function(e,t,n,i){q({extension_id:e,key:t,modifiers:n,callback:i})};t.onFrameClick=function(e){if("function"!=typeof e)throw new Error("handleIframeClick must be a function");Y(e)};t.offFrameClick=function(){X()};t.destroy=function(e){oe.notifyIframeDestroyed({id:e})};t.defineModule=function(e,t){Ii(e,t)};t.isModuleDefined=function(e){return M.isModuleDefined(e)};t.broadcastEvent=function(e,t,n){V(e,t,n)};t.getExtensions=function(e){return M.getExtensions(e)};t.trackDeprecatedMethodUsed=function(e,t){Li(e,t)};t.trackAnalyticsEvent=function(e,t){Pi(e,t)};t.trackContentResolverEvent=function(e,t){Di(e,t)};t.notifyContentResolverFailed=function(e){v.dispatch("notify-content-resolver-failed",e)};t.setJwtClockSkew=function(e){De(e)};t.isJwtExpired=function(e,t){return t?Ce.isJwtExpired(e):Le.isJwtExpired(e)};t.hasJwt=function(e){return Le.hasJwt(e)};t.getBooleanFeatureFlag=function(e){return ri(e)};t.setExtensionConfigurationOptions=function(e,t){je.set(e,t)};t.getExtensionConfigurationOption=function(e){return je.get(e)};t.onIframeTimeout=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:iframe-bridge-timeout",e._wrapper)};t.offIframeTimeout=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-bridge-timeout",e._wrapper)};t.onIframePerformanceTelemetry=function(e){e._wrapper=function(t){e.call({},{metrics:t.metrics,extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:analytics-iframe-performance",e._wrapper)};t.offIframePerformanceTelemetry=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:analytics-iframe-performance",e._wrapper)};t.onIframeVisible=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t)})}.bind(this);v.register("after:iframe-visible",e._wrapper)};t.offIframeVisible=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-visible",e._wrapper)};t.onContentResolverEvent=function(e){e._wrapper=function(t){e.call({},t)}.bind(this);v.register("after:analytics-content-resolver-track",e._wrapper)};t.offContentResolverEvent=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:analytics-content-resolver-track",e._wrapper)};t.onForwardAnalyticsEvent=function(e){e._wrapper=function(t,n){e.call({},t,n)}.bind(this);v.register("after:analytics-forward-event",e._wrapper)};return e}(),or=new rr,ar="ap-dialog-",sr="ap-aui-dialog2",ur=new RegExp("^ap-dialog-[0-9A-Za-z]+$"),lr=["small","medium","large","xlarge","fullscreen","maximum"],cr="ap-aui-dialog-button",dr="aui-dialog2-footer-actions";function fr(){var e=AJS.LayerManager.global.getTopLayer();if(e&&ur.test(e.attr("id"))){var t=AJS.dialog2(e);t._id=t.$el.attr("id").replace(ar,"");return t}}function pr(e){var t=e.find(".header-control-panel");t.length||(t=e.find(".aui-dialog2-footer-actions"));return t}function hr(e,t){return pr(t).find(".aui-button").filter((function(){return Oi.getIdentifier(this)===e}))}var gr=function(){function e(){}var t=e.prototype;t._renderHeaderCloseBtn=function(){var e=_("<a />").addClass("aui-dialog2-header-close"),t=_("<span />").addClass("aui-icon aui-icon-small aui-iconfont-close-dialog").text("Close");e.append(t);return e};t._renderFullScreenHeader=function(e,t){var n=_("<div />").addClass("header-title-container aui-item expanded"),i=_("<div />").append(_("<span />").addClass("header-title").text(t.header||""));n.append(i);e.append(n).append(this._renderHeaderActions(t.actions,t.extension));return e};t._renderHeader=function(e){var t=_("<header />").addClass("aui-dialog2-header");if("fullscreen"===e.size)return this._renderFullScreenHeader(t,e);if(e.header){var n=_("<h2 />").addClass("aui-dialog2-header-main").text(e.header);t.append(n)}t.append(this._renderHeaderCloseBtn());return t};t._renderHeaderActions=function(e,t){var n=_("<div />").addClass("aui-item header-control-panel");e[0].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-success"];e[1].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-close-dialog"];this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderContent=function(e){var t=_("<div />").addClass("aui-dialog2-content");e&&t.append(e);return t};t._renderFooter=function(e){var t=_("<footer />").addClass("aui-dialog2-footer");if("fullscreen"!==e.size){var n=this._renderFooterActions(e.actions,e.extension);t.append(n)}if(e.hint){var i=_("<div />").addClass("aui-dialog2-footer-hint").text(e.hint);t.append(i)}return t};t._renderActionButtons=function(e,t){var n=this,i=[];[].concat(e).forEach((function(e){i.push(n._renderDialogButton({text:e.text,name:e.name,type:e.type,additionalClasses:e.additionalClasses,custom:e.custom||!1,identifier:e.identifier,immutable:e.immutable,disabled:e.disabled||!1},t))}));return i};t._renderFooterActions=function(e,t){var n=_("<div />").addClass(dr);this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderDialogButton=function(e,t){e.additionalClasses=e.additionalClasses||[];e.additionalClasses.push(cr);e.custom&&e.additionalClasses.push("ap-dialog-custom-button");var n=Oi.render(e);n.extension=t;return n};t.render=function(e){var t=U.extend({},e),n=re.sanitizeOptions(e),i=_("<section />").attr({role:"dialog",id:ar+n.id});i.attr("data-aui-modal","true");i.data({"aui-remove-on-hide":!0,extension:n.extension});i.addClass("aui-layer aui-dialog2 "+sr);lr.indexOf(n.size)>=0&&i.addClass("aui-dialog2-"+n.size);if("fullscreen"===n.size||"maximum"===n.size){n.chrome&&i.addClass("ap-header-controls");i.addClass("aui-dialog2-maximum")}i.append(this._renderContent(n.$content));if(n.chrome){i.prepend(this._renderHeader({header:n.header,actions:n.actions,size:n.size}));i.append(this._renderFooter({extension:n.extension,actions:n.actions,hint:n.hint,size:n.size}))}else i.addClass("aui-dialog2-chromeless");var r=AJS.dialog2(i);r._id=n.id;"fullscreen"===n.size&&(n.height=n.width="100%");n.size&&"fullscreen"!==n.size||AJS.layer(i).changeSize(n.width,n.height);n.onHide&&r.on("hide",n.onHide);r.show();r.$el.data("extension",n.extension);r.$el.data("originalOptions",t);return i};t.setIframeDimensions=function(e){mi.resize("100%","100%",e)};t.getActive=function(){return fr()};t.buttonIsEnabled=function(e){var t=fr();if(t){var n=hr(e,t.$el);return Oi.isEnabled(n)}};t.buttonIsVisible=function(e){var t=fr();if(t){var n=hr(e,t.$el);return Oi.isVisible(n)}};t.getByExtension=function(e){var t;if("function"==typeof e)t=e;else{var n=Object.getOwnPropertyNames(e);t=function(t){var i=_(t).data("extension");return n.every((function(t){return i[t]===e[t]}))}}return _("."+sr).toArray().filter(t).map((function(e){return AJS.dialog2(e)}))};t.addButton=function(e,t){t.custom=!0;var n=this._renderDialogButton(t,e),i=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;pr(i).append(n);return i};t.renderErrorState=function(e){var t=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;if(!t.hasClass("aui-dialog2-fullscreen")){if(t.hasClass("aui-dialog2-maximum")){t.removeClass("aui-dialog2-maximum");t.addClass("aui-dialog2-xlarge")}t.removeClass("aui-dialog2-chromeless");var n=t.find(".aui-dialog2-footer-actions");if(!(t.find("#dialog-error-close-btn").length>0)){var i={name:"close",id:"dialog-error-close-btn",text:"Close",type:"primary",disabled:!1};if(n.length){var r=this._renderDialogButton(i,e);n.append(r)}else t.append(this._renderFooter({extension:e,actions:[i]}))}}};return e}(),vr=new gr;v.register("iframe-bridge-established",(function(e){if(e.extension.options.isDialog){var t,n=or.getFrameworkAdaptor().getProviderByModuleName("dialog");if(n){t=n.close;n.setButtonDisabled("submit",!1)}else{J.toggleButton({identifier:"submit",enabled:!0});t=function(){J.close({dialog:fr(),extension:e.extension})}}if(!e.extension.options.preventDialogCloseOnEscape){W({extension_id:e.extension.id,key:27,callback:t});v.registerOnce("dialog-close",(function(t){q({extension_id:e.extension.id,key:27})}))}}}));v.register("dialog-close-active",(function(e){var t=fr();t&&J.close({customData:e.customData,dialog:t,extension:e.extension})}));v.register("dialog-close",(function(e){e.dialog&&e.dialog.hide()}));v.register("dialog-button-toggle",(function(e){var t=fr();if(t){var n=hr(e.identifier,t.$el);bi(n,!e.enabled)}}));v.register("dialog-button-toggle-visibility",(function(e){var t=fr();if(t){var n=hr(e.identifier,t.$el);wi(n,e.hidden)}}));v.register("button-clicked",(function(e){var t=e.$el;if(t.hasClass(cr)){var n=t.parents("."+sr),i=n.find("iframe");i.length&&i[0].bridgeEstablished?J.clickButton(Oi.getIdentifier(t),t,n.data("extension")):J.close({dialog:fr(),extension:t.extension})}}));if(_.fn){v.register("iframe-create",(function(e){e.extension.options&&e.extension.options.isDialog&&vr.setIframeDimensions(e.extension.$el)}));v.register("dialog-button-add",(function(e){vr.addButton(e.extension,e.button)}));v.register("host-window-resize",U.debounce((function(){_("."+sr).each((function(e,t){var n=_(t),i=re.sanitizeOptions(n.data("originalOptions"));t.style.width=i.width;t.style.height=i.height}))}),100))}H({keyCode:27,callback:function(){J.closeActive({customData:{},extension:null})}});function yr(t){var n;if(null!=t&&t.options&&null!=(n=AJS)&&null!=(n=n.Meta)&&n.get){var i=e({},t.options.productContext||{});AJS.Meta.get("space-key")&&(i["an.spaceKey"]=AJS.Meta.get("space-key"));return e({},t,{options:e({},t.options,{productContext:i})})}return t}var mr=new(function(){function e(){}var t=e.prototype;t.render=function(e,t){e.options=e.options||{};t=t||{};e.options.isDialog=!0;e.options.dialogId=t.id;e.options.callbackExtensionId=e.callback_extension_id;e.options.preventDialogCloseOnEscape=!1===t.closeOnEscape;e.options.hostFrameOffset=t.hostFrameOffset;e.options.hideIframeUntilLoad=!0;var n=Ai.createExtension(e);return vr.render({extension:e,$content:n,chrome:t.chrome,width:t.width,height:t.height,size:t.size,header:t.header,hint:t.hint,submitText:t.submitText,cancelText:t.cancelText,buttons:t.buttons,onHide:t.onHide})};t.renderErrorState=function(e){vr.renderErrorState(e)};t.getActiveDialog=function(){return vr.getActive()};t.buttonIsEnabled=function(e){return vr.buttonIsEnabled(e)};t.buttonIsVisible=function(e){return vr.buttonIsVisible(e)};t.getByExtension=function(e){"string"==typeof e&&(e={id:e});return vr.getByExtension(e)};return e}());v.register("dialog-extension-open",(function(e){var t=yr(e.extension),n=re.sanitizeOptions(e.options),i=or.getFrameworkAdaptor().getProviderByModuleName("dialog");if(i){var r=function(e){var n=t.key,i=t.addon_key,r={button:{identifier:e.identifier,name:e.identifier,text:e.text}};["submit","cancel"].indexOf(e.identifier)>=0&&V("dialog."+e.identifier,{addon_key:i,key:n},r);V("dialog.button.click",{addon_key:i,key:n},r)};t.options.preventDialogCloseOnEscape=!1===n.closeOnEscape;n.actions.map((function(e){return e.onClick=r.bind(null,e)}));i.create(n,t)}else mr.render(t,e.options)}));v.register("notify-content-resolver-failed",(function(e){mr.renderErrorState(e)}));var _r={};v.register("dialog-close",(function(e){if(e.dialog&&e.extension){var t={addon_key:e.extension.addon_key,id:e.extension.options.callbackExtensionId};V("dialog.close",t,e.customData)}}));v.register("dialog-button-click",(function(e){var t={button:{name:Oi.getName(e.$el),identifier:Oi.getIdentifier(e.$el),text:Oi.getText(e.$el)}},n={addon_key:e.extension.addon_key,key:e.extension.key};n.id=e.extension.id;e.$el.hasClass("ap-dialog-custom-button")||V("dialog."+t.button.name,n,t);V("dialog.button.click",n,t)}));var br=function(){function e(e,t){t=U.last(arguments);var n=or.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){re.assertActiveDialogOrThrow(i,t._context.extension.addon_key);this.name=e;this.identifier=e}else{if(!mr.getActiveDialog())throw new Error("Failed to find an active dialog.");this.name=e;this.identifier=e;this.enabled=mr.buttonIsEnabled(e);this.hidden=!mr.buttonIsVisible(e)}}var t=e.prototype;t.enable=function(){this.setState({enabled:!0})};t.disable=function(){this.setState({enabled:!1})};t.isEnabled=function(e){e=U.last(arguments);var t=or.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?!n.isButtonDisabled(this.identifier):this.enabled)};t.toggle=function(){var e=or.getFrameworkAdaptor().getProviderByModuleName("dialog");e?e.toggleButton(this.identifier):this.setState({enabled:!this.enabled})};t.setState=function(e){var t=or.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonDisabled(this.identifier,!e.enabled);else{this.enabled=e.enabled;J.toggleButton({identifier:this.identifier,enabled:this.enabled})}};t.trigger=function(e){e=U.last(arguments);this.enabled&&J.dialogMessage({name:this.name,extension:e._context.extension})};t.isHidden=function(e){e=U.last(arguments);var t=or.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?n.isButtonHidden(this.identifier):this.hidden)};t.hide=function(){this.setHidden(!0)};t.show=function(){this.setHidden(!1)};t.setHidden=function(e){var t=or.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonHidden(this.identifier,e);else{this.hidden=e;J.toggleButtonVisibility({identifier:this.identifier,hidden:this.hidden})}};return e}();function wr(e){return _r[e.extension.options.dialogId]}var xr={create:{constructor:function(e,t){var n=(t=U.last(arguments))._id,i=t._context.extension,r={addon_key:i.addon_key,key:e.key,options:U.pick(i.options,["customData","productContext"]),callback_extension_id:i.id};r.options.customData=e.customData;var o=re.moduleOptionsFromGlobal(r.addon_key,r.key);"number"==typeof(o||{}).hostFrameOffset&&(r.options.hostFrameOffset=o.hostFrameOffset);(e=U.extend({},o||{},e)).id=n;re.trackMultipleDialogOpening(r,e);z(r,e);this.customData=e.customData;_r[n]=this}},close:function(e,t){t=U.last(arguments);var n=or.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){re.assertActiveDialogOrThrow(i,t._context.extension.addon_key);V("dialog.close",{addon_key:t._context.extension.addon_key},e);i.close()}else{var r;r=t._context.extension.options.isDialog?mr.getByExtension(t._context.extension.id)[0]:mr.getActiveDialog();J.close({customData:e,dialog:r,extension:t._context.extension})}},getCustomData:function(e){var t=wr((e=U.last(arguments))._context);e(t?t.customData:void 0)},getButton:{constructor:br,enable:br.prototype.enable,disable:br.prototype.disable,toggle:br.prototype.toggle,isEnabled:br.prototype.isEnabled,trigger:br.prototype.trigger,hide:br.prototype.hide,show:br.prototype.show,isHidden:br.prototype.isHidden},createButton:{constructor:function(e,t){t=U.last(arguments);var n=or.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){re.assertActiveDialogOrThrow(i,t._context.extension.addon_key);i.createButton({identifier:e.identifier,text:e.text,hidden:!1,disabled:e.disabled||!1,onClick:function(){V("dialog.button.click",{addon_key:t._context.extension.addon_key,key:t._context.extension.key},{button:{identifier:e.identifier,text:e.text}})}})}else $({identifier:e.identifier,text:e.text},t._context.extension)}}};v.register("iframe-resize",(function(e){mi.resize(e.width,e.height,e.$el)}));v.register("iframe-size-to-parent",(function(e){var t,n=U.getIframeByExtensionId(e.extensionId);t=_(window).height()-n.offset().top-1+"px";n.get(0).name.length>0&&"jiraProjectPages"===JSON.parse(n.get(0).name).options.moduleType&&(t="100%");v.dispatch("iframe-resize",{width:"100%",height:t,$el:n})}));v.register("hide-footer",(function(e){e&&_("#footer").css({display:"none"})}));window.addEventListener("resize",(function(e){v.dispatch("host-window-resize",e)}),!0);var Er=function(e,t,n){var i;i=n.extension_id?U.getIframeByExtensionId(n.extension_id):n;v.dispatch("iframe-resize",{width:e,height:t,$el:i,extension:n.extension})},kr=function(e,t){v.dispatch("iframe-size-to-parent",{hideFooter:t,extensionId:e})},Or=function(e){v.dispatch("hide-footer",e)},Sr=U.debounce,Ar={},Cr=[],Ir={},Lr={getLocation:function(e){e=U.last(arguments);var t=qi.getProvider("get-location");e("function"==typeof t?t():window.location.href)},resize:function(e,t,n){n=U.last(arguments);var i=qi.getProvider("addon");if(i)i.resize(e,t,n._context);else{var r=n._context.extension.id,o=n._context.extension.options;if(-1!==Cr.indexOf(r)||o&&o.isDialog)return!1;Ar[r]||(Ar[r]=Sr((function(e,t,n){Er(e,t,n._context)}),50));Ar[r](e,t,n)}return!0},sizeToParent:Sr((function(e,t){t=U.last(arguments);var n=qi.getProvider("addon");if(n)n.sizeToParent(e,t._context);else if(t._context.extension.options.isFullPage){U.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page");U.getIframeByExtensionId(t._context.extension_id).addClass("sized-to-parent");kr(t._context.extension_id,e);Ir[t._context.extension_id]={hideFooter:e}}else U.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page-fail")})),hideFooter:function(e){e&&Or(e)}},Tr=function(e){delete Ar[e];delete Ir[e];-1!==Cr.indexOf(e)&&Cr.splice(Cr.indexOf(e),1)};v.register("host-window-resize",(function(e){Object.getOwnPropertyNames(Ir).forEach((function(e){kr(e,Ir[e].hideFooter)}))}));v.register("after:iframe-unload",(function(e){Tr(e.extension.id)}));v.register("after:iframe-destroyed",(function(e){Tr(e.extension.extension.id)}));v.register("before:iframe-size-to-parent",(function(e){-1===Cr.indexOf(e.extensionId)&&Cr.push(e.extensionId)}));var Pr=function(e){v.dispatch("inline-dialog-refresh",{$el:e})},Dr=function(){v.dispatch("inline-dialog-close",{})},Mr=function(e){v.dispatch("inline-dialog-opened",{$el:e.$el,trigger:e.trigger,extension:e.extension})},jr={hide:function(e){e=U.last(arguments);var t=or.getFrameworkAdaptor(),n=t.getProviderByModuleName("inlineDialog");n?n.hide(e._context):Dr()}},Fr="ac-message-container",Vr=["generic","error","warning","success","info","hint"],Nr="ap-message-",Rr=new RegExp("^ap-message-[0-9A-fa-f]+$"),Gr={};function Ur(e){return Rr.test(e)}var Br=!1;function zr(e,t,n,i){if(!Br){_(document).on("aui-message-close",(function(e,t){var n=t.attr("id").replace(Nr,"");if(Gr[n]){_.isFunction(Gr[n].onCloseTrigger)&&Gr[n].onCloseTrigger();Gr[n]._destroy()}}));Br=!0}var r=function(){var e=_("#"+Fr);e.length<1&&(e=_('<div id="'+Fr+'" />').appendTo("body"));return e}();i=function(e){var t={};"object"==typeof e&&["closeable","fadeout","delay","duration","id"].forEach((function(n){n in e&&(t[n]=e[n])}));return t}(i);_.extend(i,{title:t,body:AJS.escapeHtml(n)});if(Vr.indexOf(e)<0)throw"Invalid message type. Must be: "+Vr.join(", ");if(Ur(i.id)){AJS.messages[e](r,i);r.css("margin-left","-"+r.innerWidth()/2+"px")}}function Kr(e,t,n,i,r){var o="AP.messages."+e;console.warn("DEPRECATED API - AP.messages."+e+" has been deprecated since ACJS 5.0 and will be removed in a future release. Use AP.flag.create instead.");Li(o,r._context.extension);var a=or.getFrameworkAdaptor().getProviderByModuleName("messages");if(a){var s=e,u=a[s];u||(a[s]=a.generic);u(t,n,i)}else zr(e,t,n,i)}function $r(e){return{constructor:function(t,n,i,r){var o=(r=U.last(arguments))._id;"string"!=typeof t&&(t="");"string"!=typeof n&&(n="");"object"!=typeof i&&(i={});i.id=Nr+o;Kr(e,t,n,i,r);Gr[o]=this}}}var Jr={clear:function(e){var t=Nr+e._id;if(Ur(t)){var n=or.getFrameworkAdaptor().getProviderByModuleName("messages");n?n.clear(t):_("#"+t).closeMessage()}},onClose:function(e,t){t=U.last(arguments);var n=e._id,i=or.getFrameworkAdaptor(),r=i.getProviderByModuleName("messages");if(r){var o=Nr+e._id;r.onClose(o,t)}else Gr[n]&&(Gr[n].onCloseTrigger=t)},generic:$r("generic"),error:$r("error"),warning:$r("warning"),success:$r("success"),info:$r("info"),hint:$r("hint")},Wr={actionInvoked:function(e,t){v.dispatch("flag-action-invoked",{id:t,actionId:e})},open:function(e){v.dispatch("flag-open",{id:e})},close:function(e){v.dispatch("flag-close",{id:e})},closed:function(e){v.dispatch("flag-closed",{id:e})}},qr="ap-flag-",Hr="ac-flag-actions",Yr=function(){function e(){}var t=e.prototype;t.cleanKey=function(e){var t=new RegExp("^ap-flag-(.+)$"),n=e.match(t);return n&&n[1]?n[1]:null};t._toHtmlString=function(e){return"string"===_.type(e)?e:"object"===_.type(e)&&e instanceof _?e.html():void 0};t._renderBody=function(e){e=this._toHtmlString(e);var t=_("<div />").html(e);_("<p />").addClass(Hr).appendTo(t);return t.html()};t._renderActions=function(e,t,n){var i,r=e.find(".ac-flag-actions");n=n||{};Object.getOwnPropertyNames(n).forEach((function(e){i=_("<a />").attr("href","#").data({key:e,flag_id:t}).text(n[e]);r.append(i)}),this);return e};t.render=function(e){!function(){if(Qr)return;_(document).on("aui-flag-close",(function(e){var t=e.target.id,n=Xr.cleanKey(t);Wr.closed(n)}));_(document).on("click",".ac-flag-actions",(function(e){var t=_(e.target),n=t.data("key"),i=t.data("flag_id");Wr.actionInvoked(n,i)}));Qr=!0}();var t=qr+e.id,n=AJS.flag({type:e.type,title:e.title,body:this._renderBody(e.body),close:e.close});n.setAttribute("id",t);var i=_(n);this._renderActions(i,e.id,e.actions);i.addClass("ac-aui-flag");i.close=n.close;return i};t.close=function(e){document.getElementById(e).close()};return e}(),Xr=new Yr,Qr=!1;v.register("flag-close",(function(e){Xr.close(e.id)}));var Zr={},eo=function(){function e(e,t){t=U.last(arguments);if("object"==typeof e){var n=t._id,i=or.getFrameworkAdaptor(),r=i.getProviderByModuleName("flag");if(r){var o=[];"object"==typeof e.actions&&(o=Object.getOwnPropertyNames(e.actions).map((function(t){return{actionKey:t,actionText:e.actions[t],executeAction:Wr.actionInvoked.bind(null,t,n)}})));var a=e.type||"info",s={id:n,title:e.title,body:e.body,actions:o,onClose:Wr.closed,close:e.close,type:a.toLowerCase()};this.flag=r.create(s);var u=qi.getProvider("addon");u&&u.registerUnmountCallback&&u.registerUnmountCallback(this.close.bind(this),t._context)}else{this.flag=Xr.render({type:e.type,title:e.title,body:AJS.escapeHtml(e.body),actions:e.actions,close:e.close,id:n});Wr.open(this.flag.attr("id"))}this.onTriggers={};this.extension=t._context.extension;Zr[t._id]=this;t.call(null,t._id)}}e.prototype.close=function(){this.flag.close()};return e}();function to(e,t,n){if(Zr[e]){var i=Zr[e].extension;(n=n||{}).flagIdentifier=e;var r={id:i.id};V(t,r,n)}}v.register("flag-closed",(function(e){to(e.id,"flag.close");Zr[e.id]&&delete Zr[e.id]}));v.register("flag-action-invoked",(function(e){to(e.id,"flag.action",{actionIdentifier:e.actionId})}));var no,io,ro={create:{constructor:eo,close:eo.prototype.close}},oo={trackDeprecatedMethodUsed:function(e,t){t=U.last(arguments);Li(e,t._context.extension)},trackIframePerformanceMetrics:function(e,t){t=U.last(arguments);Mi(e,t._context.extension)},trackWebVitals:function(e,t){t=U.last(arguments);ji(e,t._context.extension)}};v.register("iframe-bridge-established",(function(e){if(e.extension.options.isFullPage){window.addEventListener("scroll",so);no=e.extension.id}}));v.register("iframe-destroyed",(function(e){ao()}));v.register("iframe-unload",(function(e){ao()}));function ao(){window.removeEventListener("scroll",so);no=void 0;io=void 0}function so(){var e=document.documentElement.scrollHeight,t=window.innerHeight,n=.1*e;window.pageYOffset<=n?uo("nearTop"):t+window.pageYOffset+n>=e?uo("nearBottom"):io=void 0}function uo(e){if(io!==e){V("scroll."+e,{id:no},{});io=e}}var lo={getPosition:function(e){if((e=U.last(arguments))._context.extension.options.isFullPage){var t=U.getIframeByExtensionId(e._context.extension_id),n=t.offset(),i=_(window);e({scrollY:i.scrollTop()-n.top,scrollX:i.scrollLeft()-n.left,width:window.innerWidth,height:window.innerHeight})}},setVerticalPosition:function(e,t){if((t=U.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=U.getIframeByExtensionId(t._context.extension_id),i=n.offset();"number"==typeof e&&(document.documentElement.scrollTop=i.top+e)}}},co=function(e,t,n){v.dispatch("dropdown-item-selected",{id:e,item:t,extension:n})};function fo(e){return e.map((function(e){if(e.list&&Array.isArray(e.list)){var t={heading:e.heading};t.items=e.list.map((function(e){return function(e){var t={};if("string"==typeof e)t.content=e;else{if(!e.text||"string"!=typeof e.text)throw new Error("Unknown dropdown list item format.");t.content=e.text;"boolean"==typeof e.disabled&&(t.disabled=e.disabled);void 0!==e.itemId&&(t.itemId=e.itemId)}return t}(e)}));return t}}))}var po={create:function(e,t){t=U.last(arguments);if("object"==typeof e){var n=or.getFrameworkAdaptor(),i=n.getProviderByModuleName("dropdown");if(i){var r=fo(e.list),o={dropdownId:e.dropdownId,dropdownGroups:r,dropdownItemNotifier:function(e){co(e.dropdownId,e.item,t._context.extension)}};i.create(o,t._context);return o}}},showAt:function(e,t,n,i){var r=U.last(arguments),o={left:0,top:0},a=document.getElementById(r._context.extension_id);a?o=a.getBoundingClientRect():console.error("ACJS: no iframe found for dropdown");var s=or.getFrameworkAdaptor(),u=s.getProviderByModuleName("dropdown");if(u){var l={dropdownId:e,x:t,y:n,width:i};u.showAt(l,{iframeDimensions:o,onItemSelection:function(e,t){co(e,t,r._context.extension)}})}},hide:function(e){var t=or.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.hide(e)},itemDisable:function(e,t){var n=or.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemDisable(e,t)},itemEnable:function(e,t){var n=or.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemEnable(e,t)}};v.register("dropdown-item-selected",(function(e){V("dropdown-item-selected",{addon_key:e.extension.addon_key,key:e.extension.key},{dropdownId:e.id,item:e.item})}));v.register("iframe-destroyed",(function(e){var t=or.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));v.register("after:iframe-unload",(function(e){var t=or.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));var ho,go,vo,yo,mo,_o={focus:function(){window.document.querySelector("a").focus({preventScroll:!0});window.document.querySelector("a").blur()},getSelectedText:(ho=function(e){e("")},go="AP.host.getSelectedText()",mo=!1,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!mo&&"undefined"!=typeof console&&console.warn){mo=!0;console.warn("DEPRECATED API - "+go+" has been deprecated "+(yo?"since ACJS "+yo:"in ACJS")+" and will be removed in a future release. "+(vo?"Use "+vo+" instead.":"No alternative will be provided."));var i=U.last(t);i&&i._context&&i._context.extension&&oo.trackDeprecatedMethodUsed(go,i)}return ho.apply(void 0,t)})},bo=["light","dark","auto"],wo=["light-increased-contrast","light","light-future","light-brand-refresh","dark","dark-future","dark-increased-contrast","dark-brand-refresh","legacy-light","legacy-dark","spacing","shape","typography-adg3","typography-modernized","typography-refreshed"],xo="data-theme",Eo="data-color-mode",ko="--".concat("ds","-elevation-surface-current"),Oo=["light","dark","spacing","typography","shape"],So="UNSAFE_themeOptions",Ao=function(e){return e.split(" ").map((function(e){return e.split(/:([^]*)/)})).reduce((function(e,t){var n,i,r=ze(t,2),o=r[0],a=r[1];"colorMode"===o&&["light","dark","auto"].includes(a)&&(e[o]=a);(i=o,void 0!==Oo.find((function(e){return e===i})))&&(n=a,void 0!==wo.find((function(e){return e===n})))&&(e[o]=a);if(o===So)try{e.UNSAFE_themeOptions=JSON.parse(a)}catch(e){}return e}),{})};function Co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Lo=function(){if("undefined"==typeof document)return{};var e=document.documentElement,t=e.getAttribute(Eo)||"",n=e.getAttribute(xo)||"";return Io(Io({},Ao(n)),function(e){return void 0!==bo.find((function(t){return t===e}))}(t)&&{colorMode:t})},To=function(){function e(t){Fe(this,e);Ue(this,"legacyObserver",null);this.callback=t;e.callbacks.add(t)}return Ge(e,[{key:"observe",value:function(){if(!e.observer){e.observer=new MutationObserver((function(){var t=Lo();e.callbacks.forEach((function(e){return e(t)}))}));e.observer.observe(document.documentElement,{attributeFilter:[xo,Eo]})}}},{key:"disconnect",value:function(){this.callback&&e.callbacks.delete(this.callback);if(0===e.callbacks.size&&e.observer){e.observer.disconnect();e.observer=null}}}])}();Ue(To,"observer",null);Ue(To,"callbacks",new Set);var Po=function(e){var t=document.getElementById(e);if(t){var n=getComputedStyle(t),i=n.getPropertyValue(ko),r=n.getPropertyValue("--ds-surface-raised"),o=n.getPropertyValue("--ds-surface-overlay");return i===r?"raised":i===o?"overlay":void 0}};var Do={extensionIds:[],themeObserver:new To((function(e){!function(e){var t={};Do.extensionIds.length&&Do.extensionIds.forEach((function(n){var i=Po(n);M.broadcast("theme_changed",{id:n},{newTheme:e,featureFlags:t,surface:i})}))}(e)}))},Mo={initializeTheming:function(){var e=U.last(arguments),t=1!==arguments.length&&arguments[0];if(e&&e._context&&e._context.extension_id){var n=e._context.extension_id;if(n){var i=Lo(),r=Po(n),o={};M.broadcast("theme_initialized",{id:n},{initialTheme:i,featureFlags:o,surface:r,forceNoCleanup:t});if(!Do.extensionIds.includes(n)){Do.extensionIds.push(n);Do.themeObserver.observe(document.documentElement)}}}},_finishedInitTheming:function(){}},jo={setTitle:function(e,t){if((t=U.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=" - "+U.guessProductFromModuleDefined(window.connectHost);document.title=e+n}}},Fo=function(e){v.dispatch("inline-dialog-extension",{$el:e.$el,extension:e.extension})},Vo=new(function(){function e(){}var t=e.prototype;t.resize=function(e){var t=U.stringToDimension(e.width),n=U.stringToDimension(e.height),i=e.$el.find(".contents");if(1===i.length){i.css({width:t,height:n});Pr(e.$el)}};t.refresh=function(e){e.is(":visible")&&e[0].popup.reset()};t._getInlineDialog=function(e){return AJS.InlineDialog(e)};t._renderContainer=function(){return _("<div />").addClass("aui-inline-dialog-contents")};t._displayInlineDialog=function(e){Mr({$el:e.$el,trigger:e.trigger,extension:e.extension})};t.hideInlineDialog=function(e){e.hide()};t.closeInlineDialog=function(){_(".aui-inline-dialog").filter((function(){return _(this).find(".ap-iframe-container").length>0})).hide()};t.render=function(e){var t=this,n=_(document.getElementById("inline-dialog-"+e.id));0!==n.length&&n.remove();var i=AJS.InlineDialog(e.bindTo,e.id,(function(n,i,r){n.append(e.$content);t._displayInlineDialog({extension:e.extension,$el:n,trigger:i});r()}),e.inlineDialogOptions);i.css("z-index",1e3);return i};return e}());v.register("iframe-resize",(function(e){var t=e.$el.parents(".aui-inline-dialog");1===t.length&&Vo.resize({width:e.width,height:e.height,$el:t})}));v.register("inline-dialog-refresh",(function(e){Vo.refresh(e.$el)}));v.register("inline-dialog-hide",(function(e){Vo.hideInlineDialog(e.$el)}));v.register("inline-dialog-close",(function(e){Vo.closeInlineDialog()}));var No="inline-dialog-target-uid",Ro=new(function(){function e(){this._inlineDialogWebItemSpec={name:"inline-dialog",selector:".ap-inline-dialog",triggers:["mouseenter","click"]};this._inlineDialogWebItems={}}var t=e.prototype;t.getWebItem=function(){return this._inlineDialogWebItemSpec};t._createInlineDialog=function(e){return Vo.render({extension:e.extension,id:e.id,bindTo:e.$target,$content:_("<div />"),inlineDialogOptions:e.extension.options})};t.triggered=function(e){var t=e.eventType,n=e.extension.options.onHover;if("click"===t||n){var i=e.$target,r=i.data(No);v.dispatch("analytics-inline-dialog-opened",{extension:e.extension,eventType:t,onHover:n});if("click"===t&&!n){if("true"===i.attr("data-inline-created"))return;i.attr("data-inline-created","true")}this._createInlineDialog({id:r,extension:e.extension,$target:i,options:e.extension.options||{}}).show()}};t.opened=function(e){var t=e.$el.find("iframe");if(t&&1===t.length){var n=t.attr("src");if(n.length>0){var i=Le.hasJwt(n);if(i&&!Le.isJwtExpired(n)||!i)return!1}}var r=yr(e.extension),o=ir.requestContent(r);if(!o){console.warn("no content resolver found");return!1}o.then((function(t){t.options=t.options||{};U.extend(t.options,{autoresize:!0,widthinpx:!0});Fo({$el:e.$el,extension:t})}));return!0};t.addExtension=function(e){var t=Ci(e.extension);e.$el.empty().append(t)};t.createIfNotExists=function(e){var t=e.$target,n=t.data(No);if(!n){n=Wi.uniqueId();t.data(No,n)}};return e}()),Go=Ro.getWebItem();v.register("before:webitem-invoked:"+Go.name,(function(e){Ro.createIfNotExists(e)}));v.register("webitem-invoked:"+Go.name,(function(e){Ro.triggered(e)}));v.register("inline-dialog-opened",(function(e){Ro.opened(e)}));v.register("inline-dialog-extension",(function(e){Ro.addExtension(e)}));Yi(Go);var Uo=["click"],Bo="dialog-target-uid",zo={chrome:!0},Ko=new(function(){function e(){this._dialogWebItem={name:"dialog",selector:".ap-dialog",triggers:Uo}}var t=e.prototype;t.getWebItem=function(){return this._dialogWebItem};t._dialogOptions=function(e){return U.extend({},zo,e||{})};t.triggered=function(e){var t=e.$target.data(Bo),n=this._dialogOptions(e.extension.options);n.id=t;z(e.extension,n)};t.createIfNotExists=function(e){var t=e.$target,n=t.data(Bo);if(!n){n=Wi.uniqueId();t.data(Bo,n)}};return e}()),$o=Ko.getWebItem();v.register("webitem-invoked:"+$o.name,(function(e){Ko.triggered(e)}));v.register("before:webitem-invoked:"+$o.name,Ko.createIfNotExists);Yi($o);window._AP||(window._AP={});window._AP.version||(window._AP.version="5.3.187");M.defineModule("messages",Jr);M.defineModule("flag",ro);M.defineModule("dialog",xr);M.defineModule("inlineDialog",jr);M.defineModule("env",Lr);M.defineModule("events",B);M.defineModule("_analytics",oo);M.defineModule("scrollPosition",lo);M.defineModule("dropdown",po);M.defineModule("host",_o);M.defineModule("theming",Mo);M.defineModule("page",jo);v.register("module-define-custom",(function(e){M.defineModule(e.name,e.methods)}));M.registerRequestNotifier((function(t){var n=function(){if("req"===t.type){var n=M.getExtensions((function(e){return e.extension_id===t.extension_id}))[0];if(n){var i=n.extension;v.dispatch("method-invoked",e({},t,{extension:i}))}}};"function"==typeof window.requestIdleCallback?window.requestIdleCallback(n,{timeout:1e3}):n()}));function Jo(){!function(){var e=new MutationObserver((function(e){e.forEach((function(e){"childList"===e.type&&e.removedNodes.forEach((function(e){if(e.nodeType===Node.ELEMENT_NODE){var t=function(e){or.destroy(e.id)};"IFRAME"===e.tagName&&e.id?t(e):e.querySelectorAll("iframe[id]").forEach((function(e){t(e)}))}}))}))}));e.observe(document.body,{childList:!0,subtree:!0})}()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Jo):Jo();ri("acjs_iframe_click_analytics")&&Y((function(e,t){var n=JSON.parse(e.name||"{}").options||{},i={moduleLocation:n.moduleLocation,moduleType:n.moduleType,addonKey:t.addon_key,baseUrl:n.origin};Fi(i)}));M.setFeatureFlagGetter(ri);return or}));
}catch(e){WRMCB(e)};