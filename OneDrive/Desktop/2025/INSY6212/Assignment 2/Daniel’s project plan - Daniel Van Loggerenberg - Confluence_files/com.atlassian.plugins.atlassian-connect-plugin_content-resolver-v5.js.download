WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:content-resolver-v5', location = 'v5/js/iframe/host/content-resolver.js' */
!function(){function e(e){var t={};_.keys(e).forEach((function(n){t["ac."+n]=e[n]}));return t}function t(e){var t,n=e.getResponseHeader("Date"),o=Math.round(Date.parse(n)/1e3),r=Math.round(Date.now()/1e3);if(!isNaN(o)){t=Math.abs(r-o);window.connectHost.setJwtClockSkew(t+60)}}function n(n,o){return AJS.$.Deferred((function(r){var i=function(e){var t=e.addon_key+"__"+e.key;if(window._AP&&window._AP.cacheableIframeUrls&&window._AP.cacheableIframeUrls[t])return window._AP.cacheableIframeUrls[t]}(n);if(!i||o){var a={"plugin-key":n.addon_key,"product-context":JSON.stringify(n.options.productContext||{}),key:n.key,width:n.width||"100%",height:n.height||"100%",classifier:n.classifier||"raw"};n.options.contentClassifier&&(a.classifier=[n.options.contentClassifier,a.classifier]);var s,c,d=function(e,t){var n={};_.keys(e).forEach((function(o){t(o,e[o])&&(n[o]=e[o])}));return n}(n.options.customData||{},(function(e,t){return!_.isObject(t)&&(!("string"==typeof t||t instanceof String)||t.length<255)})),l=window.connectHost&&window.connectHost.trackContentResolverEvent,f=(s=n.addon_key,c=n.key,AJS.contextPath()+"/plugins/servlet/ac/"+encodeURIComponent(s)+"/"+encodeURIComponent(c));AJS.$.ajax(f,{dataType:"json"===n.classifier?"json":"html",data:AJS.$.extend({},a,e(d)),type:"POST"}).then((function(e,n,i){t(i);o?r.resolve(window._AP._convertConnectOptions(e)):require(["ac/create"],(function(t){r.resolve(window._AP._convertConnectOptions(e))}))})).fail((function(e,o,i){t(e);if(l&&e.status){var a={extension:n,attrs:{contentResolverUrl:f,httpStatusCode:e.status,errorText:i||e.statusText,responseText:"string"==typeof e.responseText?e.responseText.substring(0,1e3):"",traceId:e.getResponseHeader("atl-traceid")}};window.connectHost.trackContentResolverEvent(!1,a)}window.connectHost.getBooleanFeatureFlag("acjs_handle_dialog_content_resolver_errors",!0)&&window.connectHost.notifyContentResolverFailed(n);r.reject({addon_key:n.addon_key,key:n.key,options:n.options},{text:"Unable to retrieve addon module URL. Please check your specified module key.",traceId:window.connectHost.getBooleanFeatureFlag("display_trace_for_confluence_top_errors",!1)?e.getResponseHeader("atl-traceid"):void 0})}))}else r.resolve(window._AP._convertConnectOptions({addon_key:n.addon_key,key:n.key,url:i,productCtx:JSON.stringify(n.options.productContext||{})}))})).promise()}function o(e){return function(t){if("set_inner_iframe_url"===t.data.type){t.data.iframeData.classifier="json";return n(t.data.iframeData,!0).then((function(n){n.id=t.data.extension_id;e.registerExistingExtension(n.id,{extension:n});t.source.location=n.url}))}}}define("ac/content-resolver",(function(){return{resolveByExtension:n,getIframeUrlSetter:o}}));_AP.util.awaitGlobal("connectHost",(function(e){e.registerContentResolver.resolveByExtension(n);window.addEventListener("message",o(e))}))}();
}catch(e){WRMCB(e)};