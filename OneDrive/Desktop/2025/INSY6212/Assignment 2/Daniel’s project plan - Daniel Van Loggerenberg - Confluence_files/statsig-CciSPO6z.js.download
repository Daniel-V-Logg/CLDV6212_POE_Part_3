var Rt=r=>{throw TypeError(r)};var xt=(r,e,t)=>e.has(r)||Rt("Cannot "+t);var N=(r,e,t)=>(xt(r,e,"read from private field"),t?t.call(r):e.get(r)),W=(r,e,t)=>e.has(r)?Rt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ve=(r,e,t,i)=>(xt(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);import{p as ni,c as Ot,w as si,s as Vi}from"./sentry-BPH6silo.js";import{i as D,g as $i,h as E}from"./a1b2c3-BIUAe2b4.js";class Dt{constructor(e){this.payload=e}}class ks extends Dt{}class As extends Dt{}class zi extends Dt{}const ne=ni({}),ai=r=>{ne[r]={start:performance.now(),marks:{}}},Bi=(r,e)=>{ne[r]||ai(r);const t=e in ne[r].marks?`${e}_${Object.keys(ne[r].marks).length+1}`:e;ne[r].marks[t]=performance.now()-ne[r].start},Wi={time:ai,timeLog:Bi};class Ji extends Error{constructor(e){super(`${e} is not bound in the container. Did you forget to bind it?`),this.binding=e}}var Ve=(r=>(r.Factory="Factory",r.Singleton="Singleton",r))(Ve||{}),Se,oe;class qi{constructor(){W(this,Se,new Map);W(this,oe,new Map)}register(e,t,i){N(this,Se).set(e,{scope:i,value:t})}registerSingleton(e,t){this.resetSingleton(e),this.register(e,t,Ve.Singleton)}registerFactory(e,t){this.resetSingleton(e),this.register(e,t,Ve.Factory)}resolve(e){const t=N(this,Se).get(e);if(!t)throw new Ji(e.toString());const i=N(this,oe).get(e);if(i)return i;if(t.scope===Ve.Factory)return t.value(this);const n=t.value(this);return N(this,oe).set(e,n),n}resetSingleton(e){N(this,oe).delete(e)}}Se=new WeakMap,oe=new WeakMap;const Hi=new qi;var we,Oe,De,Ie;const Mt=class Mt{constructor(){W(this,we);W(this,Oe);W(this,De,!1);W(this,Ie,!1);this.promise=new Promise((e,t)=>{ve(this,we,e),ve(this,Oe,t)})}then(e,t){return this.get().then(e,t)}get(){return this.promise}async resolve(e){var t;(t=N(this,we))==null||t.call(this,e),ve(this,De,!0)}async reject(e){var t;(t=N(this,Oe))==null||t.call(this,e),ve(this,Ie,!0)}get fulfilled(){return N(this,De)||N(this,Ie)}static resolved(e){const t=new Mt;return t.resolve(e).catch(()=>{}),t}};we=new WeakMap,Oe=new WeakMap,De=new WeakMap,Ie=new WeakMap;let yt=Mt;function Xi(...r){console.error(...r),Ot(r.length===1?r[0]:r[1])}function Us(...r){console.error("Fatal Error: ",...r);const e=r.length===1?r[0]:r[1];si(t=>{t.setLevel("fatal"),Ot(e)})}function Ls(...r){console.warn(...r);const e=r.length===1?r[0]:r[1];si(t=>{t.setLevel("warning"),Ot(e)})}var oi=(r=>(r.Local="local",r.Statsig="statsig",r))(oi||{});const li={"local.test":{source:"local",enabled:!1,flag:"local.test"},"databases-frontend-layout-calendar":{source:"statsig",enabled:!1,flag:"databases-frontend-layout-calendar"},"databases-frontend-presence":{source:"statsig",enabled:!1,flag:"databases-frontend-presence"},"databases-frontend-checkbox-field-type":{source:"statsig",enabled:!1,flag:"databases-frontend-checkbox-field-type"},"databases-frontend-import-m2":{source:"statsig",enabled:!1,flag:"databases-frontend-import-m2"},"platform-visual-refresh-icons":{source:"statsig",enabled:!1,flag:"platform-visual-refresh-icons"},"database-frontend-cell-interactions-m0":{source:"statsig",enabled:!1,flag:"database-frontend-cell-interactions-m0"},"databases-frontend-ci2-m1":{source:"statsig",enabled:!1,flag:"databases-frontend-ci2-m1"},"databases-frontend-live-doc":{source:"statsig",enabled:!1,flag:"databases-frontend-live-doc"},"databases-frontend-import-changeboarding":{source:"statsig",enabled:!1,flag:"databases-frontend-import-changeboarding"},"platform-component-visual-refresh":{source:"statsig",enabled:!1,flag:"platform-component-visual-refresh"},"database-field-setting-2-media":{source:"statsig",enabled:!1,flag:"database-field-setting-2-media"},"databases-frontend-content-wrapper":{source:"statsig",enabled:!1,flag:"databases-frontend-content-wrapper"},"databases-frontend-nested-filters":{source:"statsig",enabled:!1,flag:"databases-frontend-nested-filters"},confluence_typography_refreshed:{source:"statsig",enabled:!1,flag:"confluence_typography_refreshed"},"databases-frontend-wrap-fields":{source:"statsig",enabled:!1,flag:"databases-frontend-wrap-fields"},"databases-frontend-multi-sort":{source:"statsig",enabled:!1,flag:"databases-frontend-multi-sort"},"databases-frontend-consolidating-comments":{source:"statsig",enabled:!1,flag:"databases-frontend-consolidating-comments"},"databases-frontend-field-settings-date":{source:"statsig",enabled:!1,flag:"databases-frontend-field-settings-date"},"databases-frontend-field-settings-number":{source:"statsig",enabled:!1,flag:"databases-frontend-field-settings-number"}};var ci={exports:{}};(function(r,e){(function(t,i){r.exports=i()})(D,()=>(()=>{var t={d:(v,g)=>{for(var m in g)t.o(g,m)&&!t.o(v,m)&&Object.defineProperty(v,m,{enumerable:!0,get:g[m]})},o:(v,g)=>Object.prototype.hasOwnProperty.call(v,g)},i={};t.d(i,{default:()=>h});const n=(...v)=>{},s=v=>v!==null&&(v==null?void 0:v.constructor.name)==="Object";let o,l;const c=()=>{if(!o){o=!0;try{l=a.storage||localStorage,l.getItem("")}catch{l=(()=>{const v={getItem:m=>g[m]||null,setItem:(m,f)=>{g[m]=f},removeItem:m=>{g[m]=void 0},clear:()=>{g={__proto__:v}}};let g={__proto__:v};return g})()}u()}},d="\0",_=(v,g,m=!0)=>m?[...JSON.stringify(v)].map(f=>String.fromCharCode(f.charCodeAt(0)+g)).join(""):JSON.parse([...v].map(f=>String.fromCharCode(f.charCodeAt(0)-g)).join("")),a={ttl:null,encrypt:!1,encrypter:_,decrypter:(v,g)=>_(v,g,!1),secret:75,storage:void 0};Object.seal(a);const u=(v=!1)=>{c();for(const g of Object.keys(l)){const m=l.getItem(g);let f;try{f=JSON.parse(m||"")}catch{continue}s(f)&&d in f&&(Date.now()>f.ttl||v)&&l.removeItem(g)}},h={config:a,set:(v,g,m={})=>{c();const f={...a,...m,encrypt:m.encrypt!==!1&&(m.encrypt||a.encrypt),ttl:m.ttl===null?null:m.ttl||a.ttl};try{const p=f.ttl&&!isNaN(f.ttl)&&f.ttl>0;let b=p?{[d]:g,ttl:Date.now()+1e3*f.ttl}:g;f.encrypt&&(p?b[d]=(f.encrypter||n)(b[d],f.secret):b=(f.encrypter||n)(b,f.secret)),l.setItem(v,JSON.stringify(b))}catch{return!1}},get:(v,g={})=>{c();const m=l.getItem(v),f={...a,...g,encrypt:g.encrypt!==!1&&(g.encrypt||a.encrypt),ttl:g.ttl===null?null:g.ttl||a.ttl};let p,b;try{p=JSON.parse(m||""),b=s(p)&&d in p,(f.decrypt||f.encrypt)&&(b?p[d]=(f.decrypter||n)(p[d],f.secret):p=(f.decrypter||n)(p,f.secret))}catch{}return b?Date.now()>p.ttl?(l.removeItem(v),null):p[d]:p!==void 0?p:m},flush:u,clear:()=>{c(),l.clear()},remove:v=>{c(),l.removeItem(v)}};return i.default})())})(ci);var Yi=ci.exports;const Qi=$i(Yi),Ce="__DATABASES_FF_OVERRIDES",ke=Qi,Zi=()=>ke.get(Ce)!==null,It=()=>Zi()?ke.get(Ce)??{}:{};function ui(r){Hi.resolve("EventBus").dispatch(new zi(r))}const er=r=>{const e=It();for(const t in r)e[t]=r[t];ui(e),ke.set(Ce,e)},tr=r=>{const e=It();for(const t in r)delete e[r[t]];ui(e),ke.set(Ce,e)},Ts=()=>{ke.remove(Ce)},ir=r=>{if(!r)return{};const e=new URL(r);return new URLSearchParams(e.search)};function rr(r){const[e,t]=r.split(":");let i=t??"true";return i=i.toLowerCase()==="true"||i==="1",[e,i]}const nr=r=>{const e=ir(r);if(e!=null&&e.get){if(e.get("ff")){const i=e.get("ff").split(",").reduce((n,s)=>{const[o,l]=rr(s);return n[o]=l,n},{});er(i)}e.get("ffc")&&tr(e.get("ffc").split(","))}};class sr{constructor(){this.clients=[]}add(e){this.clients.push(e)}async initialize(){for(const e of this.clients)if(e.status==="new")try{await e.initialize(),await e.initialized.resolve(e.name),e.status="initialized"}catch(t){e.status="errored";const i=new Error(`Could not initialize ${e.name} feature flags client. Reason: ${t}`);Xi(i),await e.initialized.resolve(e.name)}Ft=Vi(F),this.applyOverrides(),Wi.timeLog("app-initialization","feature-flags-end")}applyOverrides(){nr(window.location.href);const e=It();Object.entries(F).forEach(([t])=>{const i=t;e[i]!==void 0?F[i].enabled=e[i]:F[i].enabled=Ft[i].enabled})}initialized(){return Promise.all(this.clients.map(e=>e.initialized.get()))}}let Ft=li;const F=ni(li),Ps=(r,e)=>F[r]?F[r].enabled:e,Ms=()=>{const r=[];for(const e in F)if(Object.hasOwn(F,e)){const t=e;F[t].enabled&&r.push(t)}return r},Rs=new sr;var x={},Ct={},C={},Ye={},A={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Log=r.LogLevel=void 0;const e=" DEBUG ",t="  INFO ",i="  WARN ",n=" ERROR ";function s(l){return l.unshift("[Statsig]"),l}r.LogLevel={None:0,Error:1,Warn:2,Info:3,Debug:4};class o{static info(...c){o.level>=r.LogLevel.Info&&console.info(t,...s(c))}static debug(...c){o.level>=r.LogLevel.Debug&&console.debug(e,...s(c))}static warn(...c){o.level>=r.LogLevel.Warn&&console.warn(i,...s(c))}static error(...c){o.level>=r.LogLevel.Error&&console.error(n,...s(c))}}r.Log=o,o.level=r.LogLevel.Warn})(A);(function(r){var e,t,i;Object.defineProperty(r,"__esModule",{value:!0}),r._getInstance=r._getStatsigGlobalFlag=r._getStatsigGlobal=void 0;const n=A,s=()=>__STATSIG__||u;r._getStatsigGlobal=s;const o=h=>(0,r._getStatsigGlobal)()[h];r._getStatsigGlobalFlag=o;const l=h=>{const v=(0,r._getStatsigGlobal)();return h?v.instances&&v.instances[h]:(v.instances&&Object.keys(v.instances).length>1&&n.Log.warn("Call made to Statsig global instance without an SDK key but there is more than one client instance. If you are using mulitple clients, please specify the SDK key."),v.firstInstance)};r._getInstance=l;const c="__STATSIG__",d=typeof window<"u"?window:{},_=typeof D<"u"?D:{},a=typeof globalThis<"u"?globalThis:{},u=(i=(t=(e=d[c])!==null&&e!==void 0?e:_[c])!==null&&t!==void 0?t:a[c])!==null&&i!==void 0?i:{instance:r._getInstance};d[c]=u,_[c]=u,a[c]=u})(Ye);var Je={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Diagnostics=void 0;const e=new Map,t="start",i="end",n="statsig::diagnostics";r.Diagnostics={_getMarkers:d=>e.get(d),_markInitOverallStart:d=>{l(d,s({},t,"overall"))},_markInitOverallEnd:(d,_,a)=>{l(d,s({success:_,error:_?void 0:{name:"InitializeError",message:"Failed to initialize"},evaluationDetails:a},i,"overall"))},_markInitNetworkReqStart:(d,_)=>{l(d,s(_,t,"initialize","network_request"))},_markInitNetworkReqEnd:(d,_)=>{l(d,s(_,i,"initialize","network_request"))},_markInitProcessStart:d=>{l(d,s({},t,"initialize","process"))},_markInitProcessEnd:(d,_)=>{l(d,s(_,i,"initialize","process"))},_clearMarkers:d=>{e.delete(d)},_formatError(d){if(d&&typeof d=="object")return{code:c(d,"code"),name:c(d,"name"),message:c(d,"message")}},_getDiagnosticsData(d,_,a,u){var h;return{success:(d==null?void 0:d.ok)===!0,statusCode:d==null?void 0:d.status,sdkRegion:(h=d==null?void 0:d.headers)===null||h===void 0?void 0:h.get("x-statsig-region"),isDelta:a.includes('"is_delta":true')===!0?!0:void 0,attempt:_,error:r.Diagnostics._formatError(u)}},_enqueueDiagnosticsEvent(d,_,a,u){const h=r.Diagnostics._getMarkers(a);if(h==null||h.length<=0)return-1;const v=h[h.length-1].timestamp-h[0].timestamp;r.Diagnostics._clearMarkers(a);const g=o(d,{context:"initialize",markers:h.slice(),statsigOptions:u});return _.enqueue(g),v}};function s(d,_,a,u){return Object.assign({key:a,action:_,step:u,timestamp:Date.now()},d)}function o(d,_){return{eventName:n,user:d,value:null,metadata:_,time:Date.now()}}function l(d,_){var a;const u=(a=e.get(d))!==null&&a!==void 0?a:[];u.push(_),e.set(d,u)}function c(d,_){if(_ in d)return d[_]}})(Je);var Ae={},G={},_e={},B={};Object.defineProperty(B,"__esModule",{value:!0});B._isTypeMatch=B._typeOf=void 0;function ar(r){return Array.isArray(r)?"array":typeof r}B._typeOf=ar;function or(r,e){const t=i=>Array.isArray(i)?"array":typeof i;return t(r)===t(e)}B._isTypeMatch=or;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._getSortedObject=r._DJB2Object=r._DJB2=void 0;const e=B,t=s=>{let o=0;for(let l=0;l<s.length;l++){const c=s.charCodeAt(l);o=(o<<5)-o+c,o=o&o}return String(o>>>0)};r._DJB2=t;const i=(s,o)=>(0,r._DJB2)(JSON.stringify((0,r._getSortedObject)(s,o)));r._DJB2Object=i;const n=(s,o)=>{if(s==null)return null;const l=Object.keys(s).sort(),c={};return l.forEach(d=>{const _=s[d];if(o===0||(0,e._typeOf)(_)!=="object"){c[d]=_;return}c[d]=(0,r._getSortedObject)(_,o!=null?o-1:o)}),c};r._getSortedObject=n})(_e);Object.defineProperty(G,"__esModule",{value:!0});G._getStorageKey=G._getUserStorageKey=void 0;const di=_e;function _i(r,e,t){var i;if(t)return t(r,e);const n=e&&e.customIDs?e.customIDs:{},s=[`uid:${(i=e==null?void 0:e.userID)!==null&&i!==void 0?i:""}`,`cids:${Object.keys(n).sort((o,l)=>o.localeCompare(l)).map(o=>`${o}-${n[o]}`).join(",")}`,`k:${r}`];return(0,di._DJB2)(s.join("|"))}G._getUserStorageKey=_i;function lr(r,e,t){return e?_i(r,e,t):(0,di._DJB2)(`k:${r}`)}G._getStorageKey=lr;var Ue={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NetworkParam=r.NetworkDefault=r.Endpoint=void 0,r.Endpoint={_initialize:"initialize",_rgstr:"rgstr",_download_config_specs:"download_config_specs"},r.NetworkDefault={[r.Endpoint._rgstr]:"https://prodregistryv2.org/v1",[r.Endpoint._initialize]:"https://featureassets.org/v1",[r.Endpoint._download_config_specs]:"https://api.statsigcdn.com/v1"},r.NetworkParam={EventCount:"ec",SdkKey:"k",SdkType:"st",SdkVersion:"sv",Time:"t",SessionID:"sid",StatsigEncoded:"se",IsGzipped:"gz"}})(Ue);var Z={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._getCurrentPageUrlSafe=r._addDocumentEventListenerSafe=r._addWindowEventListenerSafe=r._isServerEnv=r._getDocumentSafe=r._getWindowSafe=void 0;const e=()=>typeof window<"u"?window:null;r._getWindowSafe=e;const t=()=>{var l;const c=(0,r._getWindowSafe)();return(l=c==null?void 0:c.document)!==null&&l!==void 0?l:null};r._getDocumentSafe=t;const i=()=>{if((0,r._getDocumentSafe)()!==null)return!1;const l=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;return typeof EdgeRuntime=="string"||l};r._isServerEnv=i;const n=(l,c)=>{const d=(0,r._getWindowSafe)();typeof(d==null?void 0:d.addEventListener)=="function"&&d.addEventListener(l,c)};r._addWindowEventListenerSafe=n;const s=(l,c)=>{const d=(0,r._getDocumentSafe)();typeof(d==null?void 0:d.addEventListener)=="function"&&d.addEventListener(l,c)};r._addDocumentEventListenerSafe=s;const o=()=>{var l;try{return(l=(0,r._getWindowSafe)())===null||l===void 0?void 0:l.location.href.split(/[?#]/)[0]}catch{return}};r._getCurrentPageUrlSafe=o})(Z);var T={};Object.defineProperty(T,"__esModule",{value:!0});T._createLayerParameterExposure=T._createConfigExposure=T._mapExposures=T._createGateExposure=T._isExposureEvent=void 0;const hi="statsig::config_exposure",fi="statsig::gate_exposure",gi="statsig::layer_exposure",kt=(r,e,t,i,n)=>(t.bootstrapMetadata&&(i.bootstrapMetadata=t.bootstrapMetadata),{eventName:r,user:e,value:null,metadata:hr(t,i),secondaryExposures:n,time:Date.now()}),cr=({eventName:r})=>r===fi||r===hi||r===gi;T._isExposureEvent=cr;const ur=(r,e,t)=>{var i,n,s;const o={gate:e.name,gateValue:String(e.value),ruleID:e.ruleID};return((i=e.__evaluation)===null||i===void 0?void 0:i.version)!=null&&(o.configVersion=e.__evaluation.version),kt(fi,r,e.details,o,Qe((s=(n=e.__evaluation)===null||n===void 0?void 0:n.secondary_exposures)!==null&&s!==void 0?s:[],t))};T._createGateExposure=ur;function Qe(r,e){return r.map(t=>typeof t=="string"?(e??{})[t]:t).filter(t=>t!=null)}T._mapExposures=Qe;const dr=(r,e,t)=>{var i,n,s,o;const l={config:e.name,ruleID:e.ruleID};return((i=e.__evaluation)===null||i===void 0?void 0:i.version)!=null&&(l.configVersion=e.__evaluation.version),((n=e.__evaluation)===null||n===void 0?void 0:n.passed)!=null&&(l.rulePassed=String(e.__evaluation.passed)),kt(hi,r,e.details,l,Qe((o=(s=e.__evaluation)===null||s===void 0?void 0:s.secondary_exposures)!==null&&o!==void 0?o:[],t))};T._createConfigExposure=dr;const _r=(r,e,t,i)=>{var n,s,o,l;const c=e.__evaluation,d=((n=c==null?void 0:c.explicit_parameters)===null||n===void 0?void 0:n.includes(t))===!0;let _="",a=(s=c==null?void 0:c.undelegated_secondary_exposures)!==null&&s!==void 0?s:[];d&&(_=(o=c.allocated_experiment_name)!==null&&o!==void 0?o:"",a=c.secondary_exposures);const u={config:e.name,parameterName:t,ruleID:e.ruleID,allocatedExperiment:_,isExplicitParameter:String(d)};return((l=e.__evaluation)===null||l===void 0?void 0:l.version)!=null&&(u.configVersion=e.__evaluation.version),kt(gi,r,e.details,u,Qe(a,i))};T._createLayerParameterExposure=_r;const hr=(r,e)=>(e.reason=r.reason,r.lcut&&(e.lcut=String(r.lcut)),r.receivedAt&&(e.receivedAt=String(r.receivedAt)),e);var K={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._setObjectInStorage=r._getObjectFromStorage=r.Storage=void 0;const e=A,t=Z,i={},n={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"InMemory",getItem:a=>i[a]?i[a]:null,setItem:(a,u)=>{i[a]=u},removeItem:a=>{delete i[a]},getAllKeys:()=>Object.keys(i)};let s=null;try{const a=(0,t._getWindowSafe)();a&&a.localStorage&&typeof a.localStorage.getItem=="function"&&(s={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"LocalStorage",getItem:u=>a.localStorage.getItem(u),setItem:(u,h)=>a.localStorage.setItem(u,h),removeItem:u=>a.localStorage.removeItem(u),getAllKeys:()=>Object.keys(a.localStorage)})}catch{e.Log.warn("Failed to setup localStorageProvider.")}let o=s??n,l=o;function c(a){try{return a()}catch(u){if(u instanceof Error&&u.name==="SecurityError")return r.Storage._setProvider(n),null;throw u}}r.Storage={isReady:()=>l.isReady(),isReadyResolver:()=>l.isReadyResolver(),getProviderName:()=>l.getProviderName(),getItem:a=>c(()=>l.getItem(a)),setItem:(a,u)=>l.setItem(a,u),removeItem:a=>l.removeItem(a),getAllKeys:()=>l.getAllKeys(),_setProvider:a=>{o=a,l=a},_setDisabled:a=>{a?l=n:l=o}};function d(a){const u=r.Storage.getItem(a);return JSON.parse(u??"null")}r._getObjectFromStorage=d;function _(a,u){r.Storage.setItem(a,JSON.stringify(u))}r._setObjectInStorage=_})(K);var Le={};Object.defineProperty(Le,"__esModule",{value:!0});Le.UrlConfiguration=void 0;const $e=Ue,fr={[$e.Endpoint._initialize]:"i",[$e.Endpoint._rgstr]:"e",[$e.Endpoint._download_config_specs]:"d"};class gr{constructor(e,t,i,n){this.customUrl=null,this.fallbackUrls=null,this.endpoint=e,this.endpointDnsKey=fr[e],t&&(this.customUrl=t),!t&&i&&(this.customUrl=i.endsWith("/")?`${i}${e}`:`${i}/${e}`),n&&(this.fallbackUrls=n);const s=$e.NetworkDefault[e];this.defaultUrl=`${s}/${e}`}getUrl(){var e;return(e=this.customUrl)!==null&&e!==void 0?e:this.defaultUrl}}Le.UrlConfiguration=gr;var Ze={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._notifyVisibilityChanged=r._subscribeToVisiblityChanged=r._isUnloading=r._isCurrentlyVisible=void 0;const e=Z,t="foreground",i="background",n=[];let s=t,o=!1;const l=()=>s===t;r._isCurrentlyVisible=l;const c=()=>o;r._isUnloading=c;const d=a=>{n.unshift(a)};r._subscribeToVisiblityChanged=d;const _=a=>{a!==s&&(s=a,n.forEach(u=>u(a)))};r._notifyVisibilityChanged=_,(0,e._addWindowEventListenerSafe)("focus",()=>{o=!1,(0,r._notifyVisibilityChanged)(t)}),(0,e._addWindowEventListenerSafe)("blur",()=>(0,r._notifyVisibilityChanged)(i)),(0,e._addWindowEventListenerSafe)("beforeunload",()=>{o=!0,(0,r._notifyVisibilityChanged)(i)}),(0,e._addDocumentEventListenerSafe)("visibilitychange",()=>{(0,r._notifyVisibilityChanged)(document.visibilityState==="visible"?t:i)})})(Ze);var ee=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.EventLogger=void 0;const vr=G,pr=_e,pe=A,jt=Ue,_t=Z,mr=T,te=K,yr=Le,Nt=Ze,br=100,Er=1e4,Sr=1e3,wr=6e5,Or=500,Gt=200,me={},Re={Startup:"startup",GainedFocus:"gained_focus"};class X{static _safeFlushAndForget(e){var t;(t=me[e])===null||t===void 0||t.flush().catch(()=>{})}static _safeRetryFailedLogs(e){var t;(t=me[e])===null||t===void 0||t._retryFailedLogs(Re.GainedFocus)}constructor(e,t,i,n){var s;this._sdkKey=e,this._emitter=t,this._network=i,this._options=n,this._queue=[],this._lastExposureTimeMap={},this._nonExposedChecks={},this._hasRunQuickFlush=!1,this._creationTime=Date.now(),this._isLoggingDisabled=(n==null?void 0:n.disableLogging)===!0,this._maxQueueSize=(s=n==null?void 0:n.loggingBufferMaxSize)!==null&&s!==void 0?s:br;const o=n==null?void 0:n.networkConfig;this._logEventUrlConfig=new yr.UrlConfiguration(jt.Endpoint._rgstr,o==null?void 0:o.logEventUrl,o==null?void 0:o.api,o==null?void 0:o.logEventFallbackUrls)}setLoggingDisabled(e){this._isLoggingDisabled=e}enqueue(e){this._shouldLogEvent(e)&&(this._normalizeAndAppendEvent(e),this._quickFlushIfNeeded(),this._queue.length>this._maxQueueSize&&X._safeFlushAndForget(this._sdkKey))}incrementNonExposureCount(e){var t;const i=(t=this._nonExposedChecks[e])!==null&&t!==void 0?t:0;this._nonExposedChecks[e]=i+1}reset(){this._lastExposureTimeMap={}}start(){(0,_t._isServerEnv)()||(me[this._sdkKey]=this,(0,Nt._subscribeToVisiblityChanged)(e=>{e==="background"?X._safeFlushAndForget(this._sdkKey):e==="foreground"&&X._safeRetryFailedLogs(this._sdkKey)}),this._retryFailedLogs(Re.Startup),this._startBackgroundFlushInterval())}stop(){return ee(this,void 0,void 0,function*(){this._flushIntervalId&&(clearInterval(this._flushIntervalId),this._flushIntervalId=null),delete me[this._sdkKey],yield this.flush()})}flush(){return ee(this,void 0,void 0,function*(){if(this._appendAndResetNonExposedChecks(),this._queue.length===0)return;const e=this._queue;this._queue=[],yield this._sendEvents(e)})}_quickFlushIfNeeded(){this._hasRunQuickFlush||(this._hasRunQuickFlush=!0,!(Date.now()-this._creationTime>Gt)&&setTimeout(()=>X._safeFlushAndForget(this._sdkKey),Gt))}_shouldLogEvent(e){if((0,_t._isServerEnv)())return!1;if(!(0,mr._isExposureEvent)(e))return!0;const t=e.user?e.user:{statsigEnvironment:void 0},i=(0,vr._getUserStorageKey)(this._sdkKey,t),n=e.metadata?e.metadata:{},s=[e.eventName,i,n.gate,n.config,n.ruleID,n.allocatedExperiment,n.parameterName,String(n.isExplicitParameter),n.reason].join("|"),o=this._lastExposureTimeMap[s],l=Date.now();return o&&l-o<wr?!1:(Object.keys(this._lastExposureTimeMap).length>Sr&&(this._lastExposureTimeMap={}),this._lastExposureTimeMap[s]=l,!0)}_sendEvents(e){var t,i;return ee(this,void 0,void 0,function*(){if(this._isLoggingDisabled)return this._saveFailedLogsToStorage(e),!1;try{const s=(0,Nt._isUnloading)()&&this._network.isBeaconSupported()&&((i=(t=this._options)===null||t===void 0?void 0:t.networkConfig)===null||i===void 0?void 0:i.networkOverrideFunc)==null;return this._emitter({name:"pre_logs_flushed",events:e}),(s?yield this._sendEventsViaBeacon(e):yield this._sendEventsViaPost(e)).success?(this._emitter({name:"logs_flushed",events:e}),!0):(pe.Log.warn("Failed to flush events."),this._saveFailedLogsToStorage(e),!1)}catch{return pe.Log.warn("Failed to flush events."),!1}})}_sendEventsViaPost(e){var t;return ee(this,void 0,void 0,function*(){const i=yield this._network.post(this._getRequestData(e)),n=(t=i==null?void 0:i.code)!==null&&t!==void 0?t:-1;return{success:n>=200&&n<300}})}_sendEventsViaBeacon(e){return ee(this,void 0,void 0,function*(){return{success:yield this._network.beacon(this._getRequestData(e))}})}_getRequestData(e){return{sdkKey:this._sdkKey,data:{events:e},urlConfig:this._logEventUrlConfig,retries:3,isCompressable:!0,params:{[jt.NetworkParam.EventCount]:String(e.length)}}}_saveFailedLogsToStorage(e){for(;e.length>Or;)e.shift();const t=this._getStorageKey();try{(0,te._setObjectInStorage)(t,e)}catch{pe.Log.warn("Unable to save failed logs to storage")}}_retryFailedLogs(e){const t=this._getStorageKey();ee(this,void 0,void 0,function*(){te.Storage.isReady()||(yield te.Storage.isReadyResolver());const i=(0,te._getObjectFromStorage)(t);if(!i)return;e===Re.Startup&&te.Storage.removeItem(t),(yield this._sendEvents(i))&&e===Re.GainedFocus&&te.Storage.removeItem(t)}).catch(()=>{pe.Log.warn("Failed to flush stored logs")})}_getStorageKey(){return`statsig.failed_logs.${(0,pr._DJB2)(this._sdkKey)}`}_normalizeAndAppendEvent(e){e.user&&(e.user=Object.assign({},e.user),delete e.user.privateAttributes);const t={},i=this._getCurrentPageUrl();i&&(t.statsigMetadata={currentPage:i});const n=Object.assign(Object.assign({},e),t);pe.Log.debug("Enqueued Event:",n),this._queue.push(n)}_appendAndResetNonExposedChecks(){Object.keys(this._nonExposedChecks).length!==0&&(this._normalizeAndAppendEvent({eventName:"statsig::non_exposed_checks",user:null,time:Date.now(),metadata:{checks:Object.assign({},this._nonExposedChecks)}}),this._nonExposedChecks={})}_getCurrentPageUrl(){var e;if(((e=this._options)===null||e===void 0?void 0:e.includeCurrentPageUrlWithEvents)!==!1)return(0,_t._getCurrentPageUrlSafe)()}_startBackgroundFlushInterval(){var e,t;const i=(t=(e=this._options)===null||e===void 0?void 0:e.loggingIntervalMs)!==null&&t!==void 0?t:Er,n=setInterval(()=>{const s=me[this._sdkKey];!s||s._flushIntervalId!==n?clearInterval(n):X._safeFlushAndForget(this._sdkKey)},i);this._flushIntervalId=n}}Ae.EventLogger=X;var Ee={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.StatsigMetadataProvider=r.SDK_VERSION=void 0,r.SDK_VERSION="3.12.1";let e={sdkVersion:r.SDK_VERSION,sdkType:"js-mono"};r.StatsigMetadataProvider={get:()=>e,add:t=>{e=Object.assign(Object.assign({},e),t)}}})(Ee);var vi={};Object.defineProperty(vi,"__esModule",{value:!0});var le={},he={},fe={};Object.defineProperty(fe,"__esModule",{value:!0});fe.getUUID=void 0;function Dr(){if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")return crypto.randomUUID();let r=new Date().getTime(),e=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return`xxxxxxxx-xxxx-4xxx-${"89ab"[Math.floor(Math.random()*4)]}xxx-xxxxxxxxxxxx`.replace(/[xy]/g,i=>{let n=Math.random()*16;return r>0?(n=(r+n)%16|0,r=Math.floor(r/16)):(n=(e+n)%16|0,e=Math.floor(e/16)),(i==="x"?n:n&7|8).toString(16)})}fe.getUUID=Dr;Object.defineProperty(he,"__esModule",{value:!0});he.StableID=void 0;const Ir=G,Cr=A,pi=K,kr=fe,xe={};he.StableID={get:r=>{if(xe[r]==null){let e=Ar(r);e==null&&(e=(0,kr.getUUID)(),Kt(e,r)),xe[r]=e}return xe[r]},setOverride:(r,e)=>{xe[e]=r,Kt(r,e)}};function mi(r){return`statsig.stable_id.${(0,Ir._getStorageKey)(r)}`}function Kt(r,e){const t=mi(e);try{(0,pi._setObjectInStorage)(t,r)}catch{Cr.Log.warn("Failed to save StableID")}}function Ar(r){const e=mi(r);return(0,pi._getObjectFromStorage)(e)}var Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y._getFullUserHash=Y._normalizeUser=void 0;const Ur=_e,Lr=A;function Tr(r,e,t){try{const i=JSON.parse(JSON.stringify(r));return e!=null&&e.environment!=null?i.statsigEnvironment=e.environment:t!=null&&(i.statsigEnvironment={tier:t}),i}catch{return Lr.Log.error("Failed to JSON.stringify user"),{statsigEnvironment:void 0}}}Y._normalizeUser=Tr;function Pr(r){return r?(0,Ur._DJB2Object)(r):null}Y._getFullUserHash=Pr;var Te={};Object.defineProperty(Te,"__esModule",{value:!0});Te._typedJsonParse=void 0;const Mr=A;function Rr(r,e,t){try{const i=JSON.parse(r);if(i&&typeof i=="object"&&e in i)return i}catch{}return Mr.Log.error(`Failed to parse ${t}`),null}Te._typedJsonParse=Rr;var ht=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(le,"__esModule",{value:!0});le._makeDataAdapterResult=le.DataAdapterCore=void 0;const ze=A,xr=he,Be=Y,$=K,Vt=Te,yi=10;class Fr{constructor(e,t){this._adapterName=e,this._cacheSuffix=t,this._options=null,this._sdkKey=null,this._lastModifiedStoreKey=`statsig.last_modified_time.${t}`,this._inMemoryCache=new jr}attach(e,t){this._sdkKey=e,this._options=t}getDataSync(e){const t=e&&(0,Be._normalizeUser)(e,this._options),i=this._getCacheKey(t),n=this._inMemoryCache.get(i,t);if(n)return n;const s=this._loadFromCache(i);return s?(this._inMemoryCache.add(i,s),this._inMemoryCache.get(i,t)):null}setData(e,t){const i=t&&(0,Be._normalizeUser)(t,this._options),n=this._getCacheKey(i);this._inMemoryCache.add(n,We("Bootstrap",e,null,i))}_getDataAsyncImpl(e,t,i){return ht(this,void 0,void 0,function*(){$.Storage.isReady()||(yield $.Storage.isReadyResolver());const n=e??this.getDataSync(t),s=[this._fetchAndPrepFromNetwork(n,t,i)];return i!=null&&i.timeoutMs&&s.push(new Promise(o=>setTimeout(o,i.timeoutMs)).then(()=>(ze.Log.debug("Fetching latest value timed out"),null))),yield Promise.race(s)})}_prefetchDataImpl(e,t){return ht(this,void 0,void 0,function*(){const i=e&&(0,Be._normalizeUser)(e,this._options),n=this._getCacheKey(i),s=yield this._getDataAsyncImpl(null,i,t);s&&this._inMemoryCache.add(n,Object.assign(Object.assign({},s),{source:"Prefetch"}))})}_fetchAndPrepFromNetwork(e,t,i){var n;return ht(this,void 0,void 0,function*(){const s=(n=e==null?void 0:e.data)!==null&&n!==void 0?n:null,o=e!=null&&this._isCachedResultValidFor204(e,t),l=yield this._fetchFromNetwork(s,t,i,o);if(!l)return ze.Log.debug("No response returned for latest value"),null;const c=(0,Vt._typedJsonParse)(l,"has_updates","Response"),d=this._getSdkKey(),_=xr.StableID.get(d);let a=null;if((c==null?void 0:c.has_updates)===!0)a=We("Network",l,_,t);else if(s&&(c==null?void 0:c.has_updates)===!1)a=We("NetworkNotModified",s,_,t);else return null;const u=this._getCacheKey(t);return this._inMemoryCache.add(u,a),this._writeToCache(u,a),a})}_getSdkKey(){return this._sdkKey!=null?this._sdkKey:(ze.Log.error(`${this._adapterName} is not attached to a Client`),"")}_loadFromCache(e){var t;const i=(t=$.Storage.getItem)===null||t===void 0?void 0:t.call($.Storage,e);if(i==null)return null;const n=(0,Vt._typedJsonParse)(i,"source","Cached Result");return n?Object.assign(Object.assign({},n),{source:"Cache"}):null}_writeToCache(e,t){$.Storage.setItem(e,JSON.stringify(t)),this._runLocalStorageCacheEviction(e)}_runLocalStorageCacheEviction(e){var t;const i=(t=(0,$._getObjectFromStorage)(this._lastModifiedStoreKey))!==null&&t!==void 0?t:{};i[e]=Date.now();const n=bi(i,yi);n&&(delete i[n],$.Storage.removeItem(n)),(0,$._setObjectInStorage)(this._lastModifiedStoreKey,i)}}le.DataAdapterCore=Fr;function We(r,e,t,i){return{source:r,data:e,receivedAt:Date.now(),stableID:t,fullUserHash:(0,Be._getFullUserHash)(i)}}le._makeDataAdapterResult=We;class jr{constructor(){this._data={}}get(e,t){var i;const n=this._data[e],s=n==null?void 0:n.stableID,o=(i=t==null?void 0:t.customIDs)===null||i===void 0?void 0:i.stableID;return o&&s&&o!==s?(ze.Log.warn("'StatsigUser.customIDs.stableID' mismatch"),null):n}add(e,t){const i=bi(this._data,yi-1);i&&delete this._data[i],this._data[e]=t}merge(e){this._data=Object.assign(Object.assign({},this._data),e)}}function bi(r,e){const t=Object.keys(r);return t.length<=e?null:t.reduce((i,n)=>{const s=r[i],o=r[n];return typeof s=="object"&&typeof o=="object"?o.receivedAt<s.receivedAt?n:i:o<s?n:i})}var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});var At={},ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.SDKType=void 0;const $t={};let ie;ge.SDKType={_get:r=>{var e;return((e=$t[r])!==null&&e!==void 0?e:"js-mono")+(ie??"")},_setClientType(r,e){$t[r]=e},_setBindingType(r){(!ie||ie==="-react")&&(ie="-"+r)}};(function(r){var e=D&&D.__awaiter||function(_,a,u,h){function v(g){return g instanceof u?g:new u(function(m){m(g)})}return new(u||(u=Promise))(function(g,m){function f(w){try{b(h.next(w))}catch(I){m(I)}}function p(w){try{b(h.throw(w))}catch(I){m(I)}}function b(w){w.done?g(w.value):v(w.value).then(f,p)}b((h=h.apply(_,a||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorBoundary=r.EXCEPTION_ENDPOINT=void 0;const t=A,i=ge,n=Ee;r.EXCEPTION_ENDPOINT="https://statsigapi.net/v1/sdk_exception";const s="[Statsig] UnknownError";class o{constructor(a,u,h,v){this._sdkKey=a,this._options=u,this._emitter=h,this._lastSeenError=v,this._seen=new Set}wrap(a){try{const u=a;d(u).forEach(h=>{const v=u[h];"$EB"in v||(u[h]=(...g)=>this._capture(h,()=>v.apply(a,g)),u[h].$EB=!0)})}catch(u){this._onError("eb:wrap",u)}}logError(a,u){this._onError(a,u)}getLastSeenErrorAndReset(){const a=this._lastSeenError;return this._lastSeenError=void 0,a??null}attachErrorIfNoneExists(a){this._lastSeenError||(this._lastSeenError=l(a))}_capture(a,u){try{const h=u();return h&&h instanceof Promise?h.catch(v=>this._onError(a,v)):h}catch(h){return this._onError(a,h),null}}_onError(a,u){try{t.Log.warn(`Caught error in ${a}`,{error:u}),e(this,void 0,void 0,function*(){var v,g,m,f,p,b,w;const I=u||Error(s),U=I instanceof Error,k=U?I.name:"No Name",M=l(I);if(this._lastSeenError=M,this._seen.has(k))return;if(this._seen.add(k),!((g=(v=this._options)===null||v===void 0?void 0:v.networkConfig)===null||g===void 0)&&g.preventAllNetworkTraffic){(m=this._emitter)===null||m===void 0||m.call(this,{name:"error",error:u,tag:a});return}const j=i.SDKType._get(this._sdkKey),V=n.StatsigMetadataProvider.get(),Gi=U?I.stack:c(I),Ki=JSON.stringify(Object.assign({tag:a,exception:k,info:Gi},Object.assign(Object.assign({},V),{sdkType:j})));yield((b=(p=(f=this._options)===null||f===void 0?void 0:f.networkConfig)===null||p===void 0?void 0:p.networkOverrideFunc)!==null&&b!==void 0?b:fetch)(r.EXCEPTION_ENDPOINT,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(j),"STATSIG-SDK-VERSION":String(V.sdkVersion),"Content-Type":"application/json"},body:Ki}),(w=this._emitter)===null||w===void 0||w.call(this,{name:"error",error:u,tag:a})}).then(()=>{}).catch(()=>{})}catch{}}}r.ErrorBoundary=o;function l(_){return _ instanceof Error?_:typeof _=="string"?new Error(_):new Error("An unknown error occurred.")}function c(_){try{return JSON.stringify(_)}catch{return s}}function d(_){const a=new Set;let u=Object.getPrototypeOf(_);for(;u&&u!==Object.prototype;)Object.getOwnPropertyNames(u).filter(h=>typeof(u==null?void 0:u[h])=="function").forEach(h=>a.add(h)),u=Object.getPrototypeOf(u);return Array.from(a)}})(At);var Si={};Object.defineProperty(Si,"__esModule",{value:!0});var wi={};Object.defineProperty(wi,"__esModule",{value:!0});var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});var Q={};Object.defineProperty(Q,"__esModule",{value:!0});Q.createMemoKey=Q.MemoPrefix=void 0;Q.MemoPrefix={_gate:"g",_dynamicConfig:"c",_experiment:"e",_layer:"l",_paramStore:"p"};const Nr=new Set([]),Gr=new Set(["userPersistedValues"]);function Kr(r,e,t){let i=`${r}|${e}`;if(!t)return i;for(const n of Object.keys(t)){if(Gr.has(n))return;Nr.has(n)?i+=`|${n}=true`:i+=`|${n}=${t[n]}`}return i}Q.createMemoKey=Kr;var et={},ce={},tt={},Vr=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(tt,"__esModule",{value:!0});tt._fetchTxtRecords=void 0;const $r=new Uint8Array([0,0,1,0,0,1,0,0,0,0,0,0,13,102,101,97,116,117,114,101,97,115,115,101,116,115,3,111,114,103,0,0,16,0,1]),zr="https://cloudflare-dns.com/dns-query",Br=["i","e","d"],Wr=200;function Jr(r){return Vr(this,void 0,void 0,function*(){const e=yield r(zr,{method:"POST",headers:{"Content-Type":"application/dns-message",Accept:"application/dns-message"},body:$r});if(!e.ok){const n=new Error("Failed to fetch TXT records from DNS");throw n.name="DnsTxtFetchError",n}const t=yield e.arrayBuffer(),i=new Uint8Array(t);return qr(i)})}tt._fetchTxtRecords=Jr;function qr(r){const e=r.findIndex((i,n)=>n<Wr&&String.fromCharCode(i)==="="&&Br.includes(String.fromCharCode(r[n-1])));if(e===-1){const i=new Error("Failed to parse TXT records from DNS");throw i.name="DnsTxtParseError",i}let t="";for(let i=e-1;i<r.length;i++)t+=String.fromCharCode(r[i]);return t.split(",")}var zt=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(ce,"__esModule",{value:!0});ce._isDomainFailure=ce.NetworkFallbackResolver=void 0;const Hr=tt,Xr=_e,Yr=A,bt=K,Bt=7*24*60*60*1e3,Qr=4*60*60*1e3;class Zr{constructor(e){var t;this._fallbackInfo=null,this._errorBoundary=null,this._dnsQueryCooldowns={},this._networkOverrideFunc=(t=e.networkConfig)===null||t===void 0?void 0:t.networkOverrideFunc}setErrorBoundary(e){this._errorBoundary=e}tryBumpExpiryTime(e,t){var i;const n=(i=this._fallbackInfo)===null||i===void 0?void 0:i[t.endpoint];n&&(n.expiryTime=Date.now()+Bt,ft(e,Object.assign(Object.assign({},this._fallbackInfo),{[t.endpoint]:n})))}getActiveFallbackUrl(e,t){var i,n;let s=this._fallbackInfo;s==null&&(s=(i=en(e))!==null&&i!==void 0?i:{},this._fallbackInfo=s);const o=s[t.endpoint];return!o||Date.now()>((n=o.expiryTime)!==null&&n!==void 0?n:0)?(delete s[t.endpoint],this._fallbackInfo=s,ft(e,this._fallbackInfo),null):o.url?o.url:null}getFallbackFromProvided(e){const t=Wt(e);return t?e.replace(t,""):null}tryFetchUpdatedFallbackInfo(e,t,i,n){var s,o;return zt(this,void 0,void 0,function*(){try{if(!Di(i,n))return!1;const c=t.customUrl==null&&t.fallbackUrls==null?yield this._tryFetchFallbackUrlsFromNetwork(t):t.fallbackUrls,d=this._pickNewFallbackUrl((s=this._fallbackInfo)===null||s===void 0?void 0:s[t.endpoint],c);return d?(this._updateFallbackInfoWithNewUrl(e,t.endpoint,d),!0):!1}catch(l){return(o=this._errorBoundary)===null||o===void 0||o.logError("tryFetchUpdatedFallbackInfo",l),!1}})}_updateFallbackInfoWithNewUrl(e,t,i){var n,s,o;const l={url:i,expiryTime:Date.now()+Bt,previous:[]},c=(n=this._fallbackInfo)===null||n===void 0?void 0:n[t];c&&l.previous.push(...c.previous),l.previous.length>10&&(l.previous=[]);const d=(o=(s=this._fallbackInfo)===null||s===void 0?void 0:s[t])===null||o===void 0?void 0:o.url;d!=null&&l.previous.push(d),this._fallbackInfo=Object.assign(Object.assign({},this._fallbackInfo),{[t]:l}),ft(e,this._fallbackInfo)}_tryFetchFallbackUrlsFromNetwork(e){var t;return zt(this,void 0,void 0,function*(){const i=this._dnsQueryCooldowns[e.endpoint];if(i&&Date.now()<i)return null;this._dnsQueryCooldowns[e.endpoint]=Date.now()+Qr;const n=[],s=yield(0,Hr._fetchTxtRecords)((t=this._networkOverrideFunc)!==null&&t!==void 0?t:fetch),o=Wt(e.defaultUrl);for(const l of s){if(!l.startsWith(e.endpointDnsKey+"="))continue;const c=l.split("=");if(c.length>1){let d=c[1];d.endsWith("/")&&(d=d.slice(0,-1)),n.push(`https://${d}${o}`)}}return n})}_pickNewFallbackUrl(e,t){var i;if(t==null)return null;const n=new Set((i=e==null?void 0:e.previous)!==null&&i!==void 0?i:[]),s=e==null?void 0:e.url;let o=null;for(const l of t){const c=l.endsWith("/")?l.slice(0,-1):l;if(!n.has(l)&&c!==s){o=c;break}}return o}}ce.NetworkFallbackResolver=Zr;function Di(r,e){var t;const i=(t=r==null?void 0:r.toLowerCase())!==null&&t!==void 0?t:"";return e||i.includes("uncaught exception")||i.includes("failed to fetch")||i.includes("networkerror when attempting to fetch resource")}ce._isDomainFailure=Di;function Ii(r){return`statsig.network_fallback.${(0,Xr._DJB2)(r)}`}function ft(r,e){const t=Ii(r);if(!e||Object.keys(e).length===0){bt.Storage.removeItem(t);return}bt.Storage.setItem(t,JSON.stringify(e))}function en(r){const e=Ii(r),t=bt.Storage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return Yr.Log.error("Failed to parse FallbackInfo"),null}}function Wt(r){try{return new URL(r).pathname}catch{return null}}var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.SDKFlags=void 0;const Jt={};Pe.SDKFlags={setFlags:(r,e)=>{Jt[r]=e},get:(r,e)=>{var t,i;return(i=(t=Jt[r])===null||t===void 0?void 0:t[e])!==null&&i!==void 0?i:!1}};var it={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.StatsigSession=r.SessionID=void 0;const e=G,t=A,i=K,n=fe,s=30*60*1e3,o=4*60*60*1e3,l={};r.SessionID={get:f=>r.StatsigSession.get(f).data.sessionID},r.StatsigSession={get:f=>{l[f]==null&&(l[f]=c(f));const p=l[f];return _(p)},overrideInitialSessionID:(f,p)=>{l[p]=d(f,p)}};function c(f){let p=m(f);const b=Date.now();return p||(p={sessionID:(0,n.getUUID)(),startTime:b,lastUpdate:b}),{data:p,sdkKey:f}}function d(f,p){const b=Date.now();return{data:{sessionID:f,startTime:b,lastUpdate:b},sdkKey:p}}function _(f){const p=Date.now(),b=f.data;(u(b)||h(b))&&(b.sessionID=(0,n.getUUID)(),b.startTime=p),b.lastUpdate=p,g(b,f.sdkKey),clearTimeout(f.idleTimeoutID),clearTimeout(f.ageTimeoutID);const w=p-b.startTime,I=f.sdkKey;return f.idleTimeoutID=a(I,s),f.ageTimeoutID=a(I,o-w),f}function a(f,p){return setTimeout(()=>{const b=__STATSIG__==null?void 0:__STATSIG__.instance(f);b&&b.$emt({name:"session_expired"})},p)}function u({lastUpdate:f}){return Date.now()-f>s}function h({startTime:f}){return Date.now()-f>o}function v(f){return`statsig.session_id.${(0,e._getStorageKey)(f)}`}function g(f,p){const b=v(p);try{(0,i._setObjectInStorage)(b,f)}catch{t.Log.warn("Failed to save SessionID")}}function m(f){const p=v(f);return(0,i._getObjectFromStorage)(p)}})(it);var Me={};Object.defineProperty(Me,"__esModule",{value:!0});Me.ErrorTag=void 0;Me.ErrorTag={NetworkError:"NetworkError"};var se=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(et,"__esModule",{value:!0});et.NetworkCore=void 0;const qt=Ye,Et=Je,H=A,R=Ue,tn=ce,rn=Pe,Ci=ge,nn=Z,ki=it,sn=he,an=Me,Ai=Ee,on=Ze,ln=1e4,cn=500,un=3e4,dn=1e3,Ui=50,_n=Ui/dn,hn=new Set([408,500,502,503,504,522,524,599]);class fn{constructor(e,t){this._emitter=t,this._errorBoundary=null,this._timeout=ln,this._netConfig={},this._options={},this._leakyBucket={},this._lastUsedInitUrl=null,e&&(this._options=e),this._options.networkConfig&&(this._netConfig=this._options.networkConfig),this._netConfig.networkTimeoutMs&&(this._timeout=this._netConfig.networkTimeoutMs),this._fallbackResolver=new tn.NetworkFallbackResolver(this._options)}setErrorBoundary(e){this._errorBoundary=e,this._errorBoundary.wrap(this),this._errorBoundary.wrap(this._fallbackResolver),this._fallbackResolver.setErrorBoundary(e)}isBeaconSupported(){return typeof navigator<"u"&&typeof navigator.sendBeacon=="function"}getLastUsedInitUrlAndReset(){const e=this._lastUsedInitUrl;return this._lastUsedInitUrl=null,e}beacon(e){return se(this,void 0,void 0,function*(){if(!Ht(e))return!1;const t=this._getInternalRequestArgs("POST",e);yield this._tryToCompressBody(t);const i=yield this._getPopulatedURL(t),n=navigator;return n.sendBeacon.bind(n)(i,t.body)})}post(e){return se(this,void 0,void 0,function*(){const t=this._getInternalRequestArgs("POST",e);return this._tryEncodeBody(t),yield this._tryToCompressBody(t),this._sendRequest(t)})}get(e){const t=this._getInternalRequestArgs("GET",e);return this._sendRequest(t)}_sendRequest(e){var t,i,n,s;return se(this,void 0,void 0,function*(){if(!Ht(e)||this._netConfig.preventAllNetworkTraffic)return null;const{method:o,body:l,retries:c,attempt:d}=e,_=e.urlConfig.endpoint;if(this._isRateLimited(_))return H.Log.warn(`Request to ${_} was blocked because you are making requests too frequently.`),null;const a=d??1,u=typeof AbortController<"u"?new AbortController:null,h=setTimeout(()=>{u==null||u.abort(`Timeout of ${this._timeout}ms expired.`)},this._timeout),v=yield this._getPopulatedURL(e);let g=null;const m=(0,on._isUnloading)();try{const f={method:o,body:l,headers:Object.assign({},e.headers),signal:u==null?void 0:u.signal,priority:e.priority,keepalive:m};mn(e,a);const p=this._leakyBucket[_];if(p&&(p.lastRequestTime=Date.now(),this._leakyBucket[_]=p),g=yield((t=this._netConfig.networkOverrideFunc)!==null&&t!==void 0?t:fetch)(v,f),clearTimeout(h),!g.ok){const I=yield g.text().catch(()=>"No Text"),U=new Error(`NetworkError: ${v} ${I}`);throw U.name="NetworkError",U}const w=yield g.text();return Xt(e,g,a,w),this._fallbackResolver.tryBumpExpiryTime(e.sdkKey,e.urlConfig),{body:w,code:g.status}}catch(f){const p=vn(u,f),b=pn(u);if(Xt(e,g,a,"",f),(yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(e.sdkKey,e.urlConfig,p,b))&&(e.fallbackUrl=this._fallbackResolver.getActiveFallbackUrl(e.sdkKey,e.urlConfig)),!c||a>c||!hn.has((i=g==null?void 0:g.status)!==null&&i!==void 0?i:500)){(n=this._emitter)===null||n===void 0||n.call(this,{name:"error",error:f,tag:an.ErrorTag.NetworkError,requestArgs:e});const I=`A networking error occurred during ${o} request to ${v}.`;return H.Log.error(I,p,f),(s=this._errorBoundary)===null||s===void 0||s.attachErrorIfNoneExists(I),null}return yield yn(a),this._sendRequest(Object.assign(Object.assign({},e),{retries:c,attempt:a+1}))}})}_isRateLimited(e){var t;const i=Date.now(),n=(t=this._leakyBucket[e])!==null&&t!==void 0?t:{count:0,lastRequestTime:i},s=i-n.lastRequestTime,o=Math.floor(s*_n);return n.count=Math.max(0,n.count-o),n.count>=Ui?!0:(n.count+=1,n.lastRequestTime=i,this._leakyBucket[e]=n,!1)}_getPopulatedURL(e){var t;return se(this,void 0,void 0,function*(){const i=(t=e.fallbackUrl)!==null&&t!==void 0?t:e.urlConfig.getUrl();(e.urlConfig.endpoint===R.Endpoint._initialize||e.urlConfig.endpoint===R.Endpoint._download_config_specs)&&(this._lastUsedInitUrl=i);const n=Object.assign({[R.NetworkParam.SdkKey]:e.sdkKey,[R.NetworkParam.SdkType]:Ci.SDKType._get(e.sdkKey),[R.NetworkParam.SdkVersion]:Ai.SDK_VERSION,[R.NetworkParam.Time]:String(Date.now()),[R.NetworkParam.SessionID]:ki.SessionID.get(e.sdkKey)},e.params),s=Object.keys(n).map(o=>`${encodeURIComponent(o)}=${encodeURIComponent(n[o])}`).join("&");return`${i}${s?`?${s}`:""}`})}_tryEncodeBody(e){var t;const i=(0,nn._getWindowSafe)(),n=e.body;if(!(!e.isStatsigEncodable||this._options.disableStatsigEncoding||typeof n!="string"||(0,qt._getStatsigGlobalFlag)("no-encode")!=null||!(i!=null&&i.btoa)))try{e.body=i.btoa(n).split("").reverse().join(""),e.params=Object.assign(Object.assign({},(t=e.params)!==null&&t!==void 0?t:{}),{[R.NetworkParam.StatsigEncoded]:"1"})}catch(s){H.Log.warn(`Request encoding failed for ${e.urlConfig.getUrl()}`,s)}}_tryToCompressBody(e){var t;return se(this,void 0,void 0,function*(){const i=e.body;if(!(!e.isCompressable||this._options.disableCompression||typeof i!="string"||rn.SDKFlags.get(e.sdkKey,"enable_log_event_compression")!==!0||(0,qt._getStatsigGlobalFlag)("no-compress")!=null||typeof CompressionStream>"u"||typeof TextEncoder>"u"))try{const n=new TextEncoder().encode(i),s=new CompressionStream("gzip"),o=s.writable.getWriter();o.write(n).catch(H.Log.error),o.close().catch(H.Log.error);const l=s.readable.getReader(),c=[];let d;for(;!(d=yield l.read()).done;)c.push(d.value);const _=c.reduce((h,v)=>h+v.length,0),a=new Uint8Array(_);let u=0;for(const h of c)a.set(h,u),u+=h.length;e.body=a,e.params=Object.assign(Object.assign({},(t=e.params)!==null&&t!==void 0?t:{}),{[R.NetworkParam.IsGzipped]:"1"})}catch(n){H.Log.warn(`Request compression failed for ${e.urlConfig.getUrl()}`,n)}})}_getInternalRequestArgs(e,t){const i=this._fallbackResolver.getActiveFallbackUrl(t.sdkKey,t.urlConfig),n=Object.assign(Object.assign({},t),{method:e,fallbackUrl:i});return"data"in t&&gn(n,t.data),n}}et.NetworkCore=fn;const Ht=r=>r.sdkKey?!0:(H.Log.warn("Unable to make request without an SDK key"),!1),gn=(r,e)=>{const{sdkKey:t,fallbackUrl:i}=r,n=sn.StableID.get(t),s=ki.SessionID.get(t),o=Ci.SDKType._get(t);r.body=JSON.stringify(Object.assign(Object.assign({},e),{statsigMetadata:Object.assign(Object.assign({},Ai.StatsigMetadataProvider.get()),{stableID:n,sessionID:s,sdkType:o,fallbackUrl:i})}))};function vn(r,e){return r!=null&&r.signal.aborted&&typeof r.signal.reason=="string"?r.signal.reason:typeof e=="string"?e:e instanceof Error?`${e.name}: ${e.message}`:"Unknown Error"}function pn(r){return(r==null?void 0:r.signal.aborted)&&typeof r.signal.reason=="string"&&r.signal.reason.includes("Timeout")||!1}function mn(r,e){r.urlConfig.endpoint===R.Endpoint._initialize&&Et.Diagnostics._markInitNetworkReqStart(r.sdkKey,{attempt:e})}function Xt(r,e,t,i,n){r.urlConfig.endpoint===R.Endpoint._initialize&&Et.Diagnostics._markInitNetworkReqEnd(r.sdkKey,Et.Diagnostics._getDiagnosticsData(e,t,i,n))}function yn(r){return se(this,void 0,void 0,function*(){yield new Promise(e=>setTimeout(e,Math.min(cn*(r*r),un)))})}var Li={};Object.defineProperty(Li,"__esModule",{value:!0});var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});var rt={},bn=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(rt,"__esModule",{value:!0});rt.StatsigClientBase=void 0;const En=Ye,Sn=At,wn=Ae,St=A,On=Q,Dn=Z,In=it,Fe=K,Cn=3e3;class kn{constructor(e,t,i,n){var s;this.loadingStatus="Uninitialized",this._initializePromise=null,this._listeners={};const o=this.$emt.bind(this);(n==null?void 0:n.logLevel)!=null&&(St.Log.level=n.logLevel),n!=null&&n.disableStorage&&Fe.Storage._setDisabled(!0),n!=null&&n.initialSessionID&&In.StatsigSession.overrideInitialSessionID(n.initialSessionID,e),n!=null&&n.storageProvider&&Fe.Storage._setProvider(n.storageProvider),this._sdkKey=e,this._options=n??{},this._memoCache={},this.overrideAdapter=(s=n==null?void 0:n.overrideAdapter)!==null&&s!==void 0?s:null,this._logger=new wn.EventLogger(e,o,i,n),this._errorBoundary=new Sn.ErrorBoundary(e,n,o),this._errorBoundary.wrap(this),this._errorBoundary.wrap(t),this._errorBoundary.wrap(this._logger),i.setErrorBoundary(this._errorBoundary),this.dataAdapter=t,this.dataAdapter.attach(e,n),this.storageProvider=Fe.Storage,this._primeReadyRipcord(),An(e,this)}updateRuntimeOptions(e){e.disableLogging!=null&&(this._options.disableLogging=e.disableLogging,this._logger.setLoggingDisabled(e.disableLogging)),e.disableStorage!=null&&(this._options.disableStorage=e.disableStorage,Fe.Storage._setDisabled(e.disableStorage))}flush(){return this._logger.flush()}shutdown(){return bn(this,void 0,void 0,function*(){this.$emt({name:"pre_shutdown"}),this._setStatus("Uninitialized",null),this._initializePromise=null,yield this._logger.stop()})}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){if(this._listeners[e]){const i=this._listeners[e].indexOf(t);i!==-1&&this._listeners[e].splice(i,1)}}$on(e,t){t.__isInternal=!0,this.on(e,t)}$emt(e){var t;const i=n=>{try{n(e)}catch(s){if(n.__isInternal===!0){this._errorBoundary.logError(`__emit:${e.name}`,s);return}St.Log.error("An error occurred in a StatsigClientEvent listener. This is not an issue with Statsig.",e)}};this._listeners[e.name]&&this._listeners[e.name].forEach(n=>i(n)),(t=this._listeners["*"])===null||t===void 0||t.forEach(i)}_setStatus(e,t){this.loadingStatus=e,this._memoCache={},this.$emt({name:"values_updated",status:e,values:t})}_enqueueExposure(e,t,i){if((i==null?void 0:i.disableExposureLog)===!0){this._logger.incrementNonExposureCount(e);return}this._logger.enqueue(t)}_memoize(e,t){return(i,n)=>{if(this._options.disableEvaluationMemoization)return t(i,n);const s=(0,On.createMemoKey)(e,i,n);return s?(s in this._memoCache||(Object.keys(this._memoCache).length>=Cn&&(this._memoCache={}),this._memoCache[s]=t(i,n)),this._memoCache[s]):t(i,n)}}}rt.StatsigClientBase=kn;function An(r,e){var t;if((0,Dn._isServerEnv)())return;const i=(0,En._getStatsigGlobal)(),n=(t=i.instances)!==null&&t!==void 0?t:{},s=e;n[r]!=null&&St.Log.warn("Creating multiple Statsig clients with the same SDK key can lead to unexpected behavior. Multi-instance support requires different SDK keys."),n[r]=s,i.firstInstance||(i.firstInstance=s),i.instances=n,__STATSIG__=i}var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.DataAdapterCachePrefix=void 0;nt.DataAdapterCachePrefix="statsig.cached";var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});var L={};Object.defineProperty(L,"__esModule",{value:!0});L._makeTypedGet=L._mergeOverride=L._makeLayer=L._makeExperiment=L._makeDynamicConfig=L._makeFeatureGate=void 0;const Un=A,Ln=B,Tn="default";function Ut(r,e,t,i){var n;return{name:r,details:e,ruleID:(n=t==null?void 0:t.rule_id)!==null&&n!==void 0?n:Tn,__evaluation:t,value:i}}function Pn(r,e,t){return Ut(r,e,t,(t==null?void 0:t.value)===!0)}L._makeFeatureGate=Pn;function Ri(r,e,t){var i;const n=(i=t==null?void 0:t.value)!==null&&i!==void 0?i:{};return Object.assign(Object.assign({},Ut(r,e,t,n)),{get:st(r,t==null?void 0:t.value)})}L._makeDynamicConfig=Ri;function Mn(r,e,t){var i;const n=Ri(r,e,t);return Object.assign(Object.assign({},n),{groupName:(i=t==null?void 0:t.group_name)!==null&&i!==void 0?i:null})}L._makeExperiment=Mn;function Rn(r,e,t,i){var n,s;return Object.assign(Object.assign({},Ut(r,e,t,void 0)),{get:st(r,t==null?void 0:t.value,i),groupName:(n=t==null?void 0:t.group_name)!==null&&n!==void 0?n:null,__value:(s=t==null?void 0:t.value)!==null&&s!==void 0?s:{}})}L._makeLayer=Rn;function xn(r,e,t,i){return Object.assign(Object.assign(Object.assign({},r),e),{get:st(r.name,t,i)})}L._mergeOverride=xn;function st(r,e,t){return(i,n)=>{var s;const o=(s=e==null?void 0:e[i])!==null&&s!==void 0?s:null;return o==null?n??null:n!=null&&!(0,Ln._isTypeMatch)(o,n)?(Un.Log.warn(`Parameter type mismatch. '${r}.${i}' was found to be type '${typeof o}' but fallback/return type is '${typeof n}'. See https://docs.statsig.com/client/javascript-sdk/#typed-getters`),n??null):(t==null||t(i),o)}}L._makeTypedGet=st;var xi={};Object.defineProperty(xi,"__esModule",{value:!0});var ue={};Object.defineProperty(ue,"__esModule",{value:!0});ue.UPDATE_DETAIL_ERROR_MESSAGES=ue.createUpdateDetails=void 0;const Fn=(r,e,t,i,n,s)=>({duration:t,source:e,success:r,error:i,sourceUrl:n,warnings:s});ue.createUpdateDetails=Fn;ue.UPDATE_DETAIL_ERROR_MESSAGES={NO_NETWORK_DATA:"No data was returned from the network. This may be due to a network timeout if a timeout value was specified in the options or ad blocker error."};(function(r){var e=D&&D.__createBinding||(Object.create?function(c,d,_,a){a===void 0&&(a=_);var u=Object.getOwnPropertyDescriptor(d,_);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[_]}}),Object.defineProperty(c,a,u)}:function(c,d,_,a){a===void 0&&(a=_),c[a]=d[_]}),t=D&&D.__exportStar||function(c,d){for(var _ in c)_!=="default"&&!Object.prototype.hasOwnProperty.call(d,_)&&e(d,c,_)};Object.defineProperty(r,"__esModule",{value:!0}),r.Storage=r.Log=r.EventLogger=r.Diagnostics=void 0;const i=Je;Object.defineProperty(r,"Diagnostics",{enumerable:!0,get:function(){return i.Diagnostics}});const n=Ae;Object.defineProperty(r,"EventLogger",{enumerable:!0,get:function(){return n.EventLogger}});const s=A;Object.defineProperty(r,"Log",{enumerable:!0,get:function(){return s.Log}});const o=Ee,l=K;Object.defineProperty(r,"Storage",{enumerable:!0,get:function(){return l.Storage}}),t(Ye,r),t(G,r),t(vi,r),t(le,r),t(Je,r),t(Ei,r),t(At,r),t(Si,r),t(wi,r),t(_e,r),t(Oi,r),t(A,r),t(Q,r),t(Ue,r),t(et,r),t(Li,r),t(Ti,r),t(Z,r),t(ge,r),t(it,r),t(he,r),t(rt,r),t(Me,r),t(nt,r),t(T,r),t(Ee,r),t(Pi,r),t(Mi,r),t(L,r),t(xi,r),t(Y,r),t(K,r),t(Te,r),t(B,r),t(Le,r),t(fe,r),t(Ze,r),t(ue,r),t(Pe,r),__STATSIG__=Object.assign(Object.assign({},__STATSIG__!=null?__STATSIG__:{}),{Log:s.Log,SDK_VERSION:o.SDK_VERSION})})(C);var Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});const J=C;class jn{constructor(e){this._sdkKey=e,this._rawValues=null,this._values=null,this._source="Uninitialized",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null,this._warnings=new Set}reset(){this._values=null,this._rawValues=null,this._source="Loading",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null}finalize(){this._values||(this._source="NoValues")}getValues(){return this._rawValues?(0,J._typedJsonParse)(this._rawValues,"has_updates","EvaluationStoreValues"):null}setValues(e,t){var i;if(!e)return!1;const n=(0,J._typedJsonParse)(e.data,"has_updates","EvaluationResponse");return n==null?!1:(this._source=e.source,(n==null?void 0:n.has_updates)!==!0||(this._rawValues=e.data,this._lcut=n.time,this._receivedAt=e.receivedAt,this._values=n,this._bootstrapMetadata=this._extractBootstrapMetadata(e.source,n),e.source&&n.user&&this._setWarningState(t,n),J.SDKFlags.setFlags(this._sdkKey,(i=n.sdk_flags)!==null&&i!==void 0?i:{})),!0)}getWarnings(){if(this._warnings.size!==0)return Array.from(this._warnings)}getGate(e){var t;return this._getDetailedStoreResult((t=this._values)===null||t===void 0?void 0:t.feature_gates,e)}getConfig(e){var t;return this._getDetailedStoreResult((t=this._values)===null||t===void 0?void 0:t.dynamic_configs,e)}getLayer(e){var t;return this._getDetailedStoreResult((t=this._values)===null||t===void 0?void 0:t.layer_configs,e)}getParamStore(e){var t;return this._getDetailedStoreResult((t=this._values)===null||t===void 0?void 0:t.param_stores,e)}getSource(){return this._source}getExposureMapping(){var e;return(e=this._values)===null||e===void 0?void 0:e.exposures}_extractBootstrapMetadata(e,t){if(e!=="Bootstrap")return null;const i={};return t.user&&(i.user=t.user),t.sdkInfo&&(i.generatorSDKInfo=t.sdkInfo),i.lcut=t.time,i}_getDetailedStoreResult(e,t){let i=null;return e&&(i=e[t]?e[t]:e[(0,J._DJB2)(t)]),{result:i,details:this._getDetails(i==null)}}_setWarningState(e,t){var i;const n=J.StableID.get(this._sdkKey);if(((i=e.customIDs)===null||i===void 0?void 0:i.stableID)!==n){this._warnings.add("StableIDMismatch");return}if("user"in t){const s=t.user;(0,J._getFullUserHash)(e)!==(0,J._getFullUserHash)(s)&&this._warnings.add("PartialUserMatch")}}getCurrentSourceDetails(){if(this._source==="Uninitialized"||this._source==="NoValues")return{reason:this._source};const e={reason:this._source,lcut:this._lcut,receivedAt:this._receivedAt};return this._warnings.size>0&&(e.warnings=Array.from(this._warnings)),e}_getDetails(e){var t,i;const n=this.getCurrentSourceDetails();let s=n.reason;const o=(t=n.warnings)!==null&&t!==void 0?t:[];this._source==="Bootstrap"&&o.length>0&&(s=s+o[0]),s!=="Uninitialized"&&s!=="NoValues"&&(s=`${s}:${e?"Unrecognized":"Recognized"}`);const l=this._source==="Bootstrap"&&(i=this._bootstrapMetadata)!==null&&i!==void 0?i:void 0;return l&&(n.bootstrapMetadata=l),Object.assign(Object.assign({},n),{reason:s})}}Lt.default=jn;var at={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot._resolveDeltasResponse=void 0;const Yt=C,Nn=2;function Gn(r,e){const t=(0,Yt._typedJsonParse)(e,"checksum","DeltasEvaluationResponse");if(!t)return{hadBadDeltaChecksum:!0};const i=Kn(r,t),n=Vn(i),s=(0,Yt._DJB2Object)({feature_gates:n.feature_gates,dynamic_configs:n.dynamic_configs,layer_configs:n.layer_configs},Nn);return s===t.checksumV2?JSON.stringify(n):{hadBadDeltaChecksum:!0,badChecksum:s,badMergedConfigs:n,badFullResponse:t.deltas_full_response}}ot._resolveDeltasResponse=Gn;function Kn(r,e){return Object.assign(Object.assign(Object.assign({},r),e),{feature_gates:Object.assign(Object.assign({},r.feature_gates),e.feature_gates),layer_configs:Object.assign(Object.assign({},r.layer_configs),e.layer_configs),dynamic_configs:Object.assign(Object.assign({},r.dynamic_configs),e.dynamic_configs)})}function Vn(r){const e=r;return gt(r.deleted_gates,e.feature_gates),delete e.deleted_gates,gt(r.deleted_configs,e.dynamic_configs),delete e.deleted_configs,gt(r.deleted_layers,e.layer_configs),delete e.deleted_layers,e}function gt(r,e){r==null||r.forEach(t=>{delete e[t]})}var Qt=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(at,"__esModule",{value:!0});const je=C,$n=ot;class zn extends je.NetworkCore{constructor(e,t){super(e,t);const i=e==null?void 0:e.networkConfig;this._initializeUrlConfig=new je.UrlConfiguration(je.Endpoint._initialize,i==null?void 0:i.initializeUrl,i==null?void 0:i.api,i==null?void 0:i.initializeFallbackUrls)}fetchEvaluations(e,t,i,n,s){return Qt(this,void 0,void 0,function*(){const o=t?(0,je._typedJsonParse)(t,"has_updates","InitializeResponse"):null;let l={user:n,hash:"djb2",deltasResponseRequested:!1,full_checksum:null};return o!=null&&o.has_updates&&(l=Object.assign(Object.assign({},l),{sinceTime:s?o.time:0,previousDerivedFields:"derived_fields"in o&&s?o.derived_fields:{},deltasResponseRequested:!0,full_checksum:o.full_checksum})),this._fetchEvaluations(e,o,l,i)})}_fetchEvaluations(e,t,i,n){var s,o;return Qt(this,void 0,void 0,function*(){const l=yield this.post({sdkKey:e,urlConfig:this._initializeUrlConfig,data:i,retries:2,isStatsigEncodable:!0,priority:n});if((l==null?void 0:l.code)===204)return'{"has_updates": false}';if((l==null?void 0:l.code)!==200)return(s=l==null?void 0:l.body)!==null&&s!==void 0?s:null;if((t==null?void 0:t.has_updates)!==!0||((o=l.body)===null||o===void 0?void 0:o.includes('"is_delta":true'))!==!0||i.deltasResponseRequested!==!0)return l.body;const c=(0,$n._resolveDeltasResponse)(t,l.body);return typeof c=="string"?c:this._fetchEvaluations(e,t,Object.assign(Object.assign(Object.assign({},i),c),{deltasResponseRequested:!1}),n)})}}at.default=zn;var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt._makeParamStoreGetter=void 0;const Fi=C,ct={disableExposureLog:!0};function ut(r){return r==null||r.disableExposureLog===!1}function Tt(r,e){return e!=null&&!(0,Fi._isTypeMatch)(r,e)}function Bn(r,e){return r.value}function Wn(r,e,t){return r.getFeatureGate(e.gate_name,ut(t)?void 0:ct).value?e.pass_value:e.fail_value}function Jn(r,e,t,i){const s=r.getDynamicConfig(e.config_name,ct).get(e.param_name);return Tt(s,t)?t:(ut(i)&&r.getDynamicConfig(e.config_name),s)}function qn(r,e,t,i){const s=r.getExperiment(e.experiment_name,ct).get(e.param_name);return Tt(s,t)?t:(ut(i)&&r.getExperiment(e.experiment_name),s)}function Hn(r,e,t,i){const s=r.getLayer(e.layer_name,ct).get(e.param_name);return Tt(s,t)?t:(ut(i)&&r.getLayer(e.layer_name).get(e.param_name),s)}function Xn(r,e,t){return(i,n)=>{if(e==null)return n;const s=e[i];if(s==null||n!=null&&(0,Fi._typeOf)(n)!==s.param_type)return n;switch(s.ref_type){case"static":return Bn(s);case"gate":return Wn(r,s,t);case"dynamic_config":return Jn(r,s,n,t);case"experiment":return qn(r,s,n,t);case"layer":return Hn(r,s,n,t);default:return n}}}lt._makeParamStoreGetter=Xn;var dt={},Yn=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(dt,"__esModule",{value:!0});dt.StatsigEvaluationsDataAdapter=void 0;const q=C,Qn=at;class Zn extends q.DataAdapterCore{constructor(){super("EvaluationsDataAdapter","evaluations"),this._network=null,this._options=null}attach(e,t){super.attach(e,t),this._network=new Qn.default(t??{})}getDataAsync(e,t,i){return this._getDataAsyncImpl(e,(0,q._normalizeUser)(t,this._options),i)}prefetchData(e,t){return this._prefetchDataImpl(e,t)}setData(e){const t=(0,q._typedJsonParse)(e,"has_updates","data");t&&"user"in t?super.setData(e,t.user):q.Log.error("StatsigUser not found. You may be using an older server SDK version. Please upgrade your SDK or use setDataLegacy.")}setDataLegacy(e,t){super.setData(e,t)}_fetchFromNetwork(e,t,i,n){var s;return Yn(this,void 0,void 0,function*(){const o=yield(s=this._network)===null||s===void 0?void 0:s.fetchEvaluations(this._getSdkKey(),e,i==null?void 0:i.priority,t,n);return o??null})}_getCacheKey(e){var t;const i=(0,q._getStorageKey)(this._getSdkKey(),e,(t=this._options)===null||t===void 0?void 0:t.customUserCacheKeyFunc);return`${q.DataAdapterCachePrefix}.${this._cacheSuffix}.${i}`}_isCachedResultValidFor204(e,t){return e.fullUserHash!=null&&e.fullUserHash===(0,q._getFullUserHash)(t)}}dt.StatsigEvaluationsDataAdapter=Zn;var vt=D&&D.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(_){try{d(i.next(_))}catch(a){o(a)}}function c(_){try{d(i.throw(_))}catch(a){o(a)}}function d(_){_.done?s(_.value):n(_.value).then(l,c)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(Ct,"__esModule",{value:!0});const S=C,es=Lt,ts=at,Zt=lt,is=dt;let rs=class wt extends S.StatsigClientBase{static instance(e){const t=(0,S._getStatsigGlobal)().instance(e);return t instanceof wt?t:(S.Log.warn((0,S._isServerEnv)()?"StatsigClient.instance is not supported in server environments":"Unable to find StatsigClient instance"),new wt(e??"",{}))}constructor(e,t,i=null){var n,s;S.SDKType._setClientType(e,"javascript-client");const o=new ts.default(i,c=>{this.$emt(c)});super(e,(n=i==null?void 0:i.dataAdapter)!==null&&n!==void 0?n:new is.StatsigEvaluationsDataAdapter,o,i),this.getFeatureGate=this._memoize(S.MemoPrefix._gate,this._getFeatureGateImpl.bind(this)),this.getDynamicConfig=this._memoize(S.MemoPrefix._dynamicConfig,this._getDynamicConfigImpl.bind(this)),this.getExperiment=this._memoize(S.MemoPrefix._experiment,this._getExperimentImpl.bind(this)),this.getLayer=this._memoize(S.MemoPrefix._layer,this._getLayerImpl.bind(this)),this.getParameterStore=this._memoize(S.MemoPrefix._paramStore,this._getParameterStoreImpl.bind(this)),this._store=new es.default(e),this._network=o,this._user=this._configureUser(t,i);const l=(s=i==null?void 0:i.plugins)!==null&&s!==void 0?s:[];for(const c of l)c.bind(this)}initializeSync(e){var t;return this.loadingStatus!=="Uninitialized"?(0,S.createUpdateDetails)(!0,this._store.getSource(),-1,null,null,["MultipleInitializations",...(t=this._store.getWarnings())!==null&&t!==void 0?t:[]]):(this._logger.start(),this.updateUserSync(this._user,e))}initializeAsync(e){return vt(this,void 0,void 0,function*(){return this._initializePromise?this._initializePromise:(this._initializePromise=this._initializeAsyncImpl(e),this._initializePromise)})}updateUserSync(e,t){var i;const n=performance.now(),s=[...(i=this._store.getWarnings())!==null&&i!==void 0?i:[]];this._resetForUser(e);const o=this.dataAdapter.getDataSync(this._user);o==null&&s.push("NoCachedValues"),this._store.setValues(o,this._user),this._finalizeUpdate(o);const l=t==null?void 0:t.disableBackgroundCacheRefresh;return l===!0||l==null&&(o==null?void 0:o.source)==="Bootstrap"?(0,S.createUpdateDetails)(!0,this._store.getSource(),performance.now()-n,this._errorBoundary.getLastSeenErrorAndReset(),this._network.getLastUsedInitUrlAndReset(),s):(this._runPostUpdate(o??null,this._user),(0,S.createUpdateDetails)(!0,this._store.getSource(),performance.now()-n,this._errorBoundary.getLastSeenErrorAndReset(),this._network.getLastUsedInitUrlAndReset(),s))}updateUserAsync(e,t){return vt(this,void 0,void 0,function*(){this._resetForUser(e);const i=this._user;S.Diagnostics._markInitOverallStart(this._sdkKey);let n=this.dataAdapter.getDataSync(i);if(this._store.setValues(n,this._user),this._setStatus("Loading",n),n=yield this.dataAdapter.getDataAsync(n,i,t),i!==this._user)return(0,S.createUpdateDetails)(!1,this._store.getSource(),-1,new Error("User changed during update"),this._network.getLastUsedInitUrlAndReset());let s=!1;n!=null&&(S.Diagnostics._markInitProcessStart(this._sdkKey),s=this._store.setValues(n,this._user),S.Diagnostics._markInitProcessEnd(this._sdkKey,{success:s})),this._finalizeUpdate(n),s||(this._errorBoundary.attachErrorIfNoneExists(S.UPDATE_DETAIL_ERROR_MESSAGES.NO_NETWORK_DATA),this.$emt({name:"initialization_failure"})),S.Diagnostics._markInitOverallEnd(this._sdkKey,s,this._store.getCurrentSourceDetails());const o=S.Diagnostics._enqueueDiagnosticsEvent(this._user,this._logger,this._sdkKey,this._options);return(0,S.createUpdateDetails)(s,this._store.getSource(),o,this._errorBoundary.getLastSeenErrorAndReset(),this._network.getLastUsedInitUrlAndReset(),this._store.getWarnings())})}getContext(){return{sdkKey:this._sdkKey,options:this._options,values:this._store.getValues(),user:JSON.parse(JSON.stringify(this._user)),errorBoundary:this._errorBoundary,session:S.StatsigSession.get(this._sdkKey),stableID:S.StableID.get(this._sdkKey)}}checkGate(e,t){return this.getFeatureGate(e,t).value}logEvent(e,t,i){const n=typeof e=="string"?{eventName:e,value:t,metadata:i}:e;this._logger.enqueue(Object.assign(Object.assign({},n),{user:this._user,time:Date.now()}))}_primeReadyRipcord(){this.$on("error",()=>{this.loadingStatus==="Loading"&&this._finalizeUpdate(null)})}_initializeAsyncImpl(e){return vt(this,void 0,void 0,function*(){return S.Storage.isReady()||(yield S.Storage.isReadyResolver()),this._logger.start(),this.updateUserAsync(this._user,e)})}_finalizeUpdate(e){this._store.finalize(),this._setStatus("Ready",e)}_runPostUpdate(e,t){this.dataAdapter.getDataAsync(e,t,{priority:"low"}).catch(i=>{S.Log.error("An error occurred after update.",i)})}_resetForUser(e){this._logger.reset(),this._store.reset(),this._user=this._configureUser(e,this._options)}_configureUser(e,t){var i;const n=(0,S._normalizeUser)(e,t),s=(i=n.customIDs)===null||i===void 0?void 0:i.stableID;return s&&S.StableID.setOverride(s,this._sdkKey),n}_getFeatureGateImpl(e,t){var i,n;const{result:s,details:o}=this._store.getGate(e),l=(0,S._makeFeatureGate)(e,o,s),c=(n=(i=this.overrideAdapter)===null||i===void 0?void 0:i.getGateOverride)===null||n===void 0?void 0:n.call(i,l,this._user,t),d=c??l;return this._enqueueExposure(e,(0,S._createGateExposure)(this._user,d,this._store.getExposureMapping()),t),this.$emt({name:"gate_evaluation",gate:d}),d}_getDynamicConfigImpl(e,t){var i,n;const{result:s,details:o}=this._store.getConfig(e),l=(0,S._makeDynamicConfig)(e,o,s),c=(n=(i=this.overrideAdapter)===null||i===void 0?void 0:i.getDynamicConfigOverride)===null||n===void 0?void 0:n.call(i,l,this._user,t),d=c??l;return this._enqueueExposure(e,(0,S._createConfigExposure)(this._user,d,this._store.getExposureMapping()),t),this.$emt({name:"dynamic_config_evaluation",dynamicConfig:d}),d}_getExperimentImpl(e,t){var i,n,s,o;const{result:l,details:c}=this._store.getConfig(e),d=(0,S._makeExperiment)(e,c,l);d.__evaluation!=null&&(d.__evaluation.secondary_exposures=(0,S._mapExposures)((n=(i=d.__evaluation)===null||i===void 0?void 0:i.secondary_exposures)!==null&&n!==void 0?n:[],this._store.getExposureMapping()));const _=(o=(s=this.overrideAdapter)===null||s===void 0?void 0:s.getExperimentOverride)===null||o===void 0?void 0:o.call(s,d,this._user,t),a=_??d;return this._enqueueExposure(e,(0,S._createConfigExposure)(this._user,a,this._store.getExposureMapping()),t),this.$emt({name:"experiment_evaluation",experiment:a}),a}_getLayerImpl(e,t){var i,n,s;const{result:o,details:l}=this._store.getLayer(e),c=(0,S._makeLayer)(e,l,o),d=(n=(i=this.overrideAdapter)===null||i===void 0?void 0:i.getLayerOverride)===null||n===void 0?void 0:n.call(i,c,this._user,t);t!=null&&t.disableExposureLog&&this._logger.incrementNonExposureCount(e);const _=(0,S._mergeOverride)(c,d,(s=d==null?void 0:d.__value)!==null&&s!==void 0?s:c.__value,a=>{t!=null&&t.disableExposureLog||this._enqueueExposure(e,(0,S._createLayerParameterExposure)(this._user,_,a,this._store.getExposureMapping()),t)});return this.$emt({name:"layer_evaluation",layer:_}),_}_getParameterStoreImpl(e,t){var i,n;const{result:s,details:o}=this._store.getParamStore(e);this._logger.incrementNonExposureCount(e);const l={name:e,details:o,__configuration:s,get:(0,Zt._makeParamStoreGetter)(this,s,t)},c=(n=(i=this.overrideAdapter)===null||i===void 0?void 0:i.getParamStoreOverride)===null||n===void 0?void 0:n.call(i,l,t);return c!=null&&(l.__configuration=c.config,l.details=c.details,l.get=(0,Zt._makeParamStoreGetter)(this,c.config,t)),l}};Ct.default=rs;(function(r){var e=D&&D.__createBinding||(Object.create?function(n,s,o,l){l===void 0&&(l=o);var c=Object.getOwnPropertyDescriptor(s,o);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(n,l,c)}:function(n,s,o,l){l===void 0&&(l=o),n[l]=s[o]}),t=D&&D.__exportStar||function(n,s){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,n,o)};Object.defineProperty(r,"__esModule",{value:!0}),r.StatsigClient=void 0;const i=Ct;r.StatsigClient=i.default,t(C,r),__STATSIG__=Object.assign(Object.assign({},__STATSIG__!=null?__STATSIG__:{}),{StatsigClient:i.default}),r.default=__STATSIG__})(x);var ji={exports:{}};/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */(function(r,e){(function(t){var i=Array.isArray?Array.isArray:function(u){return Object.prototype.toString.call(u)==="[object Array]"},n=10;function s(){this._events={},this._conf&&o.call(this,this._conf)}function o(a){a?(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),this._maxListeners=a.maxListeners!==t?a.maxListeners:n,a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),a.verboseMemoryLeak&&(this.verboseMemoryLeak=a.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=n}function l(a,u){var h="(node) warning: possible EventEmitter memory leak detected. "+a+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(h+=" Event name: "+u+"."),typeof process<"u"&&process.emitWarning){var v=new Error(h);v.name="MaxListenersExceededWarning",v.emitter=this,v.count=a,process.emitWarning(v)}else console.error(h),console.trace&&console.trace()}function c(a){this._events={},this.newListener=!1,this.verboseMemoryLeak=!1,o.call(this,a)}c.EventEmitter2=c;function d(a,u,h,v){if(!h)return[];var g=[],m,f,p,b,w,I,U,k=u.length,M=u[v],j=u[v+1];if(v===k&&h._listeners){if(typeof h._listeners=="function")return a&&a.push(h._listeners),[h];for(m=0,f=h._listeners.length;m<f;m++)a&&a.push(h._listeners[m]);return[h]}if(M==="*"||M==="**"||h[M]){if(M==="*"){for(p in h)p!=="_listeners"&&h.hasOwnProperty(p)&&(g=g.concat(d(a,u,h[p],v+1)));return g}else if(M==="**"){U=v+1===k||v+2===k&&j==="*",U&&h._listeners&&(g=g.concat(d(a,u,h,k)));for(p in h)p!=="_listeners"&&h.hasOwnProperty(p)&&(p==="*"||p==="**"?(h[p]._listeners&&!U&&(g=g.concat(d(a,u,h[p],k))),g=g.concat(d(a,u,h[p],v))):p===j?g=g.concat(d(a,u,h[p],v+2)):g=g.concat(d(a,u,h[p],v)));return g}g=g.concat(d(a,u,h[M],v+1))}if(b=h["*"],b&&d(a,u,b,v+1),w=h["**"],w)if(v<k){w._listeners&&d(a,u,w,k);for(p in w)p!=="_listeners"&&w.hasOwnProperty(p)&&(p===j?d(a,u,w[p],v+2):p===M?d(a,u,w[p],v+1):(I={},I[p]=w[p],d(a,u,{"**":I},v+1)))}else w._listeners?d(a,u,w,k):w["*"]&&w["*"]._listeners&&d(a,u,w["*"],k);return g}function _(a,u){a=typeof a=="string"?a.split(this.delimiter):a.slice();for(var h=0,v=a.length;h+1<v;h++)if(a[h]==="**"&&a[h+1]==="**")return;for(var g=this.listenerTree,m=a.shift();m!==t;){if(g[m]||(g[m]={}),g=g[m],a.length===0)return g._listeners?(typeof g._listeners=="function"&&(g._listeners=[g._listeners]),g._listeners.push(u),!g._listeners.warned&&this._maxListeners>0&&g._listeners.length>this._maxListeners&&(g._listeners.warned=!0,l.call(this,g._listeners.length,m))):g._listeners=u,!0;m=a.shift()}return!0}c.prototype.delimiter=".",c.prototype.setMaxListeners=function(a){a!==t&&(this._maxListeners=a,this._conf||(this._conf={}),this._conf.maxListeners=a)},c.prototype.event="",c.prototype.once=function(a,u){return this._once(a,u,!1)},c.prototype.prependOnceListener=function(a,u){return this._once(a,u,!0)},c.prototype._once=function(a,u,h){return this._many(a,1,u,h),this},c.prototype.many=function(a,u,h){return this._many(a,u,h,!1)},c.prototype.prependMany=function(a,u,h){return this._many(a,u,h,!0)},c.prototype._many=function(a,u,h,v){var g=this;if(typeof h!="function")throw new Error("many only accepts instances of Function");function m(){return--u===0&&g.off(a,m),h.apply(this,arguments)}return m._origin=h,this._on(a,m,v),g},c.prototype.emit=function(){this._events||s.call(this);var a=arguments[0];if(a==="newListener"&&!this.newListener&&!this._events.newListener)return!1;var u=arguments.length,h,v,g,m,f;if(this._all&&this._all.length){if(f=this._all.slice(),u>3)for(h=new Array(u),m=0;m<u;m++)h[m]=arguments[m];for(g=0,v=f.length;g<v;g++)switch(this.event=a,u){case 1:f[g].call(this,a);break;case 2:f[g].call(this,a,arguments[1]);break;case 3:f[g].call(this,a,arguments[1],arguments[2]);break;default:f[g].apply(this,h)}}if(this.wildcard){f=[];var p=typeof a=="string"?a.split(this.delimiter):a.slice();d.call(this,f,p,this.listenerTree,0)}else if(f=this._events[a],typeof f=="function"){switch(this.event=a,u){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:for(h=new Array(u-1),m=1;m<u;m++)h[m-1]=arguments[m];f.apply(this,h)}return!0}else f&&(f=f.slice());if(f&&f.length){if(u>3)for(h=new Array(u-1),m=1;m<u;m++)h[m-1]=arguments[m];for(g=0,v=f.length;g<v;g++)switch(this.event=a,u){case 1:f[g].call(this);break;case 2:f[g].call(this,arguments[1]);break;case 3:f[g].call(this,arguments[1],arguments[2]);break;default:f[g].apply(this,h)}return!0}else if(!this._all&&a==="error")throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},c.prototype.emitAsync=function(){this._events||s.call(this);var a=arguments[0];if(a==="newListener"&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var u=[],h=arguments.length,v,g,m,f,p;if(this._all){if(h>3)for(v=new Array(h),f=1;f<h;f++)v[f]=arguments[f];for(m=0,g=this._all.length;m<g;m++)switch(this.event=a,h){case 1:u.push(this._all[m].call(this,a));break;case 2:u.push(this._all[m].call(this,a,arguments[1]));break;case 3:u.push(this._all[m].call(this,a,arguments[1],arguments[2]));break;default:u.push(this._all[m].apply(this,v))}}if(this.wildcard){p=[];var b=typeof a=="string"?a.split(this.delimiter):a.slice();d.call(this,p,b,this.listenerTree,0)}else p=this._events[a];if(typeof p=="function")switch(this.event=a,h){case 1:u.push(p.call(this));break;case 2:u.push(p.call(this,arguments[1]));break;case 3:u.push(p.call(this,arguments[1],arguments[2]));break;default:for(v=new Array(h-1),f=1;f<h;f++)v[f-1]=arguments[f];u.push(p.apply(this,v))}else if(p&&p.length){if(p=p.slice(),h>3)for(v=new Array(h-1),f=1;f<h;f++)v[f-1]=arguments[f];for(m=0,g=p.length;m<g;m++)switch(this.event=a,h){case 1:u.push(p[m].call(this));break;case 2:u.push(p[m].call(this,arguments[1]));break;case 3:u.push(p[m].call(this,arguments[1],arguments[2]));break;default:u.push(p[m].apply(this,v))}}else if(!this._all&&a==="error")return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},c.prototype.on=function(a,u){return this._on(a,u,!1)},c.prototype.prependListener=function(a,u){return this._on(a,u,!0)},c.prototype.onAny=function(a){return this._onAny(a,!1)},c.prototype.prependAny=function(a){return this._onAny(a,!0)},c.prototype.addListener=c.prototype.on,c.prototype._onAny=function(a,u){if(typeof a!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),u?this._all.unshift(a):this._all.push(a),this},c.prototype._on=function(a,u,h){if(typeof a=="function")return this._onAny(a,u),this;if(typeof u!="function")throw new Error("on only accepts instances of Function");return this._events||s.call(this),this.emit("newListener",a,u),this.wildcard?(_.call(this,a,u),this):(this._events[a]?(typeof this._events[a]=="function"&&(this._events[a]=[this._events[a]]),h?this._events[a].unshift(u):this._events[a].push(u),!this._events[a].warned&&this._maxListeners>0&&this._events[a].length>this._maxListeners&&(this._events[a].warned=!0,l.call(this,this._events[a].length,a))):this._events[a]=u,this)},c.prototype.off=function(a,u){if(typeof u!="function")throw new Error("removeListener only takes instances of Function");var h,v=[];if(this.wildcard){var g=typeof a=="string"?a.split(this.delimiter):a.slice();v=d.call(this,null,g,this.listenerTree,0)}else{if(!this._events[a])return this;h=this._events[a],v.push({_listeners:h})}for(var m=0;m<v.length;m++){var f=v[m];if(h=f._listeners,i(h)){for(var p=-1,b=0,w=h.length;b<w;b++)if(h[b]===u||h[b].listener&&h[b].listener===u||h[b]._origin&&h[b]._origin===u){p=b;break}if(p<0)continue;return this.wildcard?f._listeners.splice(p,1):this._events[a].splice(p,1),h.length===0&&(this.wildcard?delete f._listeners:delete this._events[a]),this.emit("removeListener",a,u),this}else(h===u||h.listener&&h.listener===u||h._origin&&h._origin===u)&&(this.wildcard?delete f._listeners:delete this._events[a],this.emit("removeListener",a,u))}function I(U){if(U!==t){var k=Object.keys(U);for(var M in k){var j=k[M],V=U[j];V instanceof Function||typeof V!="object"||V===null||(Object.keys(V).length>0&&I(U[j]),Object.keys(V).length===0&&delete U[j])}}}return I(this.listenerTree),this},c.prototype.offAny=function(a){var u=0,h=0,v;if(a&&this._all&&this._all.length>0){for(v=this._all,u=0,h=v.length;u<h;u++)if(a===v[u])return v.splice(u,1),this.emit("removeListenerAny",a),this}else{for(v=this._all,u=0,h=v.length;u<h;u++)this.emit("removeListenerAny",v[u]);this._all=[]}return this},c.prototype.removeListener=c.prototype.off,c.prototype.removeAllListeners=function(a){if(arguments.length===0)return!this._events||s.call(this),this;if(this.wildcard)for(var u=typeof a=="string"?a.split(this.delimiter):a.slice(),h=d.call(this,null,u,this.listenerTree,0),v=0;v<h.length;v++){var g=h[v];g._listeners=null}else this._events&&(this._events[a]=null);return this},c.prototype.listeners=function(a){if(this.wildcard){var u=[],h=typeof a=="string"?a.split(this.delimiter):a.slice();return d.call(this,u,h,this.listenerTree,0),u}return this._events||s.call(this),this._events[a]||(this._events[a]=[]),i(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},c.prototype.eventNames=function(){return Object.keys(this._events)},c.prototype.listenerCount=function(a){return this.listeners(a).length},c.prototype.listenersAny=function(){return this._all?this._all:[]},r.exports=c})()})(ji);var ns=ji.exports;const Ne="@all-features";class ss{constructor(){E(this,"eventToValue",new Map),this.emitter=new ns.EventEmitter2}onGateUpdated(e,t,i,n){const s=i(e,{...n,fireGateExposure:!1});this.eventToValue.get(t)===void 0&&this.eventToValue.set(t,s);const o=()=>{const l=i(e,{...n,fireGateExposure:!1});this.eventToValue.get(t)!==l&&(this.eventToValue.set(t,l),t(l))};return this.emitter.on(e,o),()=>{this.emitter.off(e,o)}}onExperimentValueUpdated(e,t,i,n,s,o){const l=`${e}.${t}`,c=s(e,t,i,{...o,fireExperimentExposure:!1});this.eventToValue.get(n)===void 0&&this.eventToValue.set(n,c);const d=()=>{const _=s(e,t,i,{...o,fireExperimentExposure:!1});this.eventToValue.get(n)!==_&&(this.eventToValue.set(n,_),n(_))};return this.emitter.on(l,d),()=>{this.emitter.off(l,d)}}onAnyUpdated(e){return this.emitter.on(Ne,e),()=>{this.emitter.off(Ne,e)}}anyUpdated(){this.emitter.emit(Ne),this.emitter.eventNames().filter(e=>e!==Ne).forEach(e=>{this.emitter.emit(e)})}}const as="fedramp-moderate";function os(){var r,e;const t=globalThis,i=t.MICROS_PERIMETER||t.UNSAFE_ATL_CONTEXT_BOUNDARY;if(i)return i===as;const n=(r=t.location)===null||r===void 0||(e=r.hostname)===null||e===void 0?void 0:e.match(/atlassian-us-gov-mod\.(com|net)|atlassian-us-gov\.(com|net)|atlassian-fex\.(com|net)|atlassian-stg-fedm\.(com|net)/);return n?n.length>0:!1}let Pt=function(r){return r.Error="Error",r.LocalOverride="LocalOverride",r.Unrecognized="Unrecognized",r.Uninitialized="Uninitialized",r.NetworkNotModified="NetworkNotModified",r.Network="Network",r.InvalidBootstrap="InvalidBootstrap",r.Bootstrap="Bootstrap",r.Cache="Cache",r.Unknown="Unknown",r}({}),z=function(r){return r.Development="development",r.Staging="staging",r.Production="production",r}({}),de=function(r){return r.COMMERCIAL="commercial",r.FEDRAMP_MODERATE="fedramp-moderate",r}({});const Ge=r=>({perimeter:os()?de.FEDRAMP_MODERATE:de.COMMERCIAL,...r}),ye=(r,e)=>{if(!r&&!e)return!0;if(!r||!e)return!1;const t=Object.entries(r),i=Object.entries(e);if(t.length!==i.length)return!1;const n=([s],[o])=>s.localeCompare(o);t.sort(n),i.sort(n);for(let s=0;s<t.length;s++){const[,o]=t[s],[,l]=i[s];if(o!==l)return!1}return!0},ei=(r,e,t)=>{const i={customIDs:!(e!=null&&e.stableID)&&t?{stableID:x.StableID.get(t),...r}:r,custom:e};return r.atlassianAccountId&&(i.userID=r.atlassianAccountId),i},ls=r=>{const{api:e,disableCurrentPageLogging:t,loggingIntervalMillis:i,loggingBufferMaxSize:n,localMode:s,eventLoggingApi:o,eventLoggingApiForRetries:l,disableLocalStorage:c,ignoreWindowUndefined:d,disableAllLogging:_,initTimeoutMs:a,disableNetworkKeepalive:u,overrideStableID:h,disableErrorLogging:v,disableAutoMetricsLogging:g,...m}=r;return{...m,networkConfig:{api:e,logEventUrl:o?o+"rgstr":void 0,logEventFallbackUrls:l?[l]:void 0,preventAllNetworkTraffic:s||!d&&typeof window>"u"},includeCurrentPageUrlWithEvents:!t,loggingIntervalMs:i,loggingBufferMaxSize:n,disableStorage:c===void 0?s:c,disableLogging:_===void 0?s:_}},cs=Object.entries(Pt).map(([r,e])=>[r.toLowerCase(),e]),Ni=r=>{var e,t,i;const n=r.reason.toLowerCase();return{reason:(e=(t=cs.find(([s])=>n.includes(s)))===null||t===void 0?void 0:t[1])!==null&&e!==void 0?e:Pt.Unknown,time:(i=r.receivedAt)!==null&&i!==void 0?i:Date.now()}};class qe{static fromExperiment(e){var t,i;const n=new qe(e.name,e.value,e.ruleID,Ni(e.details),(t=e.__evaluation)===null||t===void 0?void 0:t.secondary_exposures,(i=e.groupName)!==null&&i!==void 0?i:void 0);return n.experiment=e,n}constructor(e,t,i,n,s=[],o="",l=null){this.value=t,this._name=e,this._ruleID=i,this._secondaryExposures=s,this._allocatedExperimentName=o,this._evaluationDetails=n,this._onDefaultValueFallback=l}get(e,t,i){var n;const s=this.getValue(e,t);if(s==null)return t;const o=Array.isArray(t)?"array":typeof t,l=Array.isArray(s)?"array":typeof s;if(i){var c;return i(s)?(this.fireExposure(e),s):((c=this._onDefaultValueFallback)===null||c===void 0||c.call(this,this,e,o,l),t)}return t==null||o===l?(this.fireExposure(e),s):((n=this._onDefaultValueFallback)===null||n===void 0||n.call(this,this,e,o,l),t)}getValue(e,t){return e==null?this.value:(t==null&&(t=null),this.value[e]==null?t:(this.fireExposure(e),this.value[e]))}fireExposure(e){this.experiment&&this.experiment.get(e)}}class He{static fromLayer(e){var t,i,n,s;return new He(e.name,e.__value,e.ruleID,Ni(e.details),(l,c)=>e.get(c),(t=e.__evaluation)===null||t===void 0?void 0:t.secondary_exposures,(i=e.__evaluation)===null||i===void 0?void 0:i.undelegated_secondary_exposures,(n=e.__evaluation)===null||n===void 0?void 0:n.allocated_experiment_name,(s=e.__evaluation)===null||s===void 0?void 0:s.explicit_parameters)}constructor(e,t,i,n,s=null,o=[],l=[],c="",d=[]){this._logParameterFunction=s,this._name=e,this._value=JSON.parse(JSON.stringify(t??{})),this._ruleID=i??"",this._evaluationDetails=n,this._secondaryExposures=o,this._undelegatedSecondaryExposures=l,this._allocatedExperimentName=c,this._explicitParameters=d}get(e,t,i){const n=this._value[e];if(n==null)return t;const s=()=>(this._logLayerParameterExposure(e),n);return i?i(n)?s():t:t==null||typeof n==typeof t&&Array.isArray(t)===Array.isArray(n)?s():t}getValue(e,t){t==null&&(t=null);const i=this._value[e];return i!=null&&this._logLayerParameterExposure(e),i??t}_logLayerParameterExposure(e){var t;(t=this._logParameterFunction)===null||t===void 0||t.call(this,this,e)}}const ae="4.26.5";class ti extends Error{constructor(e){super(e)}}const us=5e3,ds="https://api.atlassian.com/flags",_s="https://api.stg.atlassian.com/flags",hs="https://api.dev.atlassian.com/flags",fs="https://api.stg.atlassian-us-gov-mod.com/flags",gs="https://api.atlassian-us-gov-mod.com/flags",vs="/gateway/api/flags";class be{static async fetchClientSdk(e){const{targetApp:t}=e,i=`/api/v2/frontend/clientSdkKey/${t}`;try{return await this.fetchRequest(i,"GET",e)}catch(n){throw n instanceof Error?n:Error("Failed to retrieve client sdk key")}}static async fetchExperimentValues(e,t,i){const n={identifiers:t,customAttributes:i,targetApp:e.targetApp};try{return await this.fetchRequest("/api/v2/frontend/experimentValues","POST",e,n)}catch(s){throw s instanceof Error?s:Error("Failed to retrieve experiment values")}}static async handleResponseError(e){if(!e.ok){const t=await e.text();throw new ti(`Non 2xx response status received, status: ${e.status}, body: ${JSON.stringify(t)}`)}if(e.status===204)throw new ti("Unexpected 204 response")}static async extractResponseBody(e){const t=await e.text();return JSON.parse(t)}static getBaseUrl(e,t=!1,i){if(t)return vs;if(i===de.FEDRAMP_MODERATE)switch(e){case z.Production:return gs;case z.Staging:return fs;default:throw new Error(`Invalid environment "${e}" for "${i}" perimeter`)}else if(i===de.COMMERCIAL)switch(e){case z.Development:return hs;case z.Staging:return _s;default:return ds}else throw new Error(`Invalid perimeter "${i}"`)}static async fetchRequest(e,t,i,n){const s=be.getBaseUrl(i.environment,i.useGatewayURL,i.perimeter),o=i.fetchTimeoutMs||us;let l;if(AbortSignal.timeout)l=AbortSignal.timeout(o);else if(AbortController){const d=new AbortController;l=d.signal,setTimeout(()=>d.abort(),o)}const c=await fetch(`${s}${e}`,{method:t,headers:{"Content-Type":"application/json","X-Client-Name":"feature-gate-js-client","X-Client-Version":ae,"X-API-KEY":i.apiKey},signal:l,...n&&{body:JSON.stringify(n)}});return await this.handleResponseError(c),await this.extractResponseBody(c)}}class ps extends x.DataAdapterCore{constructor(){super("NoFetchDataAdapter","nofetch"),E(this,"bootstrapResult",null)}setBootstrapData(e){this.bootstrapResult=e?{source:"Bootstrap",data:JSON.stringify(e),receivedAt:Date.now(),stableID:x.StableID.get(this._getSdkKey()),fullUserHash:null}:null}async prefetchData(e,t){}async getDataAsync(e,t,i){return this.bootstrapResult&&{...this.bootstrapResult,fullUserHash:x._getFullUserHash(t)}}getDataSync(e){return this.bootstrapResult&&{...this.bootstrapResult,fullUserHash:x._getFullUserHash(e)}}async _fetchFromNetwork(e,t,i){return null}_getCacheKey(e){const t=x._getStorageKey(this._getSdkKey(),e);return`${x.DataAdapterCachePrefix}.${this._cacheSuffix}.${t}`}_isCachedResultValidFor204(e,t){return!1}setDataLegacy(e,t){super.setData(e,t)}toJSON(){const e={...this};return delete e._options,delete e._inMemoryCache,delete e.bootstrapResult,e}}const pt="LocalOverride:Recognized",ms="STATSIG_OVERRIDES",ii="STATSIG_JS_LITE_LOCAL_OVERRIDES",re=()=>({gates:{},configs:{},layers:{}}),P=(r,e)=>e+":"+r;class ys{constructor(e){this._overrides=re(),this._djb2Map=new Map,this._localStorageKey=e}parseStoredOverrides(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):re()}catch{return re()}}mergeOverrides(...e){const t=re();for(const o of e){for(const[l,c]of Object.entries((i=o.gates)!==null&&i!==void 0?i:{})){var i;t.gates[l]=c}for(const[l,c]of Object.entries((n=o.configs)!==null&&n!==void 0?n:{})){var n;t.configs[l]=c}for(const[l,c]of Object.entries((s=o.layers)!==null&&s!==void 0?s:{})){var s;t.layers[l]=c}}return t}initFromStoredOverrides(){const e=this.mergeOverrides(this._overrides,this.parseStoredOverrides(ii),this.parseStoredOverrides(this._localStorageKey));try{window.localStorage.removeItem(ii)}catch{}for(const t of Object.values(e)){const i=new Set(Object.keys(t));for(const n of i){const s=C._DJB2(n);i.has(s)&&delete t[s]}}this.applyOverrides(e)}saveOverrides(){try{window.localStorage.setItem(this._localStorageKey,JSON.stringify(this._overrides))}catch{}}getOverrides(){return this.mergeOverrides(this._overrides)}applyOverrides(e){const t={...re(),...e};this._djb2Map.clear();for(const[i,n]of Object.entries(t))for(const[s,o]of Object.entries(n))this._djb2Map.set(P(C._DJB2(s),i),o);this._overrides=t}setOverrides(e){this.applyOverrides(e),this.saveOverrides()}overrideGate(e,t){this._overrides.gates[e]=t,this._djb2Map.set(P(C._DJB2(e),"gates"),t),this.saveOverrides()}removeGateOverride(e){delete this._overrides.gates[e],this._djb2Map.delete(P(C._DJB2(e),"gates")),this.saveOverrides()}getGateOverride(e,t){var i;const n=(i=this._overrides.gates[e.name])!==null&&i!==void 0?i:this._djb2Map.get(P(e.name,"gates"));return n==null?null:{...e,value:n,details:{...e.details,reason:pt}}}overrideDynamicConfig(e,t){this._overrides.configs[e]=t,this._djb2Map.set(P(C._DJB2(e),"configs"),t),this.saveOverrides()}removeDynamicConfigOverride(e){delete this._overrides.configs[e],this._djb2Map.delete(P(C._DJB2(e),"configs")),this.saveOverrides()}getDynamicConfigOverride(e,t){return this._getConfigOverride(e,this._overrides.configs)}overrideExperiment(e,t){this._overrides.configs[e]=t,this._djb2Map.set(P(C._DJB2(e),"configs"),t),this.saveOverrides()}removeExperimentOverride(e){delete this._overrides.configs[e],this._djb2Map.delete(P(C._DJB2(e),"configs")),this.saveOverrides()}getExperimentOverride(e,t){return this._getConfigOverride(e,this._overrides.configs)}overrideLayer(e,t){this._overrides.layers[e]=t,this._djb2Map.set(P(C._DJB2(e),"layers"),t),this.saveOverrides()}removeLayerOverride(e){delete this._overrides.layers[e],this._djb2Map.delete(P(C._DJB2(e),"layers")),this.saveOverrides()}removeAllOverrides(){this._overrides=re();try{window.localStorage.removeItem(this._localStorageKey)}catch{}}getLayerOverride(e,t){var i;const n=(i=this._overrides.layers[e.name])!==null&&i!==void 0?i:this._djb2Map.get(P(e.name,"layers"));return n==null?null:{...e,__value:n,get:C._makeTypedGet(e.name,n),details:{...e.details,reason:pt}}}_getConfigOverride(e,t){var i;const n=(i=t[e.name])!==null&&i!==void 0?i:this._djb2Map.get(P(e.name,"configs"));return n==null?null:{...e,value:n,get:C._makeTypedGet(e.name,n),details:{...e.details,reason:pt}}}}const ri="client-default-key",bs="https://xp.atlassian.com/v1/rgstr";class Es{constructor({localStorageKey:e=ms}={}){E(this,"initPromise",null),E(this,"initCompleted",!1),E(this,"initWithDefaults",!1),E(this,"hasCheckGateErrorOccurred",!1),E(this,"hasGetExperimentErrorOccurred",!1),E(this,"hasGetExperimentValueErrorOccurred",!1),E(this,"hasGetLayerErrorOccurred",!1),E(this,"hasGetLayerValueErrorOccurred",!1),E(this,"subscriptions",new ss),E(this,"dataAdapter",new ps),E(this,"statsigValuesUpdated",()=>{this.user&&this.statsigClient.updateUserSync(this.user,{disableBackgroundCacheRefresh:!0}),this.subscriptions.anyUpdated()}),this.overrideAdapter=new ys(e)}async initialize(e,t,i){const n=Ge(e);if(this.initPromise)return ye(n,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied."),this.initPromise;const s=performance.now();return this.initOptions=n,this.initPromise=this.init(n,t,i).then(()=>{this.initCompleted=!0,this.initWithDefaults=!0}).finally(()=>{const l=performance.now()-s;this.fireClientEvent(s,l,"initialize",this.initCompleted,n.apiKey)}),this.initPromise}async initializeWithProvider(e,t,i,n){const s=Ge(e);if(this.initPromise)return ye(s,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied."),this.initPromise;const o=performance.now();return this.initOptions=s,this.provider=t,this.provider.setClientVersion(ae),this.provider.setApplyUpdateCallback&&this.provider.setApplyUpdateCallback(this.applyUpdateCallback.bind(this)),this.initPromise=this.initWithProvider(s,t,i,n).then(()=>{this.initCompleted=!0,this.initWithDefaults=!0}).finally(()=>{const c=performance.now()-o;this.fireClientEvent(o,c,"initializeWithProvider",this.initCompleted,t.getApiKey?t.getApiKey():void 0)}),this.initPromise}applyUpdateCallback(e){try{(this.initCompleted||this.initWithDefaults)&&(this.assertInitialized(this.statsigClient),this.dataAdapter.setBootstrapData(e.experimentValues),this.dataAdapter.setData(JSON.stringify(e.experimentValues)),this.statsigValuesUpdated())}catch(t){console.warn("Error when attempting to apply update",t)}}fireClientEvent(e,t,i,n,s=void 0){var o;(o=this.initOptions.analyticsWebClient)===null||o===void 0||o.then(l=>{const c={targetApp:this.initOptions.targetApp,clientVersion:ae,success:n,startTime:e,totalTime:t,...s&&{apiKey:s}};l.sendOperationalEvent({action:i,actionSubject:"featureGatesClient",attributes:c,tags:["measurement"],source:"@atlaskit/feature-gate-js-client"})}).catch(l=>{this.initOptions.environment!==z.Production&&console.error("Analytics web client promise did not resolve",l)})}async initializeFromValues(e,t,i,n={}){const s=Ge(e);if(this.initPromise)return ye(s,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied."),this.initPromise;Object.prototype.hasOwnProperty.call(n,"has_updates")||(n.has_updates=!0);const o=performance.now();return this.initOptions=s,this.initPromise=this.initFromValues(s,t,i,n).then(()=>{this.initCompleted=!0,this.initWithDefaults=!0}).finally(()=>{const c=performance.now()-o;this.fireClientEvent(o,c,"initializeFromValues",this.initCompleted)}),this.initPromise}assertInitialized(e){if(!e)throw new Error("Client must be initialized before using this method")}async updateUser(e,t,i){this.assertInitialized(this.statsigClient);const n=Ge(e),s=()=>be.fetchExperimentValues(n,t,i).then(({experimentValues:o,customAttributes:l})=>({experimentValues:o,customAttributesFromFetch:l}));await this.updateUserUsingInitializeValuesProducer(s,t,i)}async updateUserWithProvider(e,t){if(this.assertInitialized(this.statsigClient),!this.provider)throw new Error("Cannot update user using provider as the client was not initialised with a provider");await this.provider.setProfile(this.initOptions,e,t),await this.updateUserUsingInitializeValuesProducer(()=>this.provider.getExperimentValues(),e,t)}async updateUserWithValues(e,t,i={}){this.assertInitialized(this.statsigClient);const n=()=>Promise.resolve({experimentValues:i,customAttributesFromFetch:t});await this.updateUserUsingInitializeValuesProducer(n,e,t)}initializeCalled(){return this.initPromise!=null}initializeCompleted(){return this.initCompleted}checkGate(e,t={}){try{this.assertInitialized(this.statsigClient);const{fireGateExposure:i=!0}=t;return this.statsigClient.checkGate(e,{disableExposureLog:!i})}catch(i){return this.hasCheckGateErrorOccurred||(console.warn({msg:"An error has occurred checking the feature gate. Only the first occurrence of this error is logged.",gateName:e,error:i}),this.hasCheckGateErrorOccurred=!0),!1}}isGateExist(e){try{return this.assertInitialized(this.statsigClient),!this.statsigClient.getFeatureGate(e,{disableExposureLog:!0}).details.reason.includes("Unrecognized")}catch(t){return console.error(`Error occurred when trying to check FeatureGate: ${t}`),!0}}isExperimentExist(e){try{return this.assertInitialized(this.statsigClient),!this.statsigClient.getExperiment(e,{disableExposureLog:!0}).details.reason.includes("Unrecognized")}catch(t){return console.error(`Error occurred when trying to check Experiment: ${t}`),!0}}manuallyLogGateExposure(e){this.assertInitialized(this.statsigClient),this.statsigClient.checkGate(e)}getExperiment(e,t={}){try{this.assertInitialized(this.statsigClient);const{fireExperimentExposure:i=!0}=t;return qe.fromExperiment(this.statsigClient.getExperiment(e,{disableExposureLog:!i}))}catch(i){return this.hasGetExperimentErrorOccurred||(console.warn({msg:"An error has occurred getting the experiment. Only the first occurrence of this error is logged.",experimentName:e,error:i}),this.hasGetExperimentErrorOccurred=!0),new qe(e,{},"",{time:Date.now(),reason:Pt.Error})}}getExperimentValue(e,t,i,n={}){const s=this.getExperiment(e,n);try{const{typeGuard:o}=n;return s.get(t,i,o)}catch(o){return this.hasGetExperimentValueErrorOccurred||(console.warn({msg:"An error has occurred getting the experiment value. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:i,options:n,error:o}),this.hasGetExperimentValueErrorOccurred=!0),i}}manuallyLogExperimentExposure(e){this.assertInitialized(this.statsigClient),this.statsigClient.getExperiment(e)}manuallyLogLayerExposure(e,t){var i;this.assertInitialized(this.statsigClient),(i=this.statsigClient.getLayer(e))===null||i===void 0||i.get(t)}shutdownStatsig(){this.assertInitialized(this.statsigClient),this.statsigClient.shutdown()}overrideGate(e,t){if(this.overrideAdapter.overrideGate(e,t),this.user){var i;(i=this.statsigClient)===null||i===void 0||i.updateUserSync(this.user,{disableBackgroundCacheRefresh:!0})}this.statsigValuesUpdated()}clearGateOverride(e){this.overrideAdapter.removeGateOverride(e),this.statsigValuesUpdated()}overrideConfig(e,t){this.overrideAdapter.overrideDynamicConfig(e,t),this.statsigValuesUpdated()}clearConfigOverride(e){this.overrideAdapter.removeDynamicConfigOverride(e),this.statsigValuesUpdated()}setOverrides(e){this.overrideAdapter.setOverrides(e),this.statsigValuesUpdated()}getOverrides(){return this.overrideAdapter.getOverrides()}clearAllOverrides(){this.overrideAdapter.removeAllOverrides(),this.statsigValuesUpdated()}isCurrentUser(e,t){return ye(this.currentIdentifiers,e)&&ye(this.currentAttributes,t)}onGateUpdated(e,t,i={}){const n=s=>{const{fireGateExposure:o=!0}=i;o&&this.manuallyLogGateExposure(e);try{t(s)}catch(l){console.warn(`Error calling callback for gate ${e} with value ${s}`,l)}};return this.subscriptions.onGateUpdated(e,n,this.checkGate.bind(this),i)}onExperimentValueUpdated(e,t,i,n,s={}){const o=l=>{const{fireExperimentExposure:c=!0}=s;c&&this.manuallyLogExperimentExposure(e);try{n(l)}catch(d){console.warn(`Error calling callback for experiment ${e} with value ${l}`,d)}};return this.subscriptions.onExperimentValueUpdated(e,t,i,o,this.getExperimentValue.bind(this),s)}onAnyUpdated(e){return this.subscriptions.onAnyUpdated(e)}async init(e,t,i){const n={...e};let s,o;try{const l=be.fetchClientSdk(e).then(_=>n.sdkKey=_.clientSdkKey),c=be.fetchExperimentValues(e,t,i),[,d]=await Promise.all([l,c]);s=d.experimentValues,o=d.customAttributes}catch(l){throw l instanceof Error&&console.error(`Error occurred when trying to fetch the Feature Gates client values, error: ${l==null?void 0:l.message}`),console.warn("Initialising Statsig client without values"),await this.initFromValues(n,t,i),l}return this.initFromValues(n,t,o,s)}async initWithProvider(e,t,i,n){const s={...e,disableCurrentPageLogging:!0};let o,l;try{await t.setProfile(e,i,n);const c=t.getClientSdkKey().then(a=>s.sdkKey=a),d=t.getExperimentValues(),[,_]=await Promise.all([c,d]);o=_.experimentValues,l=_.customAttributesFromFetch}catch(c){throw c instanceof Error&&console.error(`Error occurred when trying to fetch the Feature Gates client values, error: ${c==null?void 0:c.message}`),console.warn("Initialising Statsig client without values"),await this.initFromValues(s,i,n),c}return this.initFromValues(s,i,l,o)}async initFromValues(e,t,i,n={}){var s;this.overrideAdapter.initFromStoredOverrides(),this.currentIdentifiers=t,this.currentAttributes=i;const o=ls(e);o.sdkKey||(o.sdkKey=ri),(s=o.networkConfig)!==null&&s!==void 0&&s.logEventUrl||(o.networkConfig={...o.networkConfig,logEventUrl:bs}),o.perimeter===de.FEDRAMP_MODERATE&&(o.disableLogging=!0);const{sdkKey:l,environment:c,updateUserCompletionCallback:d,perimeter:_,...a}=o;this.sdkKey=l,this.user=ei(t,i,this.sdkKey);const u={...a,environment:{tier:c},includeCurrentPageUrlWithEvents:!1,dataAdapter:this.dataAdapter,overrideAdapter:this.overrideAdapter};try{this.statsigClient=new x.StatsigClient(l,this.user,u),this.dataAdapter.setBootstrapData(n),await this.statsigClient.initializeAsync()}catch(h){throw h instanceof Error&&console.error(`Error occurred when trying to initialise the Statsig client, error: ${h==null?void 0:h.message}`),console.warn("Initialising Statsig client with default sdk key and without values"),this.statsigClient=new x.StatsigClient(ri,this.user,u),this.dataAdapter.setBootstrapData(),await this.statsigClient.initializeAsync(),this.initWithDefaults=!0,h}}async updateUserUsingInitializeValuesProducer(e,t,i){if(this.assertInitialized(this.statsigClient),!this.initPromise)throw new Error("The client must be initialized before you can update the user.");if(this.isCurrentUser(t,i))return this.initPromise;const n=this.initPromise;try{await this.initPromise}catch{}const s=e(),o=this.updateStatsigClientUser(s,t,i);return this.initPromise=o.catch(async()=>{this.initPromise=n,this.provider&&await this.provider.setProfile(this.initOptions,this.currentIdentifiers,this.currentAttributes)}),o}async updateStatsigClientUser(e,t,i){var n,s;this.assertInitialized(this.statsigClient);let o,l;try{o=await e,l=ei(t,o.customAttributesFromFetch,this.sdkKey)}catch(u){var c,d;const h=u instanceof Error?u.message:JSON.stringify(u);throw(c=(d=this.initOptions).updateUserCompletionCallback)===null||c===void 0||c.call(d,!1,h),u}let _=!0,a=null;try{this.dataAdapter.setBootstrapData(o.experimentValues),this.user=l,await this.statsigClient.updateUserAsync(this.user)}catch(u){_=!1,a=String(u)}if((n=this.initOptions)===null||n===void 0||(s=n.updateUserCompletionCallback)===null||s===void 0||s.call(n,_,a),_)this.currentIdentifiers=t,this.currentAttributes=i,this.subscriptions.anyUpdated();else throw new Error("Failed to update user. An unexpected error occured.")}getPackageVersion(){return ae}getLayer(e,t={}){try{this.assertInitialized(this.statsigClient);const{fireLayerExposure:i=!0}=t;return He.fromLayer(this.statsigClient.getLayer(e,{disableExposureLog:!i}))}catch(i){return this.hasGetLayerErrorOccurred||(console.warn({msg:"An error has occurred getting the layer. Only the first occurrence of this error is logged.",layerName:e,error:i}),this.hasGetLayerErrorOccurred=!0),He.fromLayer(x._makeLayer(e,{reason:"Error"},null))}}getLayerValue(e,t,i,n={}){const s=this.getLayer(e,n);try{const{typeGuard:o}=n;return s.get(t,i,o)}catch(o){return this.hasGetLayerValueErrorOccurred||(console.warn({msg:"An error has occurred getting the layer value. Only the first occurrence of this error is logged.",layerName:e,defaultValue:i,options:n,error:o}),this.hasGetLayerValueErrorOccurred=!0),i}}}var y;class O{static isGateExists(e){return this.client.isGateExist(e)}static isExperimentExists(e){return this.client.isExperimentExist(e)}}y=O;E(O,"client",new Es);E(O,"hasCheckGateErrorOccurred",!1);E(O,"hasGetExperimentValueErrorOccurred",!1);E(O,"checkGate",(r,e)=>{try{if(typeof window<"u"&&window.__CRITERION__&&typeof window.__CRITERION__.getFeatureFlagOverride=="function"){const t=window.__CRITERION__.getFeatureFlagOverride(r);if(t!==void 0)return t}}catch(t){y.hasCheckGateErrorOccurred||(console.warn({msg:"An error has occurred checking the feature gate from criterion override. Only the first occurrence of this error is logged.",gateName:r,error:t}),y.hasCheckGateErrorOccurred=!0)}return y.client.checkGate(r,e)});E(O,"getExperimentValue",(r,e,t,i)=>{try{if(typeof window<"u"&&window.__CRITERION__&&typeof window.__CRITERION__.getExperimentValueOverride=="function"){const n=window.__CRITERION__.getExperimentValueOverride(r,e);if(n!=null)return n}}catch(n){return y.hasGetExperimentValueErrorOccurred||(console.warn({msg:"An error has occurred getting the experiment value from criterion override. Only the first occurrence of this error is logged.",experimentName:r,defaultValue:t,options:i,error:n}),y.hasGetExperimentValueErrorOccurred=!0),t}return y.client.getExperimentValue(r,e,t,i)});E(O,"initializeCalled",y.client.initializeCalled.bind(y.client));E(O,"initializeCompleted",y.client.initializeCompleted.bind(y.client));E(O,"initialize",y.client.initialize.bind(y.client));E(O,"initializeWithProvider",y.client.initializeWithProvider.bind(y.client));E(O,"initializeFromValues",y.client.initializeFromValues.bind(y.client));E(O,"manuallyLogGateExposure",y.client.manuallyLogGateExposure.bind(y.client));E(O,"getExperiment",y.client.getExperiment.bind(y.client));E(O,"manuallyLogExperimentExposure",y.client.manuallyLogExperimentExposure.bind(y.client));E(O,"manuallyLogLayerExposure",y.client.manuallyLogLayerExposure.bind(y.client));E(O,"shutdownStatsig",y.client.shutdownStatsig.bind(y.client));E(O,"overrideGate",y.client.overrideGate.bind(y.client));E(O,"clearGateOverride",y.client.clearGateOverride.bind(y.client));E(O,"overrideConfig",y.client.overrideConfig.bind(y.client));E(O,"clearConfigOverride",y.client.clearConfigOverride.bind(y.client));E(O,"setOverrides",y.client.setOverrides.bind(y.client));E(O,"getOverrides",y.client.getOverrides.bind(y.client));E(O,"clearAllOverrides",y.client.clearAllOverrides.bind(y.client));E(O,"isCurrentUser",y.client.isCurrentUser.bind(y.client));E(O,"onGateUpdated",y.client.onGateUpdated.bind(y.client));E(O,"onExperimentValueUpdated",y.client.onExperimentValueUpdated.bind(y.client));E(O,"onAnyUpdated",y.client.onAnyUpdated.bind(y.client));E(O,"updateUser",y.client.updateUser.bind(y.client));E(O,"updateUserWithProvider",y.client.updateUserWithProvider.bind(y.client));E(O,"updateUserWithValues",y.client.updateUserWithValues.bind(y.client));E(O,"getPackageVersion",y.client.getPackageVersion.bind(y.client));E(O,"getLayer",y.client.getLayer.bind(y.client));E(O,"getLayerValue",y.client.getLayerValue.bind(y.client));let Xe=O;if(typeof window<"u")if(window.__FEATUREGATES_JS__===void 0)window.__FEATUREGATES_JS__=O;else{var Ke,mt;Xe=window.__FEATUREGATES_JS__;const r=((Ke=Xe)===null||Ke===void 0||(mt=Ke.getPackageVersion)===null||mt===void 0?void 0:mt.call(Ke))||"4.10.0 or earlier";if(r!==ae){const e=`Multiple versions of FeatureGateClients found on the current page.
      The currently bound version is ${r} when module version ${ae} was loading.`;console.warn(e)}}const Ss=r=>{switch(r){case"stg-east":return z.Staging;case"prod-east":return z.Production;default:return z.Development}},ws=r=>{switch(r){case"stg-east":return"ef3af703-918f-4760-96c7-ecf6877b3786";case"prod-east":return"27e977ec-88f6-4d83-9096-7ebbd4c61c4e";default:return"2c6c9143-24ba-49c5-8158-601bd101396e"}};class xs{constructor(e,t,i){this.initialized=new yt,this.name="Statsig",this.status="new",this.initialize=async()=>{await Xe.initialize({apiKey:ws(this.params.buildMode),environment:Ss(this.params.buildMode),targetApp:"cc-databases_web",useGatewayURL:!0,fetchTimeoutMs:1e3,perimeter:de.COMMERCIAL},{atlassianAccountId:this.params.accountId,tenantId:this.params.tenantId}),Object.entries(F).forEach(([n,s])=>{const o=n;s.source===oi.Statsig&&(F[o].enabled=Xe.checkGate(s.flag))})},this.params={buildMode:e,tenantId:t,accountId:i}}}export{ks as B,yt as D,zi as F,xs as S,Xi as a,Xe as b,nr as c,Hi as d,ns as e,Rs as f,Ps as g,Us as h,F as i,It as j,Ts as k,Ls as l,tr as m,er as n,ne as o,Wi as p,Ms as q,Ft as r,As as s};
//# sourceMappingURL=statsig-CciSPO6z.js.map
